import{c as p,J as C,n as E,r as D,z as P,I as T,u as q,M as A,j as e,a3 as L,h as o,a4 as S,q as I,a5 as g,Y as R,a6 as G,U as V,Z as z}from"./index-BvjW9mvP.js";import{I as Q}from"./input-kFU0mmdx.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N=p("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=p("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function K(){const[,c]=C(),{user:v}=E(),[n,k]=D.useState(""),{toast:h}=P(),f=T(),{data:r=[],isLoading:i}=q({queryKey:["/api/menu-plans"],enabled:!!v}),b=A({mutationFn:async s=>{await z(`/api/menu-plans/${s}`,{method:"DELETE"})},onSuccess:()=>{f.invalidateQueries({queryKey:["/api/menu-plans"]}),h({title:"MenÃº eliminado",description:"El menÃº se ha eliminado correctamente."})},onError:()=>{h({title:"Error",description:"No se pudo eliminar el menÃº. IntÃ©ntalo de nuevo.",variant:"destructive"})}}),w=async s=>{confirm("Â¿EstÃ¡s seguro de que quieres eliminar este menÃº? Esta acciÃ³n no se puede deshacer.")&&b.mutate(s)},m=s=>{localStorage.setItem("viewingMenuPlanId",s),c("/menu-generated")},d=r.filter(s=>s.name.toLowerCase().includes(n.toLowerCase())||new Date(s.createdAt).toLocaleDateString("es-ES").includes(n)),y=s=>new Date(s).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}),M=s=>!s||s.length===0||s.includes("normal")?"Sin restricciones":s.join(", ");return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-dark-green via-black to-dark-green pt-20 pb-8",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>c("/dashboard"),className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 transition-colors",children:e.jsx(L,{className:"w-5 h-5 text-chalk"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-chalk-white mb-2",children:"Mis MenÃºs Generados"}),e.jsx("p",{className:"text-chalk",children:"Revisa el historial de todos tus menÃºs semanales personalizados"})]})]}),e.jsxs(o,{onClick:()=>c("/questionnaire"),className:"bg-chalk-green text-black hover:bg-chalk-green/90",children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Crear Nuevo MenÃº"]})]}),e.jsx("div",{className:"glass-container mb-8",children:e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-chalk/60"}),e.jsx(Q,{type:"text",placeholder:"Buscar menÃºs por nombre o fecha...",value:n,onChange:s=>k(s.target.value),className:"pl-10 bg-white/10 border-chalk-green/30 text-chalk-white placeholder-chalk/60"})]})}),i&&e.jsxs("div",{className:"glass-container text-center py-12",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-chalk-green border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-chalk",children:"Cargando tus menÃºs..."})]}),!i&&d.length===0&&e.jsxs("div",{className:"glass-container text-center py-12",children:[e.jsx(I,{className:"w-16 h-16 text-chalk-green mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-chalk-white mb-2",children:n?"No se encontraron menÃºs":"AÃºn no tienes menÃºs generados"}),e.jsx("p",{className:"text-chalk mb-6",children:n?"Intenta con otros tÃ©rminos de bÃºsqueda":"Crea tu primer menÃº personalizado respondiendo nuestro cuestionario"}),!n&&e.jsxs(o,{onClick:()=>c("/questionnaire"),className:"bg-chalk-green text-black hover:bg-chalk-green/90",children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Crear Mi Primer MenÃº"]})]}),!i&&d.length>0&&e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(s=>{var t,a,l,x,u,j;return e.jsx("div",{className:"glass-container hover:bg-white/10 transition-all duration-300",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-chalk-white mb-1",children:s.name}),e.jsxs("p",{className:"text-chalk/70 text-sm",children:["Creado el ",y(s.createdAt)]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>m(s.id),className:"p-2 rounded bg-chalk-green/20 hover:bg-chalk-green/30 transition-colors",title:"Ver menÃº",children:e.jsx(g,{className:"w-4 h-4 text-chalk-green"})}),e.jsx("button",{onClick:()=>w(s.id),className:"p-2 rounded bg-red-500/20 hover:bg-red-500/30 transition-colors",title:"Eliminar menÃº",children:e.jsx(U,{className:"w-4 h-4 text-red-400"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-chalk",children:[e.jsx(R,{className:"w-4 h-4"}),e.jsx("span",{children:"DuraciÃ³n:"})]}),e.jsxs("span",{className:"text-chalk-white font-medium",children:[((t=s.preferences)==null?void 0:t.daysToGenerate)||"N/A"," dÃ­as"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-chalk",children:[e.jsx(G,{className:"w-4 h-4"}),e.jsx("span",{children:"Comidas por dÃ­a:"})]}),e.jsx("span",{className:"text-chalk-white font-medium",children:((a=s.preferences)==null?void 0:a.mealsPerDay)||"N/A"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-chalk",children:[e.jsx(V,{className:"w-4 h-4"}),e.jsx("span",{children:"Raciones:"})]}),e.jsxs("span",{className:"text-chalk-white font-medium",children:[((l=s.preferences)==null?void 0:l.servings)||"N/A"," personas"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-chalk",children:[e.jsx("span",{children:"ðŸ’°"}),e.jsx("span",{children:"Presupuesto:"})]}),e.jsxs("span",{className:"text-chalk-white font-medium",children:["â‚¬",((x=s.preferences)==null?void 0:x.budget)||"N/A"]})]}),e.jsxs("div",{className:"pt-2 border-t border-chalk-green/20",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-chalk",children:"Dieta:"}),e.jsx("span",{className:"text-chalk-white font-medium ml-2",children:M((u=s.preferences)==null?void 0:u.dietaryRestrictions)})]}),((j=s.preferences)==null?void 0:j.allergies)&&s.preferences.allergies.length>0&&!s.preferences.allergies.includes("ninguna")&&e.jsxs("div",{className:"text-sm mt-1",children:[e.jsx("span",{className:"text-chalk",children:"Alergias:"}),e.jsx("span",{className:"text-chalk-white font-medium ml-2",children:s.preferences.allergies.join(", ")})]})]})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-chalk-green/20",children:e.jsxs(o,{onClick:()=>m(s.id),className:"w-full bg-chalk-green/20 hover:bg-chalk-green/30 text-chalk-green border border-chalk-green/30",variant:"outline",children:[e.jsx(g,{className:"w-4 h-4 mr-2"}),"Ver MenÃº Completo"]})})]})},s.id)})}),!i&&r.length>0&&e.jsxs("div",{className:"glass-container mt-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-chalk-white mb-4",children:"EstadÃ­sticas"}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-chalk-green",children:r.length}),e.jsx("div",{className:"text-chalk text-sm",children:"MenÃºs Generados"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-chalk-green",children:r.reduce((s,t)=>{var a;return s+(((a=t.preferences)==null?void 0:a.daysToGenerate)||0)},0)}),e.jsx("div",{className:"text-chalk text-sm",children:"DÃ­as Planificados"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-chalk-green",children:r.reduce((s,t)=>{var a,l;return s+(((a=t.preferences)==null?void 0:a.daysToGenerate)||0)*(((l=t.preferences)==null?void 0:l.mealsPerDay)||0)},0)}),e.jsx("div",{className:"text-chalk text-sm",children:"Comidas Totales"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold text-chalk-green",children:["â‚¬",r.reduce((s,t)=>{var a;return s+(((a=t.preferences)==null?void 0:a.budget)||0)},0)]}),e.jsx("div",{className:"text-chalk text-sm",children:"Presupuesto Total"})]})]})]})]})})}export{K as default};
