var uo=Object.defineProperty;var xn=i=>{throw TypeError(i)};var co=(i,e,t)=>e in i?uo(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var m=(i,e,t)=>co(i,typeof e!="symbol"?e+"":e,t),ri=(i,e,t)=>e.has(i)||xn("Cannot "+t);var p=(i,e,t)=>(ri(i,e,"read from private field"),t?t.call(i):e.get(i)),v=(i,e,t)=>e.has(i)?xn("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),F=(i,e,t,s)=>(ri(i,e,"write to private field"),s?s.call(i,t):e.set(i,t),t),_=(i,e,t)=>(ri(i,e,"access private method"),t);import{F as ho,r as j,j as f,s as po,t as si,v as fo,w as mo,x as go,y as cs,z as Lr,h as Ei,A as yo,E as bo,G as vo,H as wo,n as _o,I as So,J as Fo,K as Co,M as ai,N as Pn,q as kn,T as xo,a as Po,b as Tn,O as En,Q as ms,d as Nn,C as gs,e as ys,f as bs,g as vs,R as ko,V as oi,W as li,B as di,k as Un,U as To,X as An,Y as Eo,l as No,Z as ws,_ as Uo,$ as Ao,a0 as ui,a1 as it,a2 as Ae}from"./index-BvjW9mvP.js";import{I as Oo}from"./input-kFU0mmdx.js";import{C as ci}from"./checkbox-CorT4s1Q.js";import{S as Mo,a as Ro,b as Io,c as Do,d as _s}from"./select-CCjdo1U6.js";import{t as Bo,d as Lo}from"./throttle-3vTcP66J.js";import{u as jo,P as $o}from"./PaywallDialog-CC51cZPZ.js";const zo=ho,jr=j.createContext({}),xe=({...i})=>f.jsx(jr.Provider,{value:{name:i.name},children:f.jsx(po,{...i})}),ii=()=>{const i=j.useContext(jr),e=j.useContext($r),{getFieldState:t,formState:s}=go(),n=t(i.name,s);if(!i)throw new Error("useFormField should be used within <FormField>");const{id:r}=e;return{id:r,name:i.name,formItemId:`${r}-form-item`,formDescriptionId:`${r}-form-item-description`,formMessageId:`${r}-form-item-message`,...n}},$r=j.createContext({}),ye=j.forwardRef(({className:i,...e},t)=>{const s=j.useId();return f.jsx($r.Provider,{value:{id:s},children:f.jsx("div",{ref:t,className:si("space-y-2",i),...e})})});ye.displayName="FormItem";const be=j.forwardRef(({className:i,...e},t)=>{const{error:s,formItemId:n}=ii();return f.jsx(fo,{ref:t,className:si(s&&"text-destructive",i),htmlFor:n,...e})});be.displayName="FormLabel";const $e=j.forwardRef(({...i},e)=>{const{error:t,formItemId:s,formDescriptionId:n,formMessageId:r}=ii();return f.jsx(mo,{ref:e,id:s,"aria-describedby":t?`${n} ${r}`:`${n}`,"aria-invalid":!!t,...i})});$e.displayName="FormControl";const Ho=j.forwardRef(({className:i,...e},t)=>{const{formDescriptionId:s}=ii();return f.jsx("p",{ref:t,id:s,className:si("text-sm text-muted-foreground",i),...e})});Ho.displayName="FormDescription";const Os=j.forwardRef(({className:i,children:e,...t},s)=>{const{error:n,formMessageId:r}=ii(),a=n?String((n==null?void 0:n.message)??""):e;return a?f.jsx("p",{ref:s,id:r,className:si("text-sm font-medium text-destructive",i),...t,children:a}):null});Os.displayName="FormMessage";function qo(i,e,t){const s=[];return i.forEach(n=>typeof n!="string"?s.push(n):e[Symbol.split](n).forEach((r,a,o)=>{r!==""&&s.push(r),a<o.length-1&&s.push(t)})),s}/**
 * Takes a string with placeholder variables like `%{smart_count} file selected`
 * and replaces it with values from options `{smart_count: 5}`
 *
 * @license https://github.com/airbnb/polyglot.js/blob/master/LICENSE
 * taken from https://github.com/airbnb/polyglot.js/blob/master/lib/polyglot.js#L299
 *
 * @param phrase that needs interpolation, with placeholders
 * @param options with values that will be used to replace placeholders
 */function On(i,e){const t=/\$/g,s="$$$$";let n=[i];if(e==null)return n;for(const r of Object.keys(e))if(r!=="_"){let a=e[r];typeof a=="string"&&(a=t[Symbol.replace](a,s)),n=qo(n,new RegExp(`%\\{${r}\\}`,"g"),a)}return n}const Vo=i=>{throw new Error(`missing string: ${i}`)};var qt,Vt,Ni;class zr{constructor(e,{onMissingKey:t=Vo}={}){v(this,Vt);m(this,"locale");v(this,qt);this.locale={strings:{},pluralize(s){return s===1?0:1}},Array.isArray(e)?e.forEach(_(this,Vt,Ni),this):_(this,Vt,Ni).call(this,e),F(this,qt,t)}translate(e,t){return this.translateArray(e,t).join("")}translateArray(e,t){let s=this.locale.strings[e];if(s==null&&(p(this,qt).call(this,e),s=e),typeof s=="object"){if(t&&typeof t.smart_count<"u"){const r=this.locale.pluralize(t.smart_count);return On(s[r],t)}throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}if(typeof s!="string")throw new Error("string was not a string");return On(s,t)}}qt=new WeakMap,Vt=new WeakSet,Ni=function(e){if(!(e!=null&&e.strings))return;const t=this.locale;Object.assign(this.locale,{strings:{...t.strings,...e.strings},pluralize:e.pluralize||t.pluralize})};class Hr{constructor(e,t){m(this,"uppy");m(this,"opts");m(this,"id");m(this,"defaultLocale");m(this,"i18n");m(this,"i18nArray");m(this,"type");m(this,"VERSION");this.uppy=e,this.opts=t??{}}getPluginState(){const{plugins:e}=this.uppy.getState();return(e==null?void 0:e[this.id])||{}}setPluginState(e){const{plugins:t}=this.uppy.getState();this.uppy.setState({plugins:{...t,[this.id]:{...t[this.id],...e}}})}setOptions(e){this.opts={...this.opts,...e},this.setPluginState(void 0),this.i18nInit()}i18nInit(){const e=new zr([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.setPluginState(void 0)}addTarget(e){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")}install(){}uninstall(){}update(e){}afterUpdate(){}}function hi(i){return i<10?`0${i}`:i.toString()}function Ms(){const i=new Date,e=hi(i.getHours()),t=hi(i.getMinutes()),s=hi(i.getSeconds());return`${e}:${t}:${s}`}const Wo={debug:()=>{},warn:()=>{},error:(...i)=>console.error(`[Uppy] [${Ms()}]`,...i)},Go={debug:(...i)=>console.debug(`[Uppy] [${Ms()}]`,...i),warn:(...i)=>console.warn(`[Uppy] [${Ms()}]`,...i),error:(...i)=>console.error(`[Uppy] [${Ms()}]`,...i)};function qr(i){return typeof i!="object"||i===null||!("nodeType"in i)?!1:i.nodeType===Node.ELEMENT_NODE}function Ko(i,e=document){return typeof i=="string"?e.querySelector(i):qr(i)?i:null}function Vr(i){for(;i&&!i.dir;)i=i.parentNode;return i==null?void 0:i.dir}var hs,N,Wr,He,Mn,Gr,Ui,ln,Ai,Oi,Lt={},Kr=[],Xo=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,ni=Array.isArray;function Ue(i,e){for(var t in e)i[t]=e[t];return i}function Xr(i){i&&i.parentNode&&i.parentNode.removeChild(i)}function jt(i,e,t){var s,n,r,a={};for(r in e)r=="key"?s=e[r]:r=="ref"?n=e[r]:a[r]=e[r];if(arguments.length>2&&(a.children=arguments.length>3?hs.call(arguments,2):t),typeof i=="function"&&i.defaultProps!=null)for(r in i.defaultProps)a[r]===void 0&&(a[r]=i.defaultProps[r]);return Dt(i,a,s,n,null)}function Dt(i,e,t,s,n){var r={type:i,props:e,key:t,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:n??++Wr,__i:-1,__u:0};return n==null&&N.vnode!=null&&N.vnode(r),r}function Yo(){return{current:null}}function pe(i){return i.children}function ee(i,e){this.props=i,this.context=e}function kt(i,e){if(e==null)return i.__?kt(i.__,i.__i+1):null;for(var t;e<i.__k.length;e++)if((t=i.__k[e])!=null&&t.__e!=null)return t.__e;return typeof i.type=="function"?kt(i):null}function Yr(i){var e,t;if((i=i.__)!=null&&i.__c!=null){for(i.__e=i.__c.base=null,e=0;e<i.__k.length;e++)if((t=i.__k[e])!=null&&t.__e!=null){i.__e=i.__c.base=t.__e;break}return Yr(i)}}function Rn(i){(!i.__d&&(i.__d=!0)&&He.push(i)&&!Ls.__r++||Mn!==N.debounceRendering)&&((Mn=N.debounceRendering)||Gr)(Ls)}function Ls(){var i,e,t,s,n,r,a,o;for(He.sort(Ui);i=He.shift();)i.__d&&(e=He.length,s=void 0,r=(n=(t=i).__v).__e,a=[],o=[],t.__P&&((s=Ue({},n)).__v=n.__v+1,N.vnode&&N.vnode(s),dn(t.__P,s,n,t.__n,t.__P.namespaceURI,32&n.__u?[r]:null,a,r??kt(n),!!(32&n.__u),o),s.__v=n.__v,s.__.__k[s.__i]=s,Zr(a,s,o),s.__e!=r&&Yr(s)),He.length>e&&He.sort(Ui));Ls.__r=0}function Jr(i,e,t,s,n,r,a,o,l,h,c){var u,y,g,w,x,S=s&&s.__k||Kr,C=e.length;for(t.__d=l,Jo(t,e,S),l=t.__d,u=0;u<C;u++)(g=t.__k[u])!=null&&(y=g.__i===-1?Lt:S[g.__i]||Lt,g.__i=u,dn(i,g,y,n,r,a,o,l,h,c),w=g.__e,g.ref&&y.ref!=g.ref&&(y.ref&&un(y.ref,null,g),c.push(g.ref,g.__c||w,g)),x==null&&w!=null&&(x=w),65536&g.__u||y.__k===g.__k?l=Qr(g,l,i):typeof g.type=="function"&&g.__d!==void 0?l=g.__d:w&&(l=w.nextSibling),g.__d=void 0,g.__u&=-196609);t.__d=l,t.__e=x}function Jo(i,e,t){var s,n,r,a,o,l=e.length,h=t.length,c=h,u=0;for(i.__k=[],s=0;s<l;s++)(n=e[s])!=null&&typeof n!="boolean"&&typeof n!="function"?(a=s+u,(n=i.__k[s]=typeof n=="string"||typeof n=="number"||typeof n=="bigint"||n.constructor==String?Dt(null,n,null,null,null):ni(n)?Dt(pe,{children:n},null,null,null):n.constructor===void 0&&n.__b>0?Dt(n.type,n.props,n.key,n.ref?n.ref:null,n.__v):n).__=i,n.__b=i.__b+1,r=null,(o=n.__i=Qo(n,t,a,c))!==-1&&(c--,(r=t[o])&&(r.__u|=131072)),r==null||r.__v===null?(o==-1&&u--,typeof n.type!="function"&&(n.__u|=65536)):o!==a&&(o==a-1?u--:o==a+1?u++:(o>a?u--:u++,n.__u|=65536))):n=i.__k[s]=null;if(c)for(s=0;s<h;s++)(r=t[s])!=null&&!(131072&r.__u)&&(r.__e==i.__d&&(i.__d=kt(r)),ea(r,r))}function Qr(i,e,t){var s,n;if(typeof i.type=="function"){for(s=i.__k,n=0;s&&n<s.length;n++)s[n]&&(s[n].__=i,e=Qr(s[n],e,t));return e}i.__e!=e&&(e&&i.type&&!t.contains(e)&&(e=kt(i)),t.insertBefore(i.__e,e||null),e=i.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType===8);return e}function ce(i,e){return e=e||[],i==null||typeof i=="boolean"||(ni(i)?i.some(function(t){ce(t,e)}):e.push(i)),e}function Qo(i,e,t,s){var n=i.key,r=i.type,a=t-1,o=t+1,l=e[t];if(l===null||l&&n==l.key&&r===l.type&&!(131072&l.__u))return t;if(s>(l!=null&&!(131072&l.__u)?1:0))for(;a>=0||o<e.length;){if(a>=0){if((l=e[a])&&!(131072&l.__u)&&n==l.key&&r===l.type)return a;a--}if(o<e.length){if((l=e[o])&&!(131072&l.__u)&&n==l.key&&r===l.type)return o;o++}}return-1}function In(i,e,t){e[0]==="-"?i.setProperty(e,t??""):i[e]=t==null?"":typeof t!="number"||Xo.test(e)?t:t+"px"}function Ss(i,e,t,s,n){var r;e:if(e==="style")if(typeof t=="string")i.style.cssText=t;else{if(typeof s=="string"&&(i.style.cssText=s=""),s)for(e in s)t&&e in t||In(i.style,e,"");if(t)for(e in t)s&&t[e]===s[e]||In(i.style,e,t[e])}else if(e[0]==="o"&&e[1]==="n")r=e!==(e=e.replace(/(PointerCapture)$|Capture$/i,"$1")),e=e.toLowerCase()in i||e==="onFocusOut"||e==="onFocusIn"?e.toLowerCase().slice(2):e.slice(2),i.l||(i.l={}),i.l[e+r]=t,t?s?t.u=s.u:(t.u=ln,i.addEventListener(e,r?Oi:Ai,r)):i.removeEventListener(e,r?Oi:Ai,r);else{if(n=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in i)try{i[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e[4]!=="-"?i.removeAttribute(e):i.setAttribute(e,e=="popover"&&t==1?"":t))}}function Dn(i){return function(e){if(this.l){var t=this.l[e.type+i];if(e.t==null)e.t=ln++;else if(e.t<t.u)return;return t(N.event?N.event(e):e)}}}function dn(i,e,t,s,n,r,a,o,l,h){var c,u,y,g,w,x,S,C,T,A,U,R,O,k,D,H,L=e.type;if(e.constructor!==void 0)return null;128&t.__u&&(l=!!(32&t.__u),r=[o=e.__e=t.__e]),(c=N.__b)&&c(e);e:if(typeof L=="function")try{if(C=e.props,T="prototype"in L&&L.prototype.render,A=(c=L.contextType)&&s[c.__c],U=c?A?A.props.value:c.__:s,t.__c?S=(u=e.__c=t.__c).__=u.__E:(T?e.__c=u=new L(C,U):(e.__c=u=new ee(C,U),u.constructor=L,u.render=el),A&&A.sub(u),u.props=C,u.state||(u.state={}),u.context=U,u.__n=s,y=u.__d=!0,u.__h=[],u._sb=[]),T&&u.__s==null&&(u.__s=u.state),T&&L.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=Ue({},u.__s)),Ue(u.__s,L.getDerivedStateFromProps(C,u.__s))),g=u.props,w=u.state,u.__v=e,y)T&&L.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),T&&u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(T&&L.getDerivedStateFromProps==null&&C!==g&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(C,U),!u.__e&&(u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(C,u.__s,U)===!1||e.__v===t.__v)){for(e.__v!==t.__v&&(u.props=C,u.state=u.__s,u.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.some(function(b){b&&(b.__=e)}),R=0;R<u._sb.length;R++)u.__h.push(u._sb[R]);u._sb=[],u.__h.length&&a.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(C,u.__s,U),T&&u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(g,w,x)})}if(u.context=U,u.props=C,u.__P=i,u.__e=!1,O=N.__r,k=0,T){for(u.state=u.__s,u.__d=!1,O&&O(e),c=u.render(u.props,u.state,u.context),D=0;D<u._sb.length;D++)u.__h.push(u._sb[D]);u._sb=[]}else do u.__d=!1,O&&O(e),c=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++k<25);u.state=u.__s,u.getChildContext!=null&&(s=Ue(Ue({},s),u.getChildContext())),T&&!y&&u.getSnapshotBeforeUpdate!=null&&(x=u.getSnapshotBeforeUpdate(g,w)),Jr(i,ni(H=c!=null&&c.type===pe&&c.key==null?c.props.children:c)?H:[H],e,t,s,n,r,a,o,l,h),u.base=e.__e,e.__u&=-161,u.__h.length&&a.push(u),S&&(u.__E=u.__=null)}catch(b){if(e.__v=null,l||r!=null){for(e.__u|=l?160:128;o&&o.nodeType===8&&o.nextSibling;)o=o.nextSibling;r[r.indexOf(o)]=null,e.__e=o}else e.__e=t.__e,e.__k=t.__k;N.__e(b,e,t)}else r==null&&e.__v===t.__v?(e.__k=t.__k,e.__e=t.__e):e.__e=Zo(t.__e,e,t,s,n,r,a,l,h);(c=N.diffed)&&c(e)}function Zr(i,e,t){e.__d=void 0;for(var s=0;s<t.length;s++)un(t[s],t[++s],t[++s]);N.__c&&N.__c(e,i),i.some(function(n){try{i=n.__h,n.__h=[],i.some(function(r){r.call(n)})}catch(r){N.__e(r,n.__v)}})}function Zo(i,e,t,s,n,r,a,o,l){var h,c,u,y,g,w,x,S=t.props,C=e.props,T=e.type;if(T==="svg"?n="http://www.w3.org/2000/svg":T==="math"?n="http://www.w3.org/1998/Math/MathML":n||(n="http://www.w3.org/1999/xhtml"),r!=null){for(h=0;h<r.length;h++)if((g=r[h])&&"setAttribute"in g==!!T&&(T?g.localName===T:g.nodeType===3)){i=g,r[h]=null;break}}if(i==null){if(T===null)return document.createTextNode(C);i=document.createElementNS(n,T,C.is&&C),o&&(N.__m&&N.__m(e,r),o=!1),r=null}if(T===null)S===C||o&&i.data===C||(i.data=C);else{if(r=r&&hs.call(i.childNodes),S=t.props||Lt,!o&&r!=null)for(S={},h=0;h<i.attributes.length;h++)S[(g=i.attributes[h]).name]=g.value;for(h in S)if(g=S[h],h!="children"){if(h=="dangerouslySetInnerHTML")u=g;else if(!(h in C)){if(h=="value"&&"defaultValue"in C||h=="checked"&&"defaultChecked"in C)continue;Ss(i,h,null,g,n)}}for(h in C)g=C[h],h=="children"?y=g:h=="dangerouslySetInnerHTML"?c=g:h=="value"?w=g:h=="checked"?x=g:o&&typeof g!="function"||S[h]===g||Ss(i,h,g,S[h],n);if(c)o||u&&(c.__html===u.__html||c.__html===i.innerHTML)||(i.innerHTML=c.__html),e.__k=[];else if(u&&(i.innerHTML=""),Jr(i,ni(y)?y:[y],e,t,s,T==="foreignObject"?"http://www.w3.org/1999/xhtml":n,r,a,r?r[0]:t.__k&&kt(t,0),o,l),r!=null)for(h=r.length;h--;)Xr(r[h]);o||(h="value",T==="progress"&&w==null?i.removeAttribute("value"):w!==void 0&&(w!==i[h]||T==="progress"&&!w||T==="option"&&w!==S[h])&&Ss(i,h,w,S[h],n),h="checked",x!==void 0&&x!==i[h]&&Ss(i,h,x,S[h],n))}return i}function un(i,e,t){try{if(typeof i=="function"){var s=typeof i.__u=="function";s&&i.__u(),s&&e==null||(i.__u=i(e))}else i.current=e}catch(n){N.__e(n,t)}}function ea(i,e,t){var s,n;if(N.unmount&&N.unmount(i),(s=i.ref)&&(s.current&&s.current!==i.__e||un(s,null,e)),(s=i.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(r){N.__e(r,e)}s.base=s.__P=null}if(s=i.__k)for(n=0;n<s.length;n++)s[n]&&ea(s[n],e,t||typeof i.type!="function");t||Xr(i.__e),i.__c=i.__=i.__e=i.__d=void 0}function el(i,e,t){return this.constructor(i,t)}function tl(i,e,t){var s,n,r,a;N.__&&N.__(i,e),n=(s=!1)?null:e.__k,r=[],a=[],dn(e,i=e.__k=jt(pe,null,[i]),n||Lt,Lt,e.namespaceURI,n?null:e.firstChild?hs.call(e.childNodes):null,r,n?n.__e:e.firstChild,s,a),Zr(r,i,a)}function ta(i,e,t){var s,n,r,a,o=Ue({},i.props);for(r in i.type&&i.type.defaultProps&&(a=i.type.defaultProps),e)r=="key"?s=e[r]:r=="ref"?n=e[r]:o[r]=e[r]===void 0&&a!==void 0?a[r]:e[r];return arguments.length>2&&(o.children=arguments.length>3?hs.call(arguments,2):t),Dt(i.type,o,s||i.key,n||i.ref,null)}hs=Kr.slice,N={__e:function(i,e,t,s){for(var n,r,a;e=e.__;)if((n=e.__c)&&!n.__)try{if((r=n.constructor)&&r.getDerivedStateFromError!=null&&(n.setState(r.getDerivedStateFromError(i)),a=n.__d),n.componentDidCatch!=null&&(n.componentDidCatch(i,s||{}),a=n.__d),a)return n.__E=n}catch(o){i=o}throw i}},Wr=0,ee.prototype.setState=function(i,e){var t;t=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Ue({},this.state),typeof i=="function"&&(i=i(Ue({},t),this.props)),i&&Ue(t,i),i!=null&&this.__v&&(e&&this._sb.push(e),Rn(this))},ee.prototype.forceUpdate=function(i){this.__v&&(this.__e=!0,i&&this.__h.push(i),Rn(this))},ee.prototype.render=pe,He=[],Gr=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ui=function(i,e){return i.__v.__b-e.__v.__b},Ls.__r=0,ln=0,Ai=Dn(!1),Oi=Dn(!0);var $t,$,pi,Bn,zt=0,sa=[],z=N,Ln=z.__b,jn=z.__r,$n=z.diffed,zn=z.__c,Hn=z.unmount,qn=z.__;function cn(i,e){z.__h&&z.__h($,i,zt||e),zt=0;var t=$.__H||($.__H={__:[],__h:[]});return i>=t.__.length&&t.__.push({}),t.__[i]}function js(i){return zt=1,sl(na,i)}function sl(i,e,t){var s=cn($t++,2);if(s.t=i,!s.__c&&(s.__=[t?t(e):na(void 0,e),function(o){var l=s.__N?s.__N[0]:s.__[0],h=s.t(l,o);l!==h&&(s.__N=[h,s.__[1]],s.__c.setState({}))}],s.__c=$,!$.u)){var n=function(o,l,h){if(!s.__c.__H)return!0;var c=s.__c.__H.__.filter(function(y){return!!y.__c});if(c.every(function(y){return!y.__N}))return!r||r.call(this,o,l,h);var u=!1;return c.forEach(function(y){if(y.__N){var g=y.__[0];y.__=y.__N,y.__N=void 0,g!==y.__[0]&&(u=!0)}}),!(!u&&s.__c.props===o)&&(!r||r.call(this,o,l,h))};$.u=!0;var r=$.shouldComponentUpdate,a=$.componentWillUpdate;$.componentWillUpdate=function(o,l,h){if(this.__e){var c=r;r=void 0,n(o,l,h),r=c}a&&a.call(this,o,l,h)},$.shouldComponentUpdate=n}return s.__N||s.__}function Mi(i,e){var t=cn($t++,3);!z.__s&&ia(t.__H,e)&&(t.__=i,t.i=e,$.__H.__h.push(t))}function Rs(i){return zt=5,hn(function(){return{current:i}},[])}function hn(i,e){var t=cn($t++,7);return ia(t.__H,e)&&(t.__=i(),t.__H=e,t.__h=i),t.__}function il(i,e){return zt=8,hn(function(){return i},e)}function nl(){for(var i;i=sa.shift();)if(i.__P&&i.__H)try{i.__H.__h.forEach(Is),i.__H.__h.forEach(Ri),i.__H.__h=[]}catch(e){i.__H.__h=[],z.__e(e,i.__v)}}z.__b=function(i){$=null,Ln&&Ln(i)},z.__=function(i,e){i&&e.__k&&e.__k.__m&&(i.__m=e.__k.__m),qn&&qn(i,e)},z.__r=function(i){jn&&jn(i),$t=0;var e=($=i.__c).__H;e&&(pi===$?(e.__h=[],$.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.i=t.__N=void 0})):(e.__h.forEach(Is),e.__h.forEach(Ri),e.__h=[],$t=0)),pi=$},z.diffed=function(i){$n&&$n(i);var e=i.__c;e&&e.__H&&(e.__H.__h.length&&(sa.push(e)!==1&&Bn===z.requestAnimationFrame||((Bn=z.requestAnimationFrame)||rl)(nl)),e.__H.__.forEach(function(t){t.i&&(t.__H=t.i),t.i=void 0})),pi=$=null},z.__c=function(i,e){e.some(function(t){try{t.__h.forEach(Is),t.__h=t.__h.filter(function(s){return!s.__||Ri(s)})}catch(s){e.some(function(n){n.__h&&(n.__h=[])}),e=[],z.__e(s,t.__v)}}),zn&&zn(i,e)},z.unmount=function(i){Hn&&Hn(i);var e,t=i.__c;t&&t.__H&&(t.__H.__.forEach(function(s){try{Is(s)}catch(n){e=n}}),t.__H=void 0,e&&z.__e(e,t.__v))};var Vn=typeof requestAnimationFrame=="function";function rl(i){var e,t=function(){clearTimeout(s),Vn&&cancelAnimationFrame(e),setTimeout(i)},s=setTimeout(t,100);Vn&&(e=requestAnimationFrame(t))}function Is(i){var e=$,t=i.__c;typeof t=="function"&&(i.__c=void 0,t()),$=e}function Ri(i){var e=$;i.__c=i.__(),$=e}function ia(i,e){return!i||i.length!==e.length||e.some(function(t,s){return t!==i[s]})}function na(i,e){return typeof e=="function"?e(i):e}function Wn(i,e){for(var t in i)if(t!=="__source"&&!(t in e))return!0;for(var s in e)if(s!=="__source"&&i[s]!==e[s])return!0;return!1}function Gn(i,e){this.props=i,this.context=e}(Gn.prototype=new ee).isPureReactComponent=!0,Gn.prototype.shouldComponentUpdate=function(i,e){return Wn(this.props,i)||Wn(this.state,e)};var Kn=N.__b;N.__b=function(i){i.type&&i.type.__f&&i.ref&&(i.props.ref=i.ref,i.ref=null),Kn&&Kn(i)};var al=N.__e;N.__e=function(i,e,t,s){if(i.then){for(var n,r=e;r=r.__;)if((n=r.__c)&&n.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),n.__c(i,e)}al(i,e,t,s)};var Xn=N.unmount;function ra(i,e,t){return i&&(i.__c&&i.__c.__H&&(i.__c.__H.__.forEach(function(s){typeof s.__c=="function"&&s.__c()}),i.__c.__H=null),(i=function(s,n){for(var r in n)s[r]=n[r];return s}({},i)).__c!=null&&(i.__c.__P===t&&(i.__c.__P=e),i.__c=null),i.__k=i.__k&&i.__k.map(function(s){return ra(s,e,t)})),i}function aa(i,e,t){return i&&t&&(i.__v=null,i.__k=i.__k&&i.__k.map(function(s){return aa(s,e,t)}),i.__c&&i.__c.__P===e&&(i.__e&&t.appendChild(i.__e),i.__c.__e=!0,i.__c.__P=t)),i}function fi(){this.__u=0,this.t=null,this.__b=null}function oa(i){var e=i.__.__c;return e&&e.__a&&e.__a(i)}function Fs(){this.u=null,this.o=null}N.unmount=function(i){var e=i.__c;e&&e.__R&&e.__R(),e&&32&i.__u&&(i.type=null),Xn&&Xn(i)},(fi.prototype=new ee).__c=function(i,e){var t=e.__c,s=this;s.t==null&&(s.t=[]),s.t.push(t);var n=oa(s.__v),r=!1,a=function(){r||(r=!0,t.__R=null,n?n(o):o())};t.__R=a;var o=function(){if(!--s.__u){if(s.state.__a){var l=s.state.__a;s.__v.__k[0]=aa(l,l.__c.__P,l.__c.__O)}var h;for(s.setState({__a:s.__b=null});h=s.t.pop();)h.forceUpdate()}};s.__u++||32&e.__u||s.setState({__a:s.__b=s.__v.__k[0]}),i.then(a,a)},fi.prototype.componentWillUnmount=function(){this.t=[]},fi.prototype.render=function(i,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),s=this.__v.__k[0].__c;this.__v.__k[0]=ra(this.__b,t,s.__O=s.__P)}this.__b=null}var n=e.__a&&jt(pe,null,i.fallback);return n&&(n.__u&=-33),[jt(pe,null,e.__a?null:i.children),n]};var Yn=function(i,e,t){if(++t[1]===t[0]&&i.o.delete(e),i.props.revealOrder&&(i.props.revealOrder[0]!=="t"||!i.o.size))for(t=i.u;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;i.u=t=t[2]}};(Fs.prototype=new ee).__a=function(i){var e=this,t=oa(e.__v),s=e.o.get(i);return s[0]++,function(n){var r=function(){e.props.revealOrder?(s.push(n),Yn(e,i,s)):n()};t?t(r):r()}},Fs.prototype.render=function(i){this.u=null,this.o=new Map;var e=ce(i.children);i.revealOrder&&i.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.o.set(e[t],this.u=[1,0,this.u]);return i.children},Fs.prototype.componentDidUpdate=Fs.prototype.componentDidMount=function(){var i=this;this.o.forEach(function(e,t){Yn(i,t,e)})};var ol=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,ll=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,dl=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,ul=/[A-Z0-9]/g,cl=typeof document<"u",hl=function(i){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(i)};function Jn(i,e,t){return e.__k==null&&(e.textContent=""),tl(i,e),typeof t=="function"&&t(),i?i.__c:null}ee.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(i){Object.defineProperty(ee.prototype,i,{configurable:!0,get:function(){return this["UNSAFE_"+i]},set:function(e){Object.defineProperty(this,i,{configurable:!0,writable:!0,value:e})}})});var Qn=N.event;function pl(){}function fl(){return this.cancelBubble}function ml(){return this.defaultPrevented}N.event=function(i){return Qn&&(i=Qn(i)),i.persist=pl,i.isPropagationStopped=fl,i.isDefaultPrevented=ml,i.nativeEvent=i};var gl={enumerable:!1,configurable:!0,get:function(){return this.class}},Zn=N.vnode;N.vnode=function(i){typeof i.type=="string"&&function(e){var t=e.props,s=e.type,n={},r=s.indexOf("-")===-1;for(var a in t){var o=t[a];if(!(a==="value"&&"defaultValue"in t&&o==null||cl&&a==="children"&&s==="noscript"||a==="class"||a==="className")){var l=a.toLowerCase();a==="defaultValue"&&"value"in t&&t.value==null?a="value":a==="download"&&o===!0?o="":l==="translate"&&o==="no"?o=!1:l[0]==="o"&&l[1]==="n"?l==="ondoubleclick"?a="ondblclick":l!=="onchange"||s!=="input"&&s!=="textarea"||hl(t.type)?l==="onfocus"?a="onfocusin":l==="onblur"?a="onfocusout":dl.test(a)&&(a=l):l=a="oninput":r&&ll.test(a)?a=a.replace(ul,"-$&").toLowerCase():o===null&&(o=void 0),l==="oninput"&&n[a=l]&&(a="oninputCapture"),n[a]=o}}s=="select"&&n.multiple&&Array.isArray(n.value)&&(n.value=ce(t.children).forEach(function(h){h.props.selected=n.value.indexOf(h.props.value)!=-1})),s=="select"&&n.defaultValue!=null&&(n.value=ce(t.children).forEach(function(h){h.props.selected=n.multiple?n.defaultValue.indexOf(h.props.value)!=-1:n.defaultValue==h.props.value})),t.class&&!t.className?(n.class=t.class,Object.defineProperty(n,"className",gl)):(t.className&&!t.class||t.class&&t.className)&&(n.class=n.className=t.className),e.props=n}(i),i.$$typeof=ol,Zn&&Zn(i)};var er=N.__r;N.__r=function(i){er&&er(i),i.__c};var tr=N.diffed;N.diffed=function(i){tr&&tr(i);var e=i.props,t=i.__e;t!=null&&i.type==="textarea"&&"value"in e&&e.value!==t.value&&(t.value=e.value==null?"":e.value)};function yl(i){let e=null,t;return(...s)=>(t=s,e||(e=Promise.resolve().then(()=>(e=null,i(...t)))),e)}var Wt;const zs=class zs extends Hr{constructor(){super(...arguments);v(this,Wt);m(this,"isTargetDOMEl");m(this,"el");m(this,"parent");m(this,"title")}getTargetPlugin(t){let s;if(typeof(t==null?void 0:t.addTarget)=="function")s=t,s instanceof zs||console.warn(new Error("The provided plugin is not an instance of UIPlugin. This is an indication of a bug with the way Uppy is bundled.",{cause:{targetPlugin:s,UIPlugin:zs}}));else if(typeof t=="function"){const n=t;this.uppy.iteratePlugins(r=>{r instanceof n&&(s=r)})}return s}mount(t,s){const n=s.id,r=Ko(t);if(r){this.isTargetDOMEl=!0;const l=document.createElement("div");return l.classList.add("uppy-Root"),F(this,Wt,yl(h=>{this.uppy.getPlugin(this.id)&&(Jn(this.render(h,l),l),this.afterUpdate())})),this.uppy.log(`Installing ${n} to a DOM element '${t}'`),this.opts.replaceTargetContent&&(r.innerHTML=""),Jn(this.render(this.uppy.getState(),l),l),this.el=l,r.appendChild(l),l.dir=this.opts.direction||Vr(l)||"ltr",this.onMount(),this.el}const a=this.getTargetPlugin(t);if(a)return this.uppy.log(`Installing ${n} to ${a.id}`),this.parent=a,this.el=a.addTarget(s),this.onMount(),this.el;this.uppy.log(`Not installing ${n}`);let o=`Invalid target option given to ${n}.`;throw typeof t=="function"?o+=" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.":o+="If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\n\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.",new Error(o)}render(t,s){throw new Error("Extend the render method to add your plugin to a DOM element")}update(t){var s;this.el!=null&&((s=p(this,Wt))==null||s.call(this,t))}unmount(){var t;this.isTargetDOMEl&&((t=this.el)==null||t.remove()),this.onUnmount()}onMount(){}onUnmount(){}};Wt=new WeakMap;let Tt=zs;const bl="4.3.2",vl={version:bl};var ot,Hs,da;class la{constructor(){v(this,Hs);m(this,"state",{});v(this,ot,new Set)}getState(){return this.state}setState(e){const t={...this.state},s={...this.state,...e};this.state=s,_(this,Hs,da).call(this,t,s,e)}subscribe(e){return p(this,ot).add(e),()=>{p(this,ot).delete(e)}}}ot=new WeakMap,Hs=new WeakSet,da=function(...e){p(this,ot).forEach(t=>{t(...e)})},m(la,"VERSION",vl.version);function ua(i){const e=i.lastIndexOf(".");return e===-1||e===i.length-1?{name:i,extension:void 0}:{name:i.slice(0,e),extension:i.slice(e+1)}}const sr={__proto__:null,md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",webp:"image/webp",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",dicom:"application/dicom",doc:"application/msword",msg:"application/vnd.ms-outlook",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"};function ca(i){var t;if(i.type)return i.type;const e=i.name?(t=ua(i.name).extension)==null?void 0:t.toLowerCase():null;return e&&e in sr?sr[e]:"application/octet-stream"}function wl(i){return i.charCodeAt(0).toString(32)}function ir(i){let e="";return i.replace(/[^A-Z0-9]/gi,t=>(e+=`-${wl(t)}`,"/"))+e}function _l(i,e){let t=e||"uppy";return typeof i.name=="string"&&(t+=`-${ir(i.name.toLowerCase())}`),i.type!==void 0&&(t+=`-${i.type}`),i.meta&&typeof i.meta.relativePath=="string"&&(t+=`-${ir(i.meta.relativePath.toLowerCase())}`),i.data.size!==void 0&&(t+=`-${i.data.size}`),i.data.lastModified!==void 0&&(t+=`-${i.data.lastModified}`),t}function Sl(i){return!i.isRemote||!i.remote?!1:new Set(["box","dropbox","drive","facebook","unsplash"]).has(i.remote.provider)}function Fl(i,e){if(Sl(i))return i.id;const t=ca(i);return _l({...i,type:t},e)}var Cl=function(){var e={},t=e._fns={};e.emit=function(a,o,l,h,c,u,y){var g=s(a);g.length&&n(a,g,[o,l,h,c,u,y])},e.on=function(a,o){t[a]||(t[a]=[]),t[a].push(o)},e.once=function(a,o){function l(){o.apply(this,arguments),e.off(a,l)}this.on(a,l)},e.off=function(a,o){var l=[];if(a&&o){var h=this._fns[a],c=0,u=h?h.length:0;for(c;c<u;c++)h[c]!==o&&l.push(h[c])}l.length?this._fns[a]=l:delete this._fns[a]};function s(r){var a=t[r]?t[r]:[],o=r.indexOf(":"),l=o===-1?[r]:[r.substring(0,o),r.substring(o+1)],h=Object.keys(t),c=0,u=h.length;for(c;c<u;c++){var y=h[c];if(y==="*"&&(a=a.concat(t[y])),l.length===2&&l[0]===y){a=a.concat(t[y]);break}}return a}function n(r,a,o){var l=0,h=a.length;for(l;l<h&&a[l];l++)a[l].event=r,a[l].apply(a[l],o)}return e};const xl=cs(Cl);let Pl="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",pn=(i=21)=>{let e="",t=i|0;for(;t--;)e+=Pl[Math.random()*64|0];return e};const kl="4.5.3",Tl={version:kl};function El(i,e){return e.name?e.name:i.split("/")[0]==="image"?`${i.split("/")[0]}.${i.split("/")[1]}`:"noname"}const Nl={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},aggregateExceedsSize:"You selected %{size} of files, but maximum allowed size is %{sizeAllowed}",exceedsSize:"%{file} exceeds maximum allowed size of %{size}",missingRequiredMetaField:"Missing required meta fields",missingRequiredMetaFieldOnFile:"Missing required meta fields in %{fileName}",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noMoreFilesAllowed:"Cannot add more files",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",authAborted:"Authentication aborted",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",noSearchResults:"Unfortunately, there are no results for this search",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},allFilesFromFolderNamed:"All files from folder %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",logIn:"Log in",pickFiles:"Pick files",pickPhotos:"Pick photos",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",loadedXFiles:"Loaded %{numFiles} files",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",signInWithGoogle:"Sign in with Google",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",search:"Search",resetSearch:"Reset search",emptyFolderAdded:"No files were added from empty folder",addedNumFiles:"Added %{numFiles} file(s)",folderAlreadyAdded:'The folder "%{folder}" was already added',folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"},additionalRestrictionsFailed:"%{count} additional restrictions were not fulfilled",unnamed:"Unnamed",pleaseWait:"Please wait"}};var Ul=function(e){if(typeof e!="number"||Number.isNaN(e))throw new TypeError(`Expected a number, got ${typeof e}`);const t=e<0;let s=Math.abs(e);if(t&&(s=-s),s===0)return"0 B";const n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],r=Math.min(Math.floor(Math.log(s)/Math.log(1024)),n.length-1),a=Number(s/1024**r),o=n[r];return`${a>=10||a%1===0?Math.round(a):a.toFixed(1)} ${o}`};const qe=cs(Ul);function ha(i,e){this.text=i=i||"",this.hasWild=~i.indexOf("*"),this.separator=e,this.parts=i.split(e)}ha.prototype.match=function(i){var e=!0,t=this.parts,s,n=t.length,r;if(typeof i=="string"||i instanceof String)if(!this.hasWild&&this.text!=i)e=!1;else{for(r=(i||"").split(this.separator),s=0;e&&s<n;s++)t[s]!=="*"&&(s<r.length?e=t[s]===r[s]:e=!1);e=e&&r}else if(typeof i.splice=="function")for(e=[],s=i.length;s--;)this.match(i[s])&&(e[e.length]=i[s]);else if(typeof i=="object"){e={};for(var a in i)this.match(a)&&(e[a]=i[a])}return e};var Al=function(i,e,t){var s=new ha(i,t||/[\/\.]/);return typeof e<"u"?s.match(e):s},Ol=Al,Ml=/[\/\+\.]/,Rl=function(i,e){function t(s){var n=Ol(s,i,Ml);return n&&n.length>=2}return e?t(e.split(";")[0]):t};const Il=cs(Rl),Dl={maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null,requiredMetaFields:[]};class de extends Error{constructor(t,s){super(t);m(this,"isUserFacing");m(this,"file");m(this,"isRestriction",!0);this.isUserFacing=(s==null?void 0:s.isUserFacing)??!0,s!=null&&s.file&&(this.file=s.file)}}class Bl{constructor(e,t){m(this,"getI18n");m(this,"getOpts");this.getI18n=t,this.getOpts=()=>{var n;const s=e();if(((n=s.restrictions)==null?void 0:n.allowedFileTypes)!=null&&!Array.isArray(s.restrictions.allowedFileTypes))throw new TypeError("`restrictions.allowedFileTypes` must be an array");return s}}validateAggregateRestrictions(e,t){const{maxTotalFileSize:s,maxNumberOfFiles:n}=this.getOpts().restrictions;if(n&&e.filter(a=>!a.isGhost).length+t.length>n)throw new de(`${this.getI18n()("youCanOnlyUploadX",{smart_count:n})}`);if(s){const r=[...e,...t].reduce((a,o)=>a+(o.size??0),0);if(r>s)throw new de(this.getI18n()("aggregateExceedsSize",{sizeAllowed:qe(s),size:qe(r)}))}}validateSingleFile(e){const{maxFileSize:t,minFileSize:s,allowedFileTypes:n}=this.getOpts().restrictions;if(n&&!n.some(a=>a.includes("/")?e.type?Il(e.type.replace(/;.*?$/,""),a):!1:a[0]==="."&&e.extension?e.extension.toLowerCase()===a.slice(1).toLowerCase():!1)){const a=n.join(", ");throw new de(this.getI18n()("youCanOnlyUploadFileTypes",{types:a}),{file:e})}if(t&&e.size!=null&&e.size>t)throw new de(this.getI18n()("exceedsSize",{size:qe(t),file:e.name??this.getI18n()("unnamed")}),{file:e});if(s&&e.size!=null&&e.size<s)throw new de(this.getI18n()("inferiorSize",{size:qe(s)}),{file:e})}validate(e,t){t.forEach(s=>{this.validateSingleFile(s)}),this.validateAggregateRestrictions(e,t)}validateMinNumberOfFiles(e){const{minNumberOfFiles:t}=this.getOpts().restrictions;if(t&&Object.keys(e).length<t)throw new de(this.getI18n()("youHaveToAtLeastSelectX",{smart_count:t}))}getMissingRequiredMetaFields(e){const t=new de(this.getI18n()("missingRequiredMetaFieldOnFile",{fileName:e.name??this.getI18n()("unnamed")})),{requiredMetaFields:s}=this.getOpts().restrictions,n=[];for(const r of s)(!Object.hasOwn(e.meta,r)||e.meta[r]==="")&&n.push(r);return{missingFields:n,error:t}}}function Ll(i){if(i==null&&typeof navigator<"u"&&(i=navigator.userAgent),!i)return!0;const e=/Edge\/(\d+\.\d+)/.exec(i);if(!e)return!0;const s=e[1].split(".",2),n=parseInt(s[0],10),r=parseInt(s[1],10);return n<15||n===15&&r<15063||n>18||n===18&&r>=18218}const Cs={totalProgress:0,allowNewUpload:!0,error:null,recoveredState:null};var ie,ne,Gt,Ve,lt,dt,We,P,ze,Di,pa,Bi,fa,Li,ji,$i,zi,qs,Hi,Ge,ma,ga,Me,Kt,At,ya,Ds,Ot;const Vs=class Vs{constructor(e){v(this,P);v(this,ie,Object.create(null));v(this,ne);v(this,Gt);v(this,Ve,xl());v(this,lt,new Set);v(this,dt,new Set);v(this,We,new Set);m(this,"defaultLocale");m(this,"locale");m(this,"opts");m(this,"store");m(this,"i18n");m(this,"i18nArray");m(this,"scheduledAutoProceed",null);m(this,"wasOffline",!1);v(this,qs,(e,t)=>{const s=e?this.getFile(e.id):void 0;if(e==null||!s){this.log(`Not setting progress for a file that has been removed: ${e==null?void 0:e.id}`);return}if(s.progress.percentage===100){this.log(`Not setting progress for a file that has been already uploaded: ${e.id}`);return}const n={bytesTotal:t.bytesTotal,percentage:t.bytesTotal!=null&&Number.isFinite(t.bytesTotal)&&t.bytesTotal>0?Math.round(t.bytesUploaded/t.bytesTotal*100):void 0};s.progress.uploadStarted!=null?this.setFileState(e.id,{progress:{...s.progress,...n,bytesUploaded:t.bytesUploaded}}):this.setFileState(e.id,{progress:{...s.progress,...n}}),p(this,Ge).call(this)});v(this,Ge,Bo(()=>_(this,P,Hi).call(this),500,{leading:!0,trailing:!0}));v(this,Me,this.updateOnlineStatus.bind(this));v(this,Kt,new Map);this.defaultLocale=Nl;const t={id:"uppy",autoProceed:!1,allowMultipleUploadBatches:!0,debug:!1,restrictions:Dl,meta:{},onBeforeFileAdded:(n,r)=>!Object.hasOwn(r,n.id),onBeforeUpload:n=>n,store:new la,logger:Wo,infoTimeout:5e3},s={...t,...e};this.opts={...s,restrictions:{...t.restrictions,...e==null?void 0:e.restrictions}},e!=null&&e.logger&&e.debug?this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning"):e!=null&&e.debug&&(this.opts.logger=Go),this.log(`Using Core v${Vs.VERSION}`),this.i18nInit(),this.store=this.opts.store,this.setState({...Cs,plugins:{},files:{},currentUploads:{},capabilities:{uploadProgress:Ll(),individualCancellation:!0,resumableUploads:!1},meta:{...this.opts.meta},info:[]}),F(this,ne,new Bl(()=>this.opts,()=>this.i18n)),F(this,Gt,this.store.subscribe((n,r,a)=>{this.emit("state-update",n,r,a),this.updateAll(r)})),this.opts.debug&&typeof window<"u"&&(window[this.opts.id]=this),_(this,P,ga).call(this)}emit(e,...t){p(this,Ve).emit(e,...t)}on(e,t){return p(this,Ve).on(e,t),this}once(e,t){return p(this,Ve).once(e,t),this}off(e,t){return p(this,Ve).off(e,t),this}updateAll(e){this.iteratePlugins(t=>{t.update(e)})}setState(e){this.store.setState(e)}getState(){return this.store.getState()}patchFilesState(e){const t=this.getState().files;this.setState({files:{...t,...Object.fromEntries(Object.entries(e).map(([s,n])=>[s,{...t[s],...n}]))}})}setFileState(e,t){if(!this.getState().files[e])throw new Error(`Canâ€™t set state for ${e} (the file could have been removed)`);this.patchFilesState({[e]:t})}i18nInit(){const e=s=>this.log(`Missing i18n string: ${s}`,"error"),t=new zr([this.defaultLocale,this.opts.locale],{onMissingKey:e});this.i18n=t.translate.bind(t),this.i18nArray=t.translateArray.bind(t),this.locale=t.locale}setOptions(e){this.opts={...this.opts,...e,restrictions:{...this.opts.restrictions,...e==null?void 0:e.restrictions}},e.meta&&this.setMeta(e.meta),this.i18nInit(),e.locale&&this.iteratePlugins(t=>{t.setOptions(e)}),this.setState(void 0)}resetProgress(){const e={percentage:0,bytesUploaded:!1,uploadComplete:!1,uploadStarted:null},t={...this.getState().files},s=Object.create(null);Object.keys(t).forEach(n=>{s[n]={...t[n],progress:{...t[n].progress,...e},tus:void 0,transloadit:void 0}}),this.setState({files:s,...Cs})}clear(){const{capabilities:e,currentUploads:t}=this.getState();if(Object.keys(t).length>0&&!e.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");this.setState({...Cs,files:{}})}addPreProcessor(e){p(this,lt).add(e)}removePreProcessor(e){return p(this,lt).delete(e)}addPostProcessor(e){p(this,We).add(e)}removePostProcessor(e){return p(this,We).delete(e)}addUploader(e){p(this,dt).add(e)}removeUploader(e){return p(this,dt).delete(e)}setMeta(e){const t={...this.getState().meta,...e},s={...this.getState().files};Object.keys(s).forEach(n=>{s[n]={...s[n],meta:{...s[n].meta,...e}}}),this.log("Adding metadata:"),this.log(e),this.setState({meta:t,files:s})}setFileMeta(e,t){const s={...this.getState().files};if(!s[e]){this.log(`Was trying to set metadata for a file that has been removed: ${e}`);return}const n={...s[e].meta,...t};s[e]={...s[e],meta:n},this.setState({files:s})}getFile(e){return this.getState().files[e]}getFiles(){const{files:e}=this.getState();return Object.values(e)}getFilesByIds(e){return e.map(t=>this.getFile(t))}getObjectOfFilesPerState(){const{files:e,totalProgress:t,error:s}=this.getState(),n=Object.values(e),r=[],a=[],o=[],l=[],h=[],c=[],u=[],y=[],g=[];for(const w of n){const{progress:x}=w;!x.uploadComplete&&x.uploadStarted&&(r.push(w),w.isPaused||y.push(w)),x.uploadStarted||a.push(w),(x.uploadStarted||x.preprocess||x.postprocess)&&o.push(w),x.uploadStarted&&l.push(w),w.isPaused&&h.push(w),x.uploadComplete&&c.push(w),w.error&&u.push(w),(x.preprocess||x.postprocess)&&g.push(w)}return{newFiles:a,startedFiles:o,uploadStartedFiles:l,pausedFiles:h,completeFiles:c,erroredFiles:u,inProgressFiles:r,inProgressNotPausedFiles:y,processingFiles:g,isUploadStarted:l.length>0,isAllComplete:t===100&&c.length===n.length&&g.length===0,isAllErrored:!!s&&u.length===n.length,isAllPaused:r.length!==0&&h.length===r.length,isUploadInProgress:r.length>0,isSomeGhost:n.some(w=>w.isGhost)}}validateRestrictions(e,t=this.getFiles()){try{p(this,ne).validate(t,[e])}catch(s){return s}return null}validateSingleFile(e){try{p(this,ne).validateSingleFile(e)}catch(t){return t.message}return null}validateAggregateRestrictions(e){const t=this.getFiles();try{p(this,ne).validateAggregateRestrictions(t,e)}catch(s){return s.message}return null}checkIfFileAlreadyExists(e){const{files:t}=this.getState();return!!(t[e]&&!t[e].isGhost)}addFile(e){_(this,P,Bi).call(this,e);const{nextFilesState:t,validFilesToAdd:s,errors:n}=_(this,P,ji).call(this,[e]),r=n.filter(o=>o.isRestriction);if(_(this,P,ze).call(this,r),n.length>0)throw n[0];this.setState({files:t});const[a]=s;return this.emit("file-added",a),this.emit("files-added",s),this.log(`Added file: ${a.name}, ${a.id}, mime type: ${a.type}`),_(this,P,Li).call(this),a.id}addFiles(e){_(this,P,Bi).call(this);const{nextFilesState:t,validFilesToAdd:s,errors:n}=_(this,P,ji).call(this,e),r=n.filter(o=>o.isRestriction);_(this,P,ze).call(this,r);const a=n.filter(o=>!o.isRestriction);if(a.length>0){let o=`Multiple errors occurred while adding files:
`;if(a.forEach(l=>{o+=`
 * ${l.message}`}),this.info({message:this.i18n("addBulkFilesFailed",{smart_count:a.length}),details:o},"error",this.opts.infoTimeout),typeof AggregateError=="function")throw new AggregateError(a,o);{const l=new Error(o);throw l.errors=a,l}}this.setState({files:t}),s.forEach(o=>{this.emit("file-added",o)}),this.emit("files-added",s),s.length>5?this.log(`Added batch of ${s.length} files`):Object.values(s).forEach(o=>{this.log(`Added file: ${o.name}
 id: ${o.id}
 type: ${o.type}`)}),s.length>0&&_(this,P,Li).call(this)}removeFiles(e){const{files:t,currentUploads:s}=this.getState(),n={...t},r={...s},a=Object.create(null);e.forEach(c=>{t[c]&&(a[c]=t[c],delete n[c])});function o(c){return a[c]===void 0}Object.keys(r).forEach(c=>{const u=s[c].fileIDs.filter(o);if(u.length===0){delete r[c];return}const{capabilities:y}=this.getState();if(u.length!==s[c].fileIDs.length&&!y.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");r[c]={...s[c],fileIDs:u}});const l={currentUploads:r,files:n};Object.keys(n).length===0&&(l.allowNewUpload=!0,l.error=null,l.recoveredState=null),this.setState(l),p(this,Ge).call(this);const h=Object.keys(a);h.forEach(c=>{this.emit("file-removed",a[c])}),h.length>5?this.log(`Removed ${h.length} files`):this.log(`Removed files: ${h.join(", ")}`)}removeFile(e){this.removeFiles([e])}pauseResume(e){if(!this.getState().capabilities.resumableUploads||this.getFile(e).progress.uploadComplete)return;const t=this.getFile(e),n=!(t.isPaused||!1);return this.setFileState(e,{isPaused:n}),this.emit("upload-pause",t,n),n}pauseAll(){const e={...this.getState().files};Object.keys(e).filter(s=>!e[s].progress.uploadComplete&&e[s].progress.uploadStarted).forEach(s=>{const n={...e[s],isPaused:!0};e[s]=n}),this.setState({files:e}),this.emit("pause-all")}resumeAll(){const e={...this.getState().files};Object.keys(e).filter(s=>!e[s].progress.uploadComplete&&e[s].progress.uploadStarted).forEach(s=>{const n={...e[s],isPaused:!1,error:null};e[s]=n}),this.setState({files:e}),this.emit("resume-all")}async retryAll(){const e=await _(this,P,zi).call(this);return this.emit("complete",e),e}cancelAll(){this.emit("cancel-all");const{files:e}=this.getState(),t=Object.keys(e);t.length&&this.removeFiles(t),this.setState(Cs)}retryUpload(e){this.setFileState(e,{error:null,isPaused:!1}),this.emit("upload-retry",this.getFile(e));const t=_(this,P,At).call(this,[e],{forceAllowNewUpload:!0});return _(this,P,Ot).call(this,t)}logout(){this.iteratePlugins(e=>{var t,s;(s=(t=e.provider)==null?void 0:t.logout)==null||s.call(t)})}[Symbol.for("uppy test: updateTotalProgress")](){return _(this,P,Hi).call(this)}updateOnlineStatus(){window.navigator.onLine??!0?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)}getID(){return this.opts.id}use(e,...t){if(typeof e!="function"){const a=`Expected a plugin class, but got ${e===null?"null":typeof e}. Please verify that the plugin was imported and spelled correctly.`;throw new TypeError(a)}const s=new e(this,...t),n=s.id;if(!n)throw new Error("Your plugin must have an id");if(!s.type)throw new Error("Your plugin must have a type");const r=this.getPlugin(n);if(r){const a=`Already found a plugin named '${r.id}'. Tried to use: '${n}'.
Uppy plugins must have unique \`id\` options.`;throw new Error(a)}return e.VERSION&&this.log(`Using ${n} v${e.VERSION}`),s.type in p(this,ie)?p(this,ie)[s.type].push(s):p(this,ie)[s.type]=[s],s.install(),this.emit("plugin-added",s),this}getPlugin(e){for(const t of Object.values(p(this,ie))){const s=t.find(n=>n.id===e);if(s!=null)return s}}[Symbol.for("uppy test: getPlugins")](e){return p(this,ie)[e]}iteratePlugins(e){Object.values(p(this,ie)).flat(1).forEach(e)}removePlugin(e){this.log(`Removing plugin ${e.id}`),this.emit("plugin-remove",e),e.uninstall&&e.uninstall();const t=p(this,ie)[e.type],s=t.findIndex(a=>a.id===e.id);s!==-1&&t.splice(s,1);const r={plugins:{...this.getState().plugins,[e.id]:void 0}};this.setState(r)}destroy(){this.log(`Closing Uppy instance ${this.opts.id}: removing all files and uninstalling plugins`),this.cancelAll(),p(this,Gt).call(this),this.iteratePlugins(e=>{this.removePlugin(e)}),typeof window<"u"&&window.removeEventListener&&(window.removeEventListener("online",p(this,Me)),window.removeEventListener("offline",p(this,Me)))}hideInfo(){const{info:e}=this.getState();this.setState({info:e.slice(1)}),this.emit("info-hidden")}info(e,t="info",s=3e3){const n=typeof e=="object";this.setState({info:[...this.getState().info,{type:t,message:n?e.message:e,details:n?e.details:null}]}),setTimeout(()=>this.hideInfo(),s),this.emit("info-visible")}log(e,t){const{logger:s}=this.opts;switch(t){case"error":s.error(e);break;case"warning":s.warn(e);break;default:s.debug(e);break}}registerRequestClient(e,t){p(this,Kt).set(e,t)}getRequestClientForFile(e){if(!e.remote)throw new Error(`Tried to get RequestClient for a non-remote file ${e.id}`);const t=p(this,Kt).get(e.remote.requestClientId);if(t==null)throw new Error(`requestClientId "${e.remote.requestClientId}" not registered for file "${e.id}"`);return t}restore(e){return this.log(`Core: attempting to restore upload "${e}"`),this.getState().currentUploads[e]?_(this,P,Ot).call(this,e):(_(this,P,Ds).call(this,e),Promise.reject(new Error("Nonexistent upload")))}[Symbol.for("uppy test: createUpload")](...e){return _(this,P,At).call(this,...e)}addResultData(e,t){if(!_(this,P,ya).call(this,e)){this.log(`Not setting result for an upload that has been removed: ${e}`);return}const{currentUploads:s}=this.getState(),n={...s[e],result:{...s[e].result,...t}};this.setState({currentUploads:{...s,[e]:n}})}async upload(){var n;(n=p(this,ie).uploader)!=null&&n.length||this.log("No uploader type plugins are used","warning");let{files:e}=this.getState();if(_(this,P,$i).call(this).length>0){const r=await _(this,P,zi).call(this);if(!(this.getFiles().filter(o=>o.progress.uploadStarted==null).length>0))return this.emit("complete",r),r;({files:e}=this.getState())}const s=this.opts.onBeforeUpload(e);return s===!1?Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false")):(s&&typeof s=="object"&&(e=s,this.setState({files:e})),Promise.resolve().then(()=>p(this,ne).validateMinNumberOfFiles(e)).catch(r=>{throw _(this,P,ze).call(this,[r]),r}).then(()=>{if(!_(this,P,pa).call(this,e))throw new de(this.i18n("missingRequiredMetaField"))}).catch(r=>{throw r}).then(async()=>{const{currentUploads:r}=this.getState(),a=Object.values(r).flatMap(c=>c.fileIDs),o=[];Object.keys(e).forEach(c=>{const u=this.getFile(c);!u.progress.uploadStarted&&a.indexOf(c)===-1&&o.push(u.id)});const l=_(this,P,At).call(this,o),h=await _(this,P,Ot).call(this,l);return this.emit("complete",h),h}).catch(r=>{throw this.emit("error",r),this.log(r,"error"),r}))}};ie=new WeakMap,ne=new WeakMap,Gt=new WeakMap,Ve=new WeakMap,lt=new WeakMap,dt=new WeakMap,We=new WeakMap,P=new WeakSet,ze=function(e){for(const a of e)a.isRestriction?this.emit("restriction-failed",a.file,a):this.emit("error",a,a.file),this.log(a,"warning");const t=e.filter(a=>a.isUserFacing),s=4,n=t.slice(0,s),r=t.slice(s);n.forEach(({message:a,details:o=""})=>{this.info({message:a,details:o},"error",this.opts.infoTimeout)}),r.length>0&&this.info({message:this.i18n("additionalRestrictionsFailed",{count:r.length})})},Di=function(e){const{missingFields:t,error:s}=p(this,ne).getMissingRequiredMetaFields(e);return t.length>0?(this.setFileState(e.id,{missingRequiredMetaFields:t,error:s.message}),this.log(s.message),this.emit("restriction-failed",e,s),!1):(t.length===0&&e.missingRequiredMetaFields&&this.setFileState(e.id,{missingRequiredMetaFields:[]}),!0)},pa=function(e){let t=!0;for(const s of Object.values(e))_(this,P,Di).call(this,s)||(t=!1);return t},Bi=function(e){const{allowNewUpload:t}=this.getState();if(t===!1){const s=new de(this.i18n("noMoreFilesAllowed"),{file:e});throw _(this,P,ze).call(this,[s]),s}},fa=function(e){const t=e instanceof File?{name:e.name,type:e.type,size:e.size,data:e}:e,s=ca(t),n=El(s,t),r=ua(n).extension,a=Fl(t,this.getID()),o=t.meta||{};o.name=n,o.type=s;const l=Number.isFinite(t.data.size)?t.data.size:null;return{source:t.source||"",id:a,name:n,extension:r||"",meta:{...this.getState().meta,...o},type:s,data:t.data,progress:{percentage:0,bytesUploaded:!1,bytesTotal:l,uploadComplete:!1,uploadStarted:null},size:l,isGhost:!1,isRemote:t.isRemote||!1,remote:t.remote,preview:t.preview}},Li=function(){this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout(()=>{this.scheduledAutoProceed=null,this.upload().catch(e=>{e.isRestriction||this.log(e.stack||e.message||e)})},4))},ji=function(e){var a;let{files:t}=this.getState(),s={...t};const n=[],r=[];for(const o of e)try{let l=_(this,P,fa).call(this,o);const h=(a=t[l.id])==null?void 0:a.isGhost;h&&(l={...t[l.id],isGhost:!1,data:o.data},this.log(`Replaced the blob in the restored ghost file: ${l.name}, ${l.id}`));const c=this.opts.onBeforeFileAdded(l,s);if(t=this.getState().files,s={...t,...s},!c&&this.checkIfFileAlreadyExists(l.id))throw new de(this.i18n("noDuplicates",{fileName:l.name??this.i18n("unnamed")}),{file:o});if(c===!1&&!h)throw new de("Cannot add the file because onBeforeFileAdded returned false.",{isUserFacing:!1,file:o});typeof c=="object"&&c!==null&&(l=c),p(this,ne).validateSingleFile(l),s[l.id]=l,n.push(l)}catch(l){r.push(l)}try{p(this,ne).validateAggregateRestrictions(Object.values(t),n)}catch(o){return r.push(o),{nextFilesState:t,validFilesToAdd:[],errors:r}}return{nextFilesState:s,validFilesToAdd:n,errors:r}},$i=function(){const{files:e}=this.getState();return Object.keys(e).filter(t=>{const s=e[t];return s.error&&(!s.missingRequiredMetaFields||s.missingRequiredMetaFields.length===0)})},zi=async function(){const e=_(this,P,$i).call(this),t={...this.getState().files};if(e.forEach(n=>{t[n]={...t[n],isPaused:!1,error:null}}),this.setState({files:t,error:null}),this.emit("retry-all",this.getFilesByIds(e)),e.length===0)return{successful:[],failed:[]};const s=_(this,P,At).call(this,e,{forceAllowNewUpload:!0});return _(this,P,Ot).call(this,s)},qs=new WeakMap,Hi=function(){const e=_(this,P,ma).call(this);let t=null;e!=null&&(t=Math.round(e*100),t>100?t=100:t<0&&(t=0)),this.emit("progress",t??0),this.setState({totalProgress:t??0})},Ge=new WeakMap,ma=function(){const t=this.getFiles().filter(l=>l.progress.uploadStarted||l.progress.preprocess||l.progress.postprocess);if(t.length===0)return 0;if(t.every(l=>l.progress.uploadComplete))return 1;const s=l=>l.progress.bytesTotal!=null&&l.progress.bytesTotal!==0,n=t.filter(s),r=t.filter(l=>!s(l));if(n.every(l=>l.progress.uploadComplete)&&r.length>0&&!r.every(l=>l.progress.uploadComplete))return null;const a=n.reduce((l,h)=>l+(h.progress.bytesTotal??0),0),o=n.reduce((l,h)=>l+(h.progress.bytesUploaded||0),0);return a===0?0:o/a},ga=function(){const e=(n,r,a)=>{let o=n.message||"Unknown error";n.details&&(o+=` ${n.details}`),this.setState({error:o}),r!=null&&r.id in this.getState().files&&this.setFileState(r.id,{error:o,response:a})};this.on("error",e),this.on("upload-error",(n,r,a)=>{if(e(r,n,a),typeof r=="object"&&r.message){this.log(r.message,"error");const o=new Error(this.i18n("failedToUpload",{file:(n==null?void 0:n.name)??""}));o.isUserFacing=!0,o.details=r.message,r.details&&(o.details+=` ${r.details}`),_(this,P,ze).call(this,[o])}else _(this,P,ze).call(this,[r])});let t=null;this.on("upload-stalled",(n,r)=>{const{message:a}=n,o=r.map(l=>l.meta.name).join(", ");t||(this.info({message:a,details:o},"warning",this.opts.infoTimeout),t=setTimeout(()=>{t=null},this.opts.infoTimeout)),this.log(`${a} ${o}`.trim(),"warning")}),this.on("upload",()=>{this.setState({error:null})});const s=n=>{const r=n.filter(o=>{const l=o!=null&&this.getFile(o.id);return l||this.log(`Not setting progress for a file that has been removed: ${o==null?void 0:o.id}`),l}),a=Object.fromEntries(r.map(o=>[o.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,bytesUploaded:0,bytesTotal:o.size}}]));this.patchFilesState(a)};this.on("upload-start",s),this.on("upload-progress",p(this,qs)),this.on("upload-success",(n,r)=>{if(n==null||!this.getFile(n.id)){this.log(`Not setting progress for a file that has been removed: ${n==null?void 0:n.id}`);return}const a=this.getFile(n.id).progress;this.setFileState(n.id,{progress:{...a,postprocess:p(this,We).size>0?{mode:"indeterminate"}:void 0,uploadComplete:!0,percentage:100,bytesUploaded:a.bytesTotal},response:r,uploadURL:r.uploadURL,isPaused:!1}),n.size==null&&this.setFileState(n.id,{size:r.bytesUploaded||a.bytesTotal}),p(this,Ge).call(this)}),this.on("preprocess-progress",(n,r)=>{if(n==null||!this.getFile(n.id)){this.log(`Not setting progress for a file that has been removed: ${n==null?void 0:n.id}`);return}this.setFileState(n.id,{progress:{...this.getFile(n.id).progress,preprocess:r}})}),this.on("preprocess-complete",n=>{if(n==null||!this.getFile(n.id)){this.log(`Not setting progress for a file that has been removed: ${n==null?void 0:n.id}`);return}const r={...this.getState().files};r[n.id]={...r[n.id],progress:{...r[n.id].progress}},delete r[n.id].progress.preprocess,this.setState({files:r})}),this.on("postprocess-progress",(n,r)=>{if(n==null||!this.getFile(n.id)){this.log(`Not setting progress for a file that has been removed: ${n==null?void 0:n.id}`);return}this.setFileState(n.id,{progress:{...this.getState().files[n.id].progress,postprocess:r}})}),this.on("postprocess-complete",n=>{if(n==null||!this.getFile(n.id)){this.log(`Not setting progress for a file that has been removed: ${n==null?void 0:n.id}`);return}const r={...this.getState().files};r[n.id]={...r[n.id],progress:{...r[n.id].progress}},delete r[n.id].progress.postprocess,this.setState({files:r})}),this.on("restored",()=>{p(this,Ge).call(this)}),this.on("dashboard:file-edit-complete",n=>{n&&_(this,P,Di).call(this,n)}),typeof window<"u"&&window.addEventListener&&(window.addEventListener("online",p(this,Me)),window.addEventListener("offline",p(this,Me)),setTimeout(p(this,Me),3e3))},Me=new WeakMap,Kt=new WeakMap,At=function(e,t={}){const{forceAllowNewUpload:s=!1}=t,{allowNewUpload:n,currentUploads:r}=this.getState();if(!n&&!s)throw new Error("Cannot create a new upload: already uploading.");const a=pn();return this.emit("upload",a,this.getFilesByIds(e)),this.setState({allowNewUpload:this.opts.allowMultipleUploadBatches!==!1&&this.opts.allowMultipleUploads!==!1,currentUploads:{...r,[a]:{fileIDs:e,step:0,result:{}}}}),a},ya=function(e){const{currentUploads:t}=this.getState();return t[e]},Ds=function(e){const t={...this.getState().currentUploads};delete t[e],this.setState({currentUploads:t})},Ot=async function(e){const t=()=>{const{currentUploads:a}=this.getState();return a[e]};let s=t();const n=[...p(this,lt),...p(this,dt),...p(this,We)];try{for(let a=s.step||0;a<n.length&&s;a++){const o=n[a];this.setState({currentUploads:{...this.getState().currentUploads,[e]:{...s,step:a}}});const{fileIDs:l}=s;await o(l,e),s=t()}}catch(a){throw _(this,P,Ds).call(this,e),a}if(s){s.fileIDs.forEach(h=>{const c=this.getFile(h);c!=null&&c.progress.postprocess&&this.emit("postprocess-complete",c)});const a=s.fileIDs.map(h=>this.getFile(h)),o=a.filter(h=>!h.error),l=a.filter(h=>h.error);this.addResultData(e,{successful:o,failed:l,uploadID:e}),s=t()}let r;return s&&(r=s.result,_(this,P,Ds).call(this,e)),r==null&&(this.log(`Not setting result for an upload that has been removed: ${e}`),r={successful:[],failed:[],uploadID:e}),r},m(Vs,"VERSION",Tl.version);let Ii=Vs;var jl=0;function d(i,e,t,s,n,r){e||(e={});var a,o,l=e;"ref"in e&&(a=e.ref,delete e.ref);var h={type:i,props:l,key:t,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--jl,__i:-1,__u:0,__source:n,__self:r};if(typeof i=="function"&&(a=i.defaultProps))for(o in a)l[o]===void 0&&(l[o]=a[o]);return N.vnode&&N.vnode(h),h}const $l="4.3.2",zl={version:$l},nr=300;class Hl extends ee{constructor(){super(...arguments);m(this,"ref",Yo())}componentWillEnter(t){this.ref.current.style.opacity="1",this.ref.current.style.transform="none",setTimeout(t,nr)}componentWillLeave(t){this.ref.current.style.opacity="0",this.ref.current.style.transform="translateY(350%)",setTimeout(t,nr)}render(){const{children:t}=this.props;return d("div",{className:"uppy-Informer-animated",ref:this.ref,children:t})}}function ql(i,e){return Object.assign(i,e)}function Vl(i,e){return(i==null?void 0:i.key)??e}function Wl(i,e){const t=i._ptgLinkedRefs||(i._ptgLinkedRefs={});return t[e]||(t[e]=s=>{i.refs[e]=s})}function Et(i){const e={};for(let t=0;t<i.length;t++)if(i[t]!=null){const s=Vl(i[t],t.toString(36));e[s]=i[t]}return e}function Gl(i,e){i=i||{},e=e||{};const t=a=>Object.hasOwn(e,a)?e[a]:i[a],s={};let n=[];for(const a in i)Object.hasOwn(e,a)?n.length&&(s[a]=n,n=[]):n.push(a);const r={};for(const a in e){if(Object.hasOwn(s,a))for(let o=0;o<s[a].length;o++){const l=s[a][o];r[s[a][o]]=t(l)}r[a]=t(a)}for(let a=0;a<n.length;a++)r[n[a]]=t(n[a]);return r}const Kl=i=>i;class ba extends ee{constructor(e,t){super(e,t),this.refs={},this.state={children:Et(ce(ce(this.props.children))||[])},this.performAppear=this.performAppear.bind(this),this.performEnter=this.performEnter.bind(this),this.performLeave=this.performLeave.bind(this)}componentWillMount(){this.currentlyTransitioningKeys={},this.keysToAbortLeave=[],this.keysToEnter=[],this.keysToLeave=[]}componentDidMount(){const e=this.state.children;for(const t in e)e[t]&&this.performAppear(t)}componentWillReceiveProps(e){const t=Et(ce(e.children)||[]),s=this.state.children;this.setState(r=>({children:Gl(r.children,t)}));let n;for(n in t)if(Object.hasOwn(t,n)){const r=s&&Object.hasOwn(s,n);t[n]&&r&&this.currentlyTransitioningKeys[n]?(this.keysToEnter.push(n),this.keysToAbortLeave.push(n)):t[n]&&!r&&!this.currentlyTransitioningKeys[n]&&this.keysToEnter.push(n)}for(n in s)if(Object.hasOwn(s,n)){const r=t&&Object.hasOwn(t,n);s[n]&&!r&&!this.currentlyTransitioningKeys[n]&&this.keysToLeave.push(n)}}componentDidUpdate(){const{keysToEnter:e}=this;this.keysToEnter=[],e.forEach(this.performEnter);const{keysToLeave:t}=this;this.keysToLeave=[],t.forEach(this.performLeave)}_finishAbort(e){const t=this.keysToAbortLeave.indexOf(e);t!==-1&&this.keysToAbortLeave.splice(t,1)}performAppear(e){this.currentlyTransitioningKeys[e]=!0;const t=this.refs[e];t!=null&&t.componentWillAppear?t.componentWillAppear(this._handleDoneAppearing.bind(this,e)):this._handleDoneAppearing(e)}_handleDoneAppearing(e){const t=this.refs[e];t!=null&&t.componentDidAppear&&t.componentDidAppear(),delete this.currentlyTransitioningKeys[e],this._finishAbort(e);const s=Et(ce(this.props.children)||[]);(!s||!Object.hasOwn(s,e))&&this.performLeave(e)}performEnter(e){this.currentlyTransitioningKeys[e]=!0;const t=this.refs[e];t!=null&&t.componentWillEnter?t.componentWillEnter(this._handleDoneEntering.bind(this,e)):this._handleDoneEntering(e)}_handleDoneEntering(e){const t=this.refs[e];t!=null&&t.componentDidEnter&&t.componentDidEnter(),delete this.currentlyTransitioningKeys[e],this._finishAbort(e);const s=Et(ce(this.props.children)||[]);(!s||!Object.hasOwn(s,e))&&this.performLeave(e)}performLeave(e){if(this.keysToAbortLeave.indexOf(e)!==-1)return;this.currentlyTransitioningKeys[e]=!0;const s=this.refs[e];s!=null&&s.componentWillLeave?s.componentWillLeave(this._handleDoneLeaving.bind(this,e)):this._handleDoneLeaving(e)}_handleDoneLeaving(e){if(this.keysToAbortLeave.indexOf(e)!==-1)return;const s=this.refs[e];s!=null&&s.componentDidLeave&&s.componentDidLeave(),delete this.currentlyTransitioningKeys[e];const n=Et(ce(this.props.children)||[]);if(n&&Object.hasOwn(n,e))this.performEnter(e);else{const r=ql({},this.state.children);delete r[e],this.setState({children:r})}}render({childFactory:e,transitionLeave:t,transitionName:s,transitionAppear:n,transitionEnter:r,transitionLeaveTimeout:a,transitionEnterTimeout:o,transitionAppearTimeout:l,component:h,...c},{children:u}){const y=Object.entries(u).map(([g,w])=>{if(!w)return;const x=Wl(this,g);return ta(e(w),{ref:x,key:g})}).filter(Boolean);return jt(h,c,y)}}ba.defaultProps={component:"span",childFactory:Kl};class va extends Tt{constructor(t,s){super(t,s);m(this,"render",t=>d("div",{className:"uppy uppy-Informer",children:d(ba,{children:t.info.map(s=>d(Hl,{children:d("p",{role:"alert",children:[s.message," ",s.details&&d("span",{"aria-label":s.details,"data-microtip-position":"top-left","data-microtip-size":"medium",role:"tooltip",onClick:()=>alert(`${s.message} 

 ${s.details}`),children:"?"})]})},s.message))})}));this.type="progressindicator",this.id=this.opts.id||"Informer",this.title="Informer"}install(){const{target:t}=this.opts;t&&this.mount(t,this)}}m(va,"VERSION",zl.version);var wa={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(i){(function(){var e={}.hasOwnProperty;function t(){for(var r="",a=0;a<arguments.length;a++){var o=arguments[a];o&&(r=n(r,s(o)))}return r}function s(r){if(typeof r=="string"||typeof r=="number")return r;if(typeof r!="object")return"";if(Array.isArray(r))return t.apply(null,r);if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]"))return r.toString();var a="";for(var o in r)e.call(r,o)&&r[o]&&(a=n(a,o));return a}function n(r,a){return a?r?r+" "+a:r+a:r}i.exports?(t.default=t,i.exports=t):window.classNames=t})()})(wa);var Xl=wa.exports;const fe=cs(Xl),Yl={position:"relative",width:"100%",minHeight:"100%"},Jl={position:"absolute",top:0,left:0,width:"100%",overflow:"visible"};class Ql extends ee{constructor(t){super(t);m(this,"handleScroll",()=>{this.setState({offset:this.base.scrollTop})});m(this,"handleResize",()=>{this.resize()});this.focusElement=null,this.state={offset:0,height:0}}componentDidMount(){this.resize(),window.addEventListener("resize",this.handleResize)}componentWillUpdate(){this.base.contains(document.activeElement)&&(this.focusElement=document.activeElement)}componentDidUpdate(){var t;(t=this.focusElement)!=null&&t.parentNode&&document.activeElement!==this.focusElement&&this.focusElement.focus(),this.focusElement=null,this.resize()}componentWillUnmount(){window.removeEventListener("resize",this.handleResize)}resize(){const{height:t}=this.state;t!==this.base.offsetHeight&&this.setState({height:this.base.offsetHeight})}render({data:t,rowHeight:s,renderRow:n,overscanCount:r=10,...a}){const{offset:o,height:l}=this.state;let h=Math.floor(o/s),c=Math.floor(l/s);r&&(h=Math.max(0,h-h%r),c+=r);const u=h+c+4,y=t.slice(h,u),g={...Yl,height:t.length*s},w={...Jl,top:h*s};return d("div",{onScroll:this.handleScroll,...a,children:d("div",{role:"presentation",style:g,children:d("div",{role:"presentation",style:w,children:y.map(n)})})})}}function Zl(){return d("svg",{"aria-hidden":"true",focusable:"false",width:"30",height:"30",viewBox:"0 0 30 30",children:d("path",{d:"M15 30c8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15C6.716 0 0 6.716 0 15c0 8.284 6.716 15 15 15zm4.258-12.676v6.846h-8.426v-6.846H5.204l9.82-12.364 9.82 12.364H19.26z"})})}function rr(i,e,t,s){return i===e?i:s===0?e:i+(e-i)*2**(-s/t)}const ed="4.2.3",td={version:ed},sd={strings:{uploading:"Uploading",complete:"Complete",uploadFailed:"Upload failed",paused:"Paused",retry:"Retry",cancel:"Cancel",pause:"Pause",resume:"Resume",done:"Done",filesUploadedOfTotal:{0:"%{complete} of %{smart_count} file uploaded",1:"%{complete} of %{smart_count} files uploaded"},dataUploadedOfTotal:"%{complete} of %{total}",dataUploadedOfUnknown:"%{complete} of unknown",xTimeLeft:"%{time} left",uploadXFiles:{0:"Upload %{smart_count} file",1:"Upload %{smart_count} files"},uploadXNewFiles:{0:"Upload +%{smart_count} file",1:"Upload +%{smart_count} files"},upload:"Upload",retryUpload:"Retry upload",xMoreFilesAdded:{0:"%{smart_count} more file added",1:"%{smart_count} more files added"},showErrorDetails:"Show error details"}},ve={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete"};function id(i){const e=Math.floor(i/3600)%24,t=Math.floor(i/60)%60,s=Math.floor(i%60);return{hours:e,minutes:t,seconds:s}}function nd(i){const e=id(i),t=e.hours===0?"":`${e.hours}h`,s=e.minutes===0?"":`${e.hours===0?e.minutes:` ${e.minutes.toString(10).padStart(2,"0")}`}m`,n=e.hours!==0?"":`${e.minutes===0?e.seconds:` ${e.seconds.toString(10).padStart(2,"0")}`}s`;return`${t}${s}${n}`}const rd="Â·",ar=()=>` ${rd} `;function ad(i){const{newFiles:e,isUploadStarted:t,recoveredState:s,i18n:n,uploadState:r,isSomeGhost:a,startUpload:o}=i,l=fe("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--upload",{"uppy-c-btn-primary":r===ve.STATE_WAITING},{"uppy-StatusBar-actionBtn--disabled":a}),h=e&&t&&!s?n("uploadXNewFiles",{smart_count:e}):n("uploadXFiles",{smart_count:e});return d("button",{type:"button",className:l,"aria-label":n("uploadXFiles",{smart_count:e}),onClick:o,disabled:a,"data-uppy-super-focusable":!0,children:h})}function od(i){const{i18n:e,uppy:t}=i;return d("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--retry","aria-label":e("retryUpload"),onClick:()=>t.retryAll().catch(()=>{}),"data-uppy-super-focusable":!0,"data-cy":"retry",children:[d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"8",height:"10",viewBox:"0 0 8 10",children:d("path",{d:"M4 2.408a2.75 2.75 0 1 0 2.75 2.75.626.626 0 0 1 1.25.018v.023a4 4 0 1 1-4-4.041V.25a.25.25 0 0 1 .389-.208l2.299 1.533a.25.25 0 0 1 0 .416l-2.3 1.533A.25.25 0 0 1 4 3.316v-.908z"})}),e("retry")]})}function ld(i){const{i18n:e,uppy:t}=i;return d("button",{type:"button",className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",title:e("cancel"),"aria-label":e("cancel"),onClick:()=>t.cancelAll(),"data-cy":"cancel","data-uppy-super-focusable":!0,children:d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16",children:d("g",{fill:"none",fillRule:"evenodd",children:[d("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),d("path",{fill:"#FFF",d:"M9.283 8l2.567 2.567-1.283 1.283L8 9.283 5.433 11.85 4.15 10.567 6.717 8 4.15 5.433 5.433 4.15 8 6.717l2.567-2.567 1.283 1.283z"})]})})})}function dd(i){const{isAllPaused:e,i18n:t,isAllComplete:s,resumableUploads:n,uppy:r}=i,a=t(e?"resume":"pause");function o(){if(!s){if(!n){r.cancelAll();return}if(e){r.resumeAll();return}r.pauseAll()}}return d("button",{title:a,"aria-label":a,className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",type:"button",onClick:o,"data-cy":"togglePauseResume","data-uppy-super-focusable":!0,children:d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16",children:d("g",{fill:"none",fillRule:"evenodd",children:[d("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),d("path",{fill:"#FFF",d:e?"M6 4.25L11.5 8 6 11.75z":"M5 4.5h2v7H5v-7zm4 0h2v7H9v-7z"})]})})})}function ud(i){const{i18n:e,doneButtonHandler:t}=i;return d("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--done",onClick:t,"data-uppy-super-focusable":!0,children:e("done")})}function _a(){return d("svg",{className:"uppy-StatusBar-spinner","aria-hidden":"true",focusable:"false",width:"14",height:"14",children:d("path",{d:"M13.983 6.547c-.12-2.509-1.64-4.893-3.939-5.936-2.48-1.127-5.488-.656-7.556 1.094C.524 3.367-.398 6.048.162 8.562c.556 2.495 2.46 4.52 4.94 5.183 2.932.784 5.61-.602 7.256-3.015-1.493 1.993-3.745 3.309-6.298 2.868-2.514-.434-4.578-2.349-5.153-4.84a6.226 6.226 0 0 1 2.98-6.778C6.34.586 9.74 1.1 11.373 3.493c.407.596.693 1.282.842 1.988.127.598.073 1.197.161 1.794.078.525.543 1.257 1.15.864.525-.341.49-1.05.456-1.592-.007-.15.02.3 0 0",fillRule:"evenodd"})})}function cd(i){const{progress:e}=i,{value:t,mode:s,message:n}=e;return d("div",{className:"uppy-StatusBar-content",children:[d(_a,{}),s==="determinate"?`${Math.round(t*100)}% Â· `:"",n]})}function hd(i){const{numUploads:e,complete:t,totalUploadedSize:s,totalSize:n,totalETA:r,i18n:a}=i,o=e>1,l=qe(s);return d("div",{className:"uppy-StatusBar-statusSecondary",children:[o&&a("filesUploadedOfTotal",{complete:t,smart_count:e}),d("span",{className:"uppy-StatusBar-additionalInfo",children:[o&&ar(),n!=null?a("dataUploadedOfTotal",{complete:l,total:qe(n)}):a("dataUploadedOfUnknown",{complete:l}),ar(),r!=null&&a("xTimeLeft",{time:nd(r)})]})]})}function Sa(i){const{i18n:e,complete:t,numUploads:s}=i;return d("div",{className:"uppy-StatusBar-statusSecondary",children:e("filesUploadedOfTotal",{complete:t,smart_count:s})})}function pd(i){const{i18n:e,newFiles:t,startUpload:s}=i,n=fe("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--uploadNewlyAdded");return d("div",{className:"uppy-StatusBar-statusSecondary",children:[d("div",{className:"uppy-StatusBar-statusSecondaryHint",children:e("xMoreFilesAdded",{smart_count:t})}),d("button",{type:"button",className:n,"aria-label":e("uploadXFiles",{smart_count:t}),onClick:s,children:e("upload")})]})}function fd(i){const{i18n:e,supportsUploadProgress:t,totalProgress:s,showProgressDetails:n,isUploadStarted:r,isAllComplete:a,isAllPaused:o,newFiles:l,numUploads:h,complete:c,totalUploadedSize:u,totalSize:y,totalETA:g,startUpload:w}=i,x=l&&r;if(!r||a)return null;const S=e(o?"paused":"uploading");function C(){return!o&&!x&&n?t?d(hd,{numUploads:h,complete:c,totalUploadedSize:u,totalSize:y,totalETA:g,i18n:e}):d(Sa,{i18n:e,complete:c,numUploads:h}):null}return d("div",{className:"uppy-StatusBar-content",title:S,children:[o?null:d(_a,{}),d("div",{className:"uppy-StatusBar-status",children:[d("div",{className:"uppy-StatusBar-statusPrimary",children:t&&s!==0?`${S}: ${s}%`:S}),C(),x?d(pd,{i18n:e,newFiles:l,startUpload:w}):null]})]})}function md(i){const{i18n:e}=i;return d("div",{className:"uppy-StatusBar-content",role:"status",title:e("complete"),children:d("div",{className:"uppy-StatusBar-status",children:d("div",{className:"uppy-StatusBar-statusPrimary",children:[d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"15",height:"11",viewBox:"0 0 15 11",children:d("path",{d:"M.414 5.843L1.627 4.63l3.472 3.472L13.202 0l1.212 1.213L5.1 10.528z"})}),e("complete")]})})})}function gd(i){const{error:e,i18n:t,complete:s,numUploads:n}=i;function r(){const a=`${t("uploadFailed")} 

 ${e}`;alert(a)}return d("div",{className:"uppy-StatusBar-content",title:t("uploadFailed"),children:[d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"11",height:"11",viewBox:"0 0 11 11",children:d("path",{d:"M4.278 5.5L0 1.222 1.222 0 5.5 4.278 9.778 0 11 1.222 6.722 5.5 11 9.778 9.778 11 5.5 6.722 1.222 11 0 9.778z"})}),d("div",{className:"uppy-StatusBar-status",children:[d("div",{className:"uppy-StatusBar-statusPrimary",children:[t("uploadFailed"),d("button",{className:"uppy-u-reset uppy-StatusBar-details","aria-label":t("showErrorDetails"),"data-microtip-position":"top-right","data-microtip-size":"medium",onClick:r,type:"button",children:"?"})]}),d(Sa,{i18n:t,complete:s,numUploads:n})]})]})}function mi(i){const e=[];let t="indeterminate",s;for(const{progress:r}of Object.values(i)){const{preprocess:a,postprocess:o}=r;s==null&&(a||o)&&({mode:t,message:s}=a||o),(a==null?void 0:a.mode)==="determinate"&&e.push(a.value),(o==null?void 0:o.mode)==="determinate"&&e.push(o.value)}const n=e.reduce((r,a)=>r+a/e.length,0);return{mode:t,message:s,value:n}}const{STATE_ERROR:or,STATE_WAITING:yd,STATE_PREPROCESSING:gi,STATE_UPLOADING:xs,STATE_POSTPROCESSING:yi,STATE_COMPLETE:Ps}=ve;function bd({newFiles:i,allowNewUpload:e,isUploadInProgress:t,isAllPaused:s,resumableUploads:n,error:r,hideUploadButton:a=void 0,hidePauseResumeButton:o=!1,hideCancelButton:l=!1,hideRetryButton:h=!1,recoveredState:c,uploadState:u,totalProgress:y,files:g,supportsUploadProgress:w,hideAfterFinish:x=!1,isSomeGhost:S,doneButtonHandler:C=void 0,isUploadStarted:T,i18n:A,startUpload:U,uppy:R,isAllComplete:O,showProgressDetails:k=void 0,numUploads:D,complete:H,totalSize:L,totalETA:b,totalUploadedSize:E}){function B(){switch(u){case yi:case gi:{const fs=mi(g);return fs.mode==="determinate"?fs.value*100:y}case or:return null;case xs:return w?y:null;default:return y}}function I(){switch(u){case yi:case gi:{const{mode:fs}=mi(g);return fs==="indeterminate"}case xs:return!w;default:return!1}}const K=B(),J=K??100,Le=!r&&i&&(!t&&!s||c)&&e&&!a,Ce=!l&&u!==yd&&u!==Ps,je=n&&!o&&u===xs,Sn=r&&!O&&!h,Fn=C&&u===Ps,oo=fe("uppy-StatusBar-progress",{"is-indeterminate":I()}),lo=fe("uppy-StatusBar",`is-${u}`,{"has-ghosts":S}),Cn=(()=>{switch(u){case gi:case yi:return d(cd,{progress:mi(g)});case Ps:return d(md,{i18n:A});case or:return d(gd,{error:r,i18n:A,numUploads:D,complete:H});case xs:return d(fd,{i18n:A,supportsUploadProgress:w,totalProgress:y,showProgressDetails:k,isUploadStarted:T,isAllComplete:O,isAllPaused:s,newFiles:i,numUploads:D,complete:H,totalUploadedSize:E,totalSize:L,totalETA:b,startUpload:U});default:return null}})();return!(Le||Sn||je||Ce||Fn)&&!Cn||u===Ps&&x?null:d("div",{className:lo,children:[d("div",{className:oo,style:{width:`${J}%`},role:"progressbar","aria-label":`${J}%`,"aria-valuetext":`${J}%`,"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":K}),Cn,d("div",{className:"uppy-StatusBar-actions",children:[Le?d(ad,{newFiles:i,isUploadStarted:T,recoveredState:c,i18n:A,isSomeGhost:S,startUpload:U,uploadState:u}):null,Sn?d(od,{i18n:A,uppy:R}):null,je?d(dd,{isAllPaused:s,i18n:A,isAllComplete:O,resumableUploads:n,uppy:R}):null,Ce?d(ld,{i18n:A,uppy:R}):null,Fn?d(ud,{i18n:A,doneButtonHandler:C}):null]})]})}const vd=2e3,wd=2e3;function _d(i,e,t,s){if(i)return ve.STATE_ERROR;if(e)return ve.STATE_COMPLETE;if(t)return ve.STATE_WAITING;let n=ve.STATE_WAITING;const r=Object.keys(s);for(let a=0;a<r.length;a++){const{progress:o}=s[r[a]];if(o.uploadStarted&&!o.uploadComplete)return ve.STATE_UPLOADING;o.preprocess&&(n=ve.STATE_PREPROCESSING),o.postprocess&&n!==ve.STATE_PREPROCESSING&&(n=ve.STATE_POSTPROCESSING)}return n}const Sd={hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideCancelButton:!1,showProgressDetails:!1,hideAfterFinish:!0,doneButtonHandler:null};var ki,Re,Ie,Ke,Pe,Ws,Fa,Xt;let Fd=(ki=class extends Tt{constructor(t,s){super(t,{...Sd,...s});v(this,Ws);v(this,Re);v(this,Ie);v(this,Ke);v(this,Pe);m(this,"startUpload",()=>this.uppy.upload().catch(()=>{}));v(this,Xt,()=>{const{recoveredState:t}=this.uppy.getState();if(F(this,Ke,null),F(this,Pe,null),t){F(this,Ie,Object.values(t.files).reduce((s,{progress:n})=>s+n.bytesUploaded,0)),this.uppy.emit("restore-confirmed");return}F(this,Re,performance.now()),F(this,Ie,0)});this.id=this.opts.id||"StatusBar",this.title="StatusBar",this.type="progressindicator",this.defaultLocale=sd,this.i18nInit(),this.render=this.render.bind(this),this.install=this.install.bind(this)}render(t){const{capabilities:s,files:n,allowNewUpload:r,totalProgress:a,error:o,recoveredState:l}=t,{newFiles:h,startedFiles:c,completeFiles:u,isUploadStarted:y,isAllComplete:g,isAllPaused:w,isUploadInProgress:x,isSomeGhost:S}=this.uppy.getObjectOfFilesPerState(),C=l?Object.values(n):h,T=!!s.resumableUploads,A=s.uploadProgress!==!1;let U=null,R=0;c.every(k=>k.progress.bytesTotal!=null&&k.progress.bytesTotal!==0)?(U=0,c.forEach(k=>{U+=k.progress.bytesTotal||0,R+=k.progress.bytesUploaded||0})):c.forEach(k=>{R+=k.progress.bytesUploaded||0});const O=_(this,Ws,Fa).call(this,{uploaded:R,total:U});return bd({error:o,uploadState:_d(o,g,l,t.files||{}),allowNewUpload:r,totalProgress:a,totalSize:U,totalUploadedSize:R,isAllComplete:!1,isAllPaused:w,isUploadStarted:y,isUploadInProgress:x,isSomeGhost:S,recoveredState:l,complete:u.length,newFiles:C.length,numUploads:c.length,totalETA:O,files:n,i18n:this.i18n,uppy:this.uppy,startUpload:this.startUpload,doneButtonHandler:this.opts.doneButtonHandler,resumableUploads:T,supportsUploadProgress:A,showProgressDetails:this.opts.showProgressDetails,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,hideAfterFinish:this.opts.hideAfterFinish})}onMount(){const t=this.el;Vr(t)||(t.dir="ltr")}install(){const{target:t}=this.opts;t&&this.mount(t,this),this.uppy.on("upload",p(this,Xt)),F(this,Re,performance.now()),F(this,Ie,this.uppy.getFiles().reduce((s,n)=>s+n.progress.bytesUploaded,0))}uninstall(){this.unmount(),this.uppy.off("upload",p(this,Xt))}},Re=new WeakMap,Ie=new WeakMap,Ke=new WeakMap,Pe=new WeakMap,Ws=new WeakSet,Fa=function(t){if(t.total==null||t.total===0)return null;const s=t.total-t.uploaded;if(s<=0)return null;p(this,Re)??F(this,Re,performance.now());const n=performance.now()-p(this,Re);if(n===0)return Math.round((p(this,Pe)??0)/100)/10;const r=t.uploaded-p(this,Ie);if(F(this,Ie,t.uploaded),r<=0)return Math.round((p(this,Pe)??0)/100)/10;const a=r/n,o=p(this,Ke)==null?a:rr(a,p(this,Ke),vd,n);F(this,Ke,o);const l=s/o,h=Math.max(p(this,Pe)-n,0),c=p(this,Pe)==null?l:rr(l,h,wd,n);return F(this,Pe,c),F(this,Re,performance.now()),Math.round(c/100)/10},Xt=new WeakMap,m(ki,"VERSION",td.version),ki);const Cd=/^data:([^/]+\/[^,;]+(?:[^,]*?))(;base64)?,([\s\S]*)$/;function xd(i,e,t){const s=Cd.exec(i),n=e.mimeType??(s==null?void 0:s[1])??"plain/text";let r;if((s==null?void 0:s[2])!=null){const a=atob(decodeURIComponent(s[3])),o=new Uint8Array(a.length);for(let l=0;l<a.length;l++)o[l]=a.charCodeAt(l);r=[o]}else(s==null?void 0:s[3])!=null&&(r=[decodeURIComponent(s[3])]);return new Blob(r,{type:n})}function lr(i){return i.startsWith("blob:")}function dr(i){return i?/^[^/]+\/(jpe?g|gif|png|svg|svg\+xml|bmp|webp|avif)$/.test(i):!1}function M(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}var Ca=typeof self<"u"?self:global;const Ht=typeof navigator<"u",Pd=Ht&&typeof HTMLImageElement>"u",ur=!(typeof global>"u"||typeof process>"u"||!process.versions||!process.versions.node),xa=Ca.Buffer,Pa=!!xa,kd=i=>i!==void 0;function ka(i){return i===void 0||(i instanceof Map?i.size===0:Object.values(i).filter(kd).length===0)}function W(i){let e=new Error(i);throw delete e.stack,e}function cr(i){let e=function(t){let s=0;return t.ifd0.enabled&&(s+=1024),t.exif.enabled&&(s+=2048),t.makerNote&&(s+=2048),t.userComment&&(s+=1024),t.gps.enabled&&(s+=512),t.interop.enabled&&(s+=100),t.ifd1.enabled&&(s+=1024),s+2048}(i);return i.jfif.enabled&&(e+=50),i.xmp.enabled&&(e+=2e4),i.iptc.enabled&&(e+=14e3),i.icc.enabled&&(e+=6e3),e}const bi=i=>String.fromCharCode.apply(null,i),hr=typeof TextDecoder<"u"?new TextDecoder("utf-8"):void 0;class he{static from(e,t){return e instanceof this&&e.le===t?e:new he(e,void 0,void 0,t)}constructor(e,t=0,s,n){if(typeof n=="boolean"&&(this.le=n),Array.isArray(e)&&(e=new Uint8Array(e)),e===0)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){s===void 0&&(s=e.byteLength-t);let r=new DataView(e,t,s);this._swapDataView(r)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof he){s===void 0&&(s=e.byteLength-t),(t+=e.byteOffset)+s>e.byteOffset+e.byteLength&&W("Creating view outside of available memory in ArrayBuffer");let r=new DataView(e.buffer,t,s);this._swapDataView(r)}else if(typeof e=="number"){let r=new DataView(new ArrayBuffer(e));this._swapDataView(r)}else W("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,s=he){return e instanceof DataView||e instanceof he?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||W("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new s(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new he(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return n=this.getUint8Array(e,t),hr?hr.decode(n):Pa?Buffer.from(n).toString("utf8"):decodeURIComponent(escape(bi(n)));var n}getLatin1String(e=0,t=this.byteLength){let s=this.getUint8Array(e,t);return bi(s)}getUnicodeString(e=0,t=this.byteLength){const s=[];for(let n=0;n<t&&e+n<this.byteLength;n+=2)s.push(this.getUint16(e+n));return bi(s)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,s){switch(t){case 1:return this.getUint8(e,s);case 2:return this.getUint16(e,s);case 4:return this.getUint32(e,s);case 8:return this.getUint64&&this.getUint64(e,s)}}getUint(e,t,s){switch(t){case 8:return this.getUint8(e,s);case 16:return this.getUint16(e,s);case 32:return this.getUint32(e,s);case 64:return this.getUint64&&this.getUint64(e,s)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}}function qi(i,e){W(`${i} '${e}' was not loaded, try using full build of exifr.`)}class fn extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||qi(this.kind,e),t&&(e in t||function(s,n){W(`Unknown ${s} '${n}'.`)}(this.kind,e),t[e].enabled||qi(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var Ta=new fn("file parser"),ue=new fn("segment parser"),mn=new fn("file reader");let Td=Ca.fetch;function pr(i,e){return(t=i).startsWith("data:")||t.length>1e4?Wi(i,e,"base64"):ur&&i.includes("://")?Vi(i,e,"url",fr):ur?Wi(i,e,"fs"):Ht?Vi(i,e,"url",fr):void W("Invalid input argument");var t}async function Vi(i,e,t,s){return mn.has(t)?Wi(i,e,t):s?async function(n,r){let a=await r(n);return new he(a)}(i,s):void W(`Parser ${t} is not loaded`)}async function Wi(i,e,t){let s=new(mn.get(t))(i,e);return await s.read(),s}const fr=i=>Td(i).then(e=>e.arrayBuffer()),Gi=i=>new Promise((e,t)=>{let s=new FileReader;s.onloadend=()=>e(s.result||new ArrayBuffer),s.onerror=t,s.readAsArrayBuffer(i)}),gn=new Map,Ed=new Map,Nd=new Map,ks=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],Ea=["jfif","xmp","icc","iptc","ihdr"],Ki=["tiff",...Ea],V=["ifd0","ifd1","exif","gps","interop"],Ts=[...Ki,...V],Es=["makerNote","userComment"],Na=["translateKeys","translateValues","reviveValues","multiSegment"],Ns=[...Na,"sanitize","mergeOutput","silentErrors"];class Ua{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class Nt extends Ua{get needed(){return this.enabled||this.deps.size>0}constructor(e,t,s,n){if(super(),M(this,"enabled",!1),M(this,"skip",new Set),M(this,"pick",new Set),M(this,"deps",new Set),M(this,"translateKeys",!1),M(this,"translateValues",!1),M(this,"reviveValues",!1),this.key=e,this.enabled=t,this.parse=this.enabled,this.applyInheritables(n),this.canBeFiltered=V.includes(e),this.canBeFiltered&&(this.dict=gn.get(e)),s!==void 0)if(Array.isArray(s))this.parse=this.enabled=!0,this.canBeFiltered&&s.length>0&&this.translateTagSet(s,this.pick);else if(typeof s=="object"){if(this.enabled=!0,this.parse=s.parse!==!1,this.canBeFiltered){let{pick:r,skip:a}=s;r&&r.length>0&&this.translateTagSet(r,this.pick),a&&a.length>0&&this.translateTagSet(a,this.skip)}this.applyInheritables(s)}else s===!0||s===!1?this.parse=this.enabled=s:W(`Invalid options argument: ${s}`)}applyInheritables(e){let t,s;for(t of Na)s=e[t],s!==void 0&&(this[t]=s)}translateTagSet(e,t){if(this.dict){let s,n,{tagKeys:r,tagValues:a}=this.dict;for(s of e)typeof s=="string"?(n=a.indexOf(s),n===-1&&(n=r.indexOf(Number(s))),n!==-1&&t.add(Number(r[n]))):t.add(s)}else for(let s of e)t.add(s)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,$s(this.pick,this.deps)):this.enabled&&this.pick.size>0&&$s(this.pick,this.deps)}}var Q={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},mr=new Map;class yn extends Ua{static useCached(e){let t=mr.get(e);return t!==void 0||(t=new this(e),mr.set(e,t)),t}constructor(e){super(),e===!0?this.setupFromTrue():e===void 0?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):typeof e=="object"?this.setupFromObject(e):W(`Invalid options argument ${e}`),this.firstChunkSize===void 0&&(this.firstChunkSize=Ht?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of ks)this[e]=Q[e];for(e of Ns)this[e]=Q[e];for(e of Es)this[e]=Q[e];for(e of Ts)this[e]=new Nt(e,Q[e],void 0,this)}setupFromTrue(){let e;for(e of ks)this[e]=Q[e];for(e of Ns)this[e]=Q[e];for(e of Es)this[e]=!0;for(e of Ts)this[e]=new Nt(e,!0,void 0,this)}setupFromArray(e){let t;for(t of ks)this[t]=Q[t];for(t of Ns)this[t]=Q[t];for(t of Es)this[t]=Q[t];for(t of Ts)this[t]=new Nt(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,V)}setupFromObject(e){let t;for(t of(V.ifd0=V.ifd0||V.image,V.ifd1=V.ifd1||V.thumbnail,Object.assign(this,e),ks))this[t]=vi(e[t],Q[t]);for(t of Ns)this[t]=vi(e[t],Q[t]);for(t of Es)this[t]=vi(e[t],Q[t]);for(t of Ki)this[t]=new Nt(t,Q[t],e[t],this);for(t of V)this[t]=new Nt(t,Q[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,V,Ts),e.tiff===!0?this.batchEnableWithBool(V,!0):e.tiff===!1?this.batchEnableWithUserValue(V,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,V):typeof e.tiff=="object"&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,V)}batchEnableWithBool(e,t){for(let s of e)this[s].enabled=t}batchEnableWithUserValue(e,t){for(let s of e){let n=t[s];this[s].enabled=n!==!1&&n!==void 0}}setupGlobalFilters(e,t,s,n=s){if(e&&e.length){for(let a of n)this[a].enabled=!1;let r=gr(e,s);for(let[a,o]of r)$s(this[a].pick,o),this[a].enabled=!0}else if(t&&t.length){let r=gr(t,s);for(let[a,o]of r)$s(this[a].skip,o)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:s,iptc:n,icc:r}=this;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),s.enabled||e.skip.add(700),n.enabled||e.skip.add(33723),r.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:s,interop:n}=this;n.needed&&(t.deps.add(40965),e.deps.add(40965)),t.needed&&e.deps.add(34665),s.needed&&e.deps.add(34853),this.tiff.enabled=V.some(r=>this[r].enabled===!0)||this.makerNote||this.userComment;for(let r of V)this[r].finalizeFilters()}get onlyTiff(){return!Ea.map(e=>this[e].enabled).some(e=>e===!0)&&this.tiff.enabled}checkLoadedPlugins(){for(let e of Ki)this[e].enabled&&!ue.has(e)&&qi("segment parser",e)}}function gr(i,e){let t,s,n,r,a=[];for(n of e){for(r of(t=gn.get(n),s=[],t))(i.includes(r[0])||i.includes(r[1]))&&s.push(r[0]);s.length&&a.push([n,s])}return a}function vi(i,e){return i!==void 0?i:e!==void 0?e:void 0}function $s(i,e){for(let t of e)i.add(t)}M(yn,"default",Q);class Ud{constructor(e){M(this,"parsers",{}),M(this,"output",{}),M(this,"errors",[]),M(this,"pushToErrors",t=>this.errors.push(t)),this.options=yn.useCached(e)}async read(e){this.file=await function(t,s){return typeof t=="string"?pr(t,s):Ht&&!Pd&&t instanceof HTMLImageElement?pr(t.src,s):t instanceof Uint8Array||t instanceof ArrayBuffer||t instanceof DataView?new he(t):Ht&&t instanceof Blob?Vi(t,s,"blob",Gi):void W("Invalid input argument")}(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[s,n]of Ta)if(n.canHandle(e,t))return this.fileParser=new n(this.options,this.file,this.parsers),e[s]=!0;this.file.close&&this.file.close(),W("Unknown file format")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),ka(s=e)?void 0:s;var s}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map(async s=>{let n=await s.parse();s.assignToOutput(e,n)});this.options.silentErrors&&(t=t.map(s=>s.catch(this.pushToErrors))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,s=ue.get("tiff",e);var n;if(t.tiff?n={start:0,type:"tiff"}:t.jpeg&&(n=await this.fileParser.getOrFindSegment("tiff")),n===void 0)return;let r=await this.fileParser.ensureSegmentChunk(n),a=this.parsers.tiff=new s(r,e,t),o=await a.extractThumbnail();return t.close&&t.close(),o}}class at{static findPosition(e,t){let s=e.getUint16(t+2)+2,n=typeof this.headerLength=="function"?this.headerLength(e,t,s):this.headerLength,r=t+n,a=s-n;return{offset:t,length:s,headerLength:n,start:r,size:a,end:r+a}}static parse(e,t={}){return new this(e,new yn({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof he?e:new he(e)}constructor(e,t={},s){M(this,"errors",[]),M(this,"raw",new Map),M(this,"handleError",n=>{if(!this.options.silentErrors)throw n;this.errors.push(n.message)}),this.chunk=this.normalizeInput(e),this.file=s,this.type=this.constructor.type,this.globalOptions=this.options=t,this.localOptions=t[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let s=Nd.get(t),n=Ed.get(t),r=gn.get(t),a=this.options[t],o=a.reviveValues&&!!s,l=a.translateValues&&!!n,h=a.translateKeys&&!!r,c={};for(let[u,y]of e)o&&s.has(u)?y=s.get(u)(y):l&&n.has(u)&&(y=this.translateValue(y,n.get(u))),h&&r.has(u)&&(u=r.get(u)||u),c[u]=y;return c}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,s){if(this.globalOptions.mergeOutput)return Object.assign(e,s);e[t]?Object.assign(e[t],s):e[t]=s}}M(at,"headerLength",4),M(at,"type",void 0),M(at,"multiSegment",!1),M(at,"canHandle",()=>!1);function Ad(i){return i===192||i===194||i===196||i===219||i===221||i===218||i===254}function Od(i){return i>=224&&i<=239}function Md(i,e,t){for(let[s,n]of ue)if(n.canHandle(i,e,t))return s}class yr extends class{constructor(e,t,s){M(this,"errors",[]),M(this,"ensureSegmentChunk",async n=>{let r=n.start,a=n.size||65536;if(this.file.chunked)if(this.file.available(r,a))n.chunk=this.file.subarray(r,a);else try{n.chunk=await this.file.readChunk(r,a)}catch(o){W(`Couldn't read segment: ${JSON.stringify(n)}. ${o.message}`)}else this.file.byteLength>r+a?n.chunk=this.file.subarray(r,a):n.size===void 0?n.chunk=this.file.subarray(r):W("Segment unreachable: "+JSON.stringify(n));return n.chunk}),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=s}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let s=new(ue.get(e))(t,this.options,this.file);return this.parsers[e]=s}createParsers(e){for(let t of e){let{type:s,chunk:n}=t,r=this.options[s];if(r&&r.enabled){let a=this.parsers[s];a&&a.append||a||this.createParser(s,n)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}{constructor(...e){super(...e),M(this,"appSegments",[]),M(this,"jpegSegments",[]),M(this,"unknownSegments",[])}static canHandle(e,t){return t===65496}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){e===!0?(this.findAll=!0,this.wanted=new Set(ue.keyList())):(e=e===void 0?ue.keyList().filter(t=>this.options[t].enabled):e.filter(t=>this.options[t].enabled&&ue.has(t)),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:s,findAll:n,wanted:r,remaining:a}=this;if(!n&&this.file.chunked&&(n=Array.from(r).some(o=>{let l=ue.get(o),h=this.options[o];return l.multiSegment&&h.multiSegment}),n&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,s.byteLength),!this.options.onlyTiff&&s.chunked){let o=!1;for(;a.size>0&&!o&&(s.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:l}=s,h=this.appSegments.some(c=>!this.file.available(c.offset||c.start,c.length||c.size));if(o=e>l&&!h?!await s.readNextChunk(e):!await s.readNextChunk(l),(e=this.findAppSegmentsInRange(e,s.byteLength))===void 0)return}}}findAppSegmentsInRange(e,t){t-=2;let s,n,r,a,o,l,{file:h,findAll:c,wanted:u,remaining:y,options:g}=this;for(;e<t;e++)if(h.getUint8(e)===255){if(s=h.getUint8(e+1),Od(s)){if(n=h.getUint16(e+2),r=Md(h,e,n),r&&u.has(r)&&(a=ue.get(r),o=a.findPosition(h,e),l=g[r],o.type=r,this.appSegments.push(o),!c&&(a.multiSegment&&l.multiSegment?(this.unfinishedMultiSegment=o.chunkNumber<o.chunkCount,this.unfinishedMultiSegment||y.delete(r)):y.delete(r),y.size===0)))break;g.recordUnknownSegments&&(o=at.findPosition(h,e),o.marker=s,this.unknownSegments.push(o)),e+=n+1}else if(Ad(s)){if(n=h.getUint16(e+2),s===218&&g.stopAfterSos!==!1)return;g.recordJpegSegments&&this.jpegSegments.push({offset:e,length:n,marker:s}),e+=n+1}}return e}mergeMultiSegments(){if(!this.appSegments.some(t=>t.multiSegment))return;let e=function(t,s){let n,r,a,o=new Map;for(let l=0;l<t.length;l++)n=t[l],r=n[s],o.has(r)?a=o.get(r):o.set(r,a=[]),a.push(n);return Array.from(o)}(this.appSegments,"type");this.mergedAppSegments=e.map(([t,s])=>{let n=ue.get(t,this.options);return n.handleMultiSegments?{type:t,chunk:n.handleMultiSegments(s)}:s[0]})}getSegment(e){return this.appSegments.find(t=>t.type===e)}async getOrFindSegment(e){let t=this.getSegment(e);return t===void 0&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}}M(yr,"type","jpeg"),Ta.set("jpeg",yr);const Rd=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class Id extends at{parseHeader(){var e=this.chunk.getUint16();e===18761?this.le=!0:e===19789&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,s=new Map){let{pick:n,skip:r}=this.options[t];n=new Set(n);let a=n.size>0,o=r.size===0,l=this.chunk.getUint16(e);e+=2;for(let h=0;h<l;h++){let c=this.chunk.getUint16(e);if(a){if(n.has(c)&&(s.set(c,this.parseTag(e,c,t)),n.delete(c),n.size===0))break}else!o&&r.has(c)||s.set(c,this.parseTag(e,c,t));e+=12}return s}parseTag(e,t,s){let{chunk:n}=this,r=n.getUint16(e+2),a=n.getUint32(e+4),o=Rd[r];if(o*a<=4?e+=8:e=n.getUint32(e+8),(r<1||r>13)&&W(`Invalid TIFF value type. block: ${s.toUpperCase()}, tag: ${t.toString(16)}, type: ${r}, offset ${e}`),e>n.byteLength&&W(`Invalid TIFF value offset. block: ${s.toUpperCase()}, tag: ${t.toString(16)}, type: ${r}, offset ${e} is outside of chunk size ${n.byteLength}`),r===1)return n.getUint8Array(e,a);if(r===2)return(l=function(h){for(;h.endsWith("\0");)h=h.slice(0,-1);return h}(l=n.getString(e,a)).trim())===""?void 0:l;var l;if(r===7)return n.getUint8Array(e,a);if(a===1)return this.parseTagValue(r,e);{let h=new(function(u){switch(u){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(r))(a),c=o;for(let u=0;u<a;u++)h[u]=this.parseTagValue(r,e),e+=c;return h}}parseTagValue(e,t){let{chunk:s}=this;switch(e){case 1:return s.getUint8(t);case 3:return s.getUint16(t);case 4:return s.getUint32(t);case 5:return s.getUint32(t)/s.getUint32(t+4);case 6:return s.getInt8(t);case 8:return s.getInt16(t);case 9:return s.getInt32(t);case 10:return s.getInt32(t)/s.getInt32(t+4);case 11:return s.getFloat(t);case 12:return s.getDouble(t);case 13:return s.getUint32(t);default:W(`Invalid tiff type ${e}`)}}}class wi extends Id{static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1165519206&&e.getUint16(t+8)===0}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return t.catch!==void 0&&(t=t.catch(this.handleError)),t}findIfd0Offset(){this.ifd0Offset===void 0&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(this.ifd1Offset===void 0){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let s=new Map;return this[t]=s,this.parseTags(e,t,s),s}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&W("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&W(`IFD0 offset points to outside of file.
this.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,cr(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return t.size!==0?(this.exifOffset=t.get(34665),this.interopOffset=t.get(40965),this.gpsOffset=t.get(34853),this.xmp=t.get(700),this.iptc=t.get(33723),this.icc=t.get(34675),this.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t):void 0}async parseExifBlock(){if(this.exif||(this.ifd0||await this.parseIfd0Block(),this.exifOffset===void 0))return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,cr(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let s=e.get(t);s&&s.length===1&&e.set(t,s[0])}async parseGpsBlock(){if(this.gps||(this.ifd0||await this.parseIfd0Block(),this.gpsOffset===void 0))return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",br(...e.get(2),e.get(1))),e.set("longitude",br(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),this.interopOffset!==void 0||this.exif||await this.parseExifBlock(),this.interopOffset!==void 0))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),this.ifd1===void 0)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,s,n={};for(t of V)if(e=this[t],!ka(e))if(s=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if(t==="ifd1")continue;Object.assign(n,s)}else n[t]=s;return this.makerNote&&(n.makerNote=this.makerNote),this.userComment&&(n.userComment=this.userComment),n}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[s,n]of Object.entries(t))this.assignObjectToOutput(e,s,n)}}function br(i,e,t,s){var n=i+e/60+t/3600;return s!=="S"&&s!=="W"||(n*=-1),n}M(wi,"type","tiff"),M(wi,"headerLength",10),ue.set("tiff",wi);const bn={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1};Object.assign({},bn,{firstChunkSize:4e4,gps:[1,2,3,4]});Object.assign({},bn,{tiff:!1,ifd1:!0,mergeOutput:!1});const Dd=Object.assign({},bn,{firstChunkSize:4e4,ifd0:[274]});async function Bd(i){let e=new Ud(Dd);await e.read(i);let t=await e.parse();if(t&&t.ifd0)return t.ifd0[274]}const Ld=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});let Mt=!0,Rt=!0;if(typeof navigator=="object"){let i=navigator.userAgent;if(i.includes("iPad")||i.includes("iPhone")){let e=i.match(/OS (\d+)_(\d+)/);if(e){let[,t,s]=e;Mt=Number(t)+.1*Number(s)<13.4,Rt=!1}}else if(i.includes("OS X 10")){let[,e]=i.match(/OS X 10[_.](\d+)/);Mt=Rt=Number(e)<15}if(i.includes("Chrome/")){let[,e]=i.match(/Chrome\/(\d+)/);Mt=Rt=Number(e)<81}else if(i.includes("Firefox/")){let[,e]=i.match(/Firefox\/(\d+)/);Mt=Rt=Number(e)<77}}async function jd(i){let e=await Bd(i);return Object.assign({canvas:Mt,css:Rt},Ld[e])}class $d extends he{constructor(...e){super(...e),M(this,"ranges",new zd),this.byteLength!==0&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,s){if(e===0&&this.byteLength===0&&s){let n=new DataView(s.buffer||s,s.byteOffset,s.byteLength);this._swapDataView(n)}else{let n=e+t;if(n>this.byteLength){let{dataView:r}=this._extend(n);this._swapDataView(r)}}}_extend(e){let t;t=Pa?xa.allocUnsafe(e):new Uint8Array(e);let s=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:s}}subarray(e,t,s=!1){return t=t||this._lengthToEnd(e),s&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,s=!1){s&&this._tryExtend(t,e.byteLength,e);let n=super.set(e,t);return this.ranges.add(t,n.byteLength),n}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}}class zd{constructor(){M(this,"list",[])}get length(){return this.list.length}add(e,t,s=0){let n=e+t,r=this.list.filter(a=>vr(e,a.offset,n)||vr(e,a.end,n));if(r.length>0){e=Math.min(e,...r.map(o=>o.offset)),n=Math.max(n,...r.map(o=>o.end)),t=n-e;let a=r.shift();a.offset=e,a.length=t,a.end=n,this.list=this.list.filter(o=>!r.includes(o))}else this.list.push({offset:e,length:t,end:n})}available(e,t){let s=e+t;return this.list.some(n=>n.offset<=e&&s<=n.end)}}function vr(i,e,t){return i<=e&&e<=t}class Hd extends $d{constructor(e,t){super(0),M(this,"chunksRead",0),this.input=e,this.options=t}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,s=await this.readChunk(e,t);return!!s&&s.byteLength===t}async readChunk(e,t){if(this.chunksRead++,(t=this.safeWrapAddress(e,t))!==0)return this._readChunk(e,t)}safeWrapAddress(e,t){return this.size!==void 0&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(this.ranges.list.length!==0)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return this.size!==void 0&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}mn.set("blob",class extends Hd{async readWhole(){this.chunked=!1;let i=await Gi(this.input);this._swapArrayBuffer(i)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(i,e){let t=e?i+e:void 0,s=this.input.slice(i,t),n=await Gi(s);return this.set(n,i,!0)}});const qd="4.2.3",Vd={version:qd},Wd={strings:{generatingThumbnails:"Generating thumbnails..."}};function Gd(i,e,t){try{i.getContext("2d").getImageData(0,0,1,1)}catch(s){if(s.code===18)return Promise.reject(new Error("cannot read image, probably an svg with external resources"))}return i.toBlob?new Promise(s=>{i.toBlob(s,e,t)}).then(s=>{if(s===null)throw new Error("cannot read image, probably an svg with external resources");return s}):Promise.resolve().then(()=>xd(i.toDataURL(e,t),{})).then(s=>{if(s===null)throw new Error("could not extract blob, probably an old browser");return s})}function Kd(i,e){let t=i.width,s=i.height;(e.deg===90||e.deg===270)&&(t=i.height,s=i.width);const n=document.createElement("canvas");n.width=t,n.height=s;const r=n.getContext("2d");return r.translate(t/2,s/2),e.canvas&&(r.rotate(e.rad),r.scale(e.scaleX,e.scaleY)),r.drawImage(i,-i.width/2,-i.height/2,i.width,i.height),n}function Xd(i){const e=i.width/i.height,t=5e6,s=4096;let n=Math.floor(Math.sqrt(t*e)),r=Math.floor(t/Math.sqrt(t*e));if(n>s&&(n=s,r=Math.round(n/e)),r>s&&(r=s,n=Math.round(e*r)),i.width>n){const a=document.createElement("canvas");return a.width=n,a.height=r,a.getContext("2d").drawImage(i,0,0,n,r),a}return i}const Yd={thumbnailWidth:null,thumbnailHeight:null,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,lazy:!1};class Aa extends Tt{constructor(t,s){super(t,{...Yd,...s});m(this,"queue");m(this,"queueProcessing");m(this,"defaultThumbnailDimension");m(this,"thumbnailType");m(this,"onFileAdded",t=>{!t.preview&&t.data&&dr(t.type)&&!t.isRemote&&this.addToQueue(t.id)});m(this,"onCancelRequest",t=>{const s=this.queue.indexOf(t.id);s!==-1&&this.queue.splice(s,1)});m(this,"onFileRemoved",t=>{const s=this.queue.indexOf(t.id);s!==-1&&this.queue.splice(s,1),t.preview&&lr(t.preview)&&URL.revokeObjectURL(t.preview)});m(this,"onRestored",()=>{this.uppy.getFiles().filter(s=>s.isRestored).forEach(s=>{(!s.preview||lr(s.preview))&&this.addToQueue(s.id)})});m(this,"onAllFilesRemoved",()=>{this.queue=[]});m(this,"waitUntilAllProcessed",t=>{t.forEach(n=>{const r=this.uppy.getFile(n);this.uppy.emit("preprocess-progress",r,{mode:"indeterminate",message:this.i18n("generatingThumbnails")})});const s=()=>{t.forEach(n=>{const r=this.uppy.getFile(n);this.uppy.emit("preprocess-complete",r)})};return new Promise(n=>{this.queueProcessing?this.uppy.once("thumbnail:all-generated",()=>{s(),n()}):(s(),n())})});if(this.type="modifier",this.id=this.opts.id||"ThumbnailGenerator",this.title="Thumbnail Generator",this.queue=[],this.queueProcessing=!1,this.defaultThumbnailDimension=200,this.thumbnailType=this.opts.thumbnailType,this.defaultLocale=Wd,this.i18nInit(),this.opts.lazy&&this.opts.waitForThumbnailsBeforeUpload)throw new Error("ThumbnailGenerator: The `lazy` and `waitForThumbnailsBeforeUpload` options are mutually exclusive. Please ensure at most one of them is set to `true`.")}createThumbnail(t,s,n){const r=URL.createObjectURL(t.data),a=new Promise((l,h)=>{const c=new Image;c.src=r,c.addEventListener("load",()=>{URL.revokeObjectURL(r),l(c)}),c.addEventListener("error",u=>{URL.revokeObjectURL(r),h(u.error||new Error("Could not create thumbnail"))})}),o=jd(t.data).catch(()=>1);return Promise.all([a,o]).then(([l,h])=>{const c=this.getProportionalDimensions(l,s,n,h.deg),u=Kd(l,h),y=this.resizeImage(u,c.width,c.height);return Gd(y,this.thumbnailType,80)}).then(l=>URL.createObjectURL(l))}getProportionalDimensions(t,s,n,r){let a=t.width/t.height;if((r===90||r===270)&&(a=t.height/t.width),s!=null){let o=s;return t.width<s&&(o=t.width),{width:o,height:Math.round(o/a)}}if(n!=null){let o=n;return t.height<n&&(o=t.height),{width:Math.round(o*a),height:o}}return{width:this.defaultThumbnailDimension,height:Math.round(this.defaultThumbnailDimension/a)}}resizeImage(t,s,n){let r=Xd(t),a=Math.ceil(Math.log2(r.width/s));a<1&&(a=1);let o=s*2**(a-1),l=n*2**(a-1);const h=2;for(;a--;){const c=document.createElement("canvas");c.width=o,c.height=l,c.getContext("2d").drawImage(r,0,0,o,l),r=c,o=Math.round(o/h),l=Math.round(l/h)}return r}setPreviewURL(t,s){this.uppy.setFileState(t,{preview:s})}addToQueue(t){this.queue.push(t),this.queueProcessing===!1&&this.processQueue()}processQueue(){if(this.queueProcessing=!0,this.queue.length>0){const t=this.uppy.getFile(this.queue.shift());return t?this.requestThumbnail(t).catch(()=>{}).then(()=>this.processQueue()):(this.uppy.log("[ThumbnailGenerator] file was removed before a thumbnail could be generated, but not removed from the queue. This is probably a bug","error"),Promise.resolve())}return this.queueProcessing=!1,this.uppy.log("[ThumbnailGenerator] Emptied thumbnail queue"),this.uppy.emit("thumbnail:all-generated"),Promise.resolve()}requestThumbnail(t){return dr(t.type)&&!t.isRemote?this.createThumbnail(t,this.opts.thumbnailWidth,this.opts.thumbnailHeight).then(s=>{this.setPreviewURL(t.id,s),this.uppy.log(`[ThumbnailGenerator] Generated thumbnail for ${t.id}`),this.uppy.emit("thumbnail:generated",this.uppy.getFile(t.id),s)}).catch(s=>{this.uppy.log(`[ThumbnailGenerator] Failed thumbnail for ${t.id}:`,"warning"),this.uppy.log(s,"warning"),this.uppy.emit("thumbnail:error",this.uppy.getFile(t.id),s)}):Promise.resolve()}install(){this.uppy.on("file-removed",this.onFileRemoved),this.uppy.on("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("thumbnail:cancel",this.onCancelRequest)):(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("file-added",this.onFileAdded),this.uppy.on("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.addPreProcessor(this.waitUntilAllProcessed)}uninstall(){this.uppy.off("file-removed",this.onFileRemoved),this.uppy.off("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("thumbnail:cancel",this.onCancelRequest)):(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("file-added",this.onFileAdded),this.uppy.off("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.removePreProcessor(this.waitUntilAllProcessed)}}m(Aa,"VERSION",Vd.version);function wr(i){if(typeof i=="string"){const e=document.querySelectorAll(i);return e.length===0?null:Array.from(e)}return typeof i=="object"&&qr(i)?[i]:null}const Bt=Array.from;function Jd(i){const e=Bt(i.files);return Promise.resolve(e)}function Oa(i,e,t,{onSuccess:s}){i.readEntries(n=>{const r=[...e,...n];n.length?queueMicrotask(()=>{Oa(i,r,t,{onSuccess:s})}):s(r)},n=>{t(n),s(e)})}function Ma(i,e){return i==null?i:{kind:i.isFile?"file":i.isDirectory?"directory":void 0,name:i.name,getFile(){return new Promise((t,s)=>i.file(t,s))},async*values(){const t=i.createReader();yield*await new Promise(n=>{Oa(t,[],e,{onSuccess:r=>n(r.map(a=>Ma(a,e)))})})},isSameEntry:void 0}}async function*Ra(i,e,t=void 0){const s=()=>`${e}/${i.name}`;if(i.kind==="file"){const n=await i.getFile();n!=null?(n.relativePath=e?s():null,yield n):t!=null&&(yield t)}else if(i.kind==="directory")for await(const n of i.values())yield*Ra(n,e?s():i.name);else t!=null&&(yield t)}async function*Qd(i,e){const t=await Promise.all(Array.from(i.items,async s=>{let n;return n??(n=Ma(typeof s.getAsEntry=="function"?s.getAsEntry():s.webkitGetAsEntry(),e)),{fileSystemHandle:n,lastResortFile:s.getAsFile()}}));for(const{lastResortFile:s,fileSystemHandle:n}of t)if(n!=null)try{yield*Ra(n,"",s)}catch(r){s!=null?yield s:e(r)}else s!=null&&(yield s)}async function Zd(i,e){const t=(e==null?void 0:e.logDropError)??Function.prototype;try{const s=[];for await(const n of Qd(i,t))s.push(n);return s}catch{return Jd(i)}}const eu="4.4.3",tu={version:eu};function su(){const i=document.body;return!(!("draggable"in i)||!("ondragstart"in i&&"ondrop"in i)||!("FormData"in window)||!("FileReader"in window))}class Ia extends ee{constructor(){super(...arguments);m(this,"fileInput",null);m(this,"folderInput",null);m(this,"mobilePhotoFileInput",null);m(this,"mobileVideoFileInput",null);m(this,"triggerFileInputClick",()=>{var t;(t=this.fileInput)==null||t.click()});m(this,"triggerFolderInputClick",()=>{var t;(t=this.folderInput)==null||t.click()});m(this,"triggerVideoCameraInputClick",()=>{var t;(t=this.mobileVideoFileInput)==null||t.click()});m(this,"triggerPhotoCameraInputClick",()=>{var t;(t=this.mobilePhotoFileInput)==null||t.click()});m(this,"onFileInputChange",t=>{this.props.handleInputChange(t),t.currentTarget.value=""});m(this,"renderHiddenInput",(t,s)=>{var n;return d("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,webkitdirectory:t,type:"file",name:"files[]",multiple:this.props.maxNumberOfFiles!==1,onChange:this.onFileInputChange,accept:(n=this.props.allowedFileTypes)==null?void 0:n.join(", "),ref:s})});m(this,"renderHiddenCameraInput",(t,s,n)=>{const a={photo:"image/*",video:"video/*"}[t];return d("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,type:"file",name:`camera-${t}`,onChange:this.onFileInputChange,capture:s===""?"environment":s,accept:a,ref:n})});m(this,"renderMyDeviceAcquirer",()=>d("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MyDevice",children:d("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerFileInputClick,children:[d("div",{className:"uppy-DashboardTab-inner",children:d("svg",{className:"uppy-DashboardTab-iconMyDevice","aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:d("path",{d:"M8.45 22.087l-1.305-6.674h17.678l-1.572 6.674H8.45zm4.975-12.412l1.083 1.765a.823.823 0 00.715.386h7.951V13.5H8.587V9.675h4.838zM26.043 13.5h-1.195v-2.598c0-.463-.336-.75-.798-.75h-8.356l-1.082-1.766A.823.823 0 0013.897 8H7.728c-.462 0-.815.256-.815.718V13.5h-.956a.97.97 0 00-.746.37.972.972 0 00-.19.81l1.724 8.565c.095.44.484.755.933.755H24c.44 0 .824-.3.929-.727l2.043-8.568a.972.972 0 00-.176-.825.967.967 0 00-.753-.38z",fill:"currentcolor","fill-rule":"evenodd"})})}),d("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("myDevice")})]})}));m(this,"renderPhotoCamera",()=>d("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MobilePhotoCamera",children:d("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerPhotoCameraInputClick,children:[d("div",{className:"uppy-DashboardTab-inner",children:d("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:d("path",{d:"M23.5 9.5c1.417 0 2.5 1.083 2.5 2.5v9.167c0 1.416-1.083 2.5-2.5 2.5h-15c-1.417 0-2.5-1.084-2.5-2.5V12c0-1.417 1.083-2.5 2.5-2.5h2.917l1.416-2.167C13 7.167 13.25 7 13.5 7h5c.25 0 .5.167.667.333L20.583 9.5H23.5zM16 11.417a4.706 4.706 0 00-4.75 4.75 4.704 4.704 0 004.75 4.75 4.703 4.703 0 004.75-4.75c0-2.663-2.09-4.75-4.75-4.75zm0 7.825c-1.744 0-3.076-1.332-3.076-3.074 0-1.745 1.333-3.077 3.076-3.077 1.744 0 3.074 1.333 3.074 3.076s-1.33 3.075-3.074 3.075z",fill:"#02B383","fill-rule":"nonzero"})})}),d("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("takePictureBtn")})]})}));m(this,"renderVideoCamera",()=>d("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MobileVideoCamera",children:d("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerVideoCameraInputClick,children:[d("div",{className:"uppy-DashboardTab-inner",children:d("svg",{"aria-hidden":"true",width:"32",height:"32",viewBox:"0 0 32 32",children:d("path",{fill:"#FF675E",fillRule:"nonzero",d:"m21.254 14.277 2.941-2.588c.797-.313 1.243.818 1.09 1.554-.01 2.094.02 4.189-.017 6.282-.126.915-1.145 1.08-1.58.34l-2.434-2.142c-.192.287-.504 1.305-.738.468-.104-1.293-.028-2.596-.05-3.894.047-.312.381.823.426 1.069.063-.384.206-.744.362-1.09zm-12.939-3.73c3.858.013 7.717-.025 11.574.02.912.129 1.492 1.237 1.351 2.217-.019 2.412.04 4.83-.03 7.239-.17 1.025-1.166 1.59-2.029 1.429-3.705-.012-7.41.025-11.114-.019-.913-.129-1.492-1.237-1.352-2.217.018-2.404-.036-4.813.029-7.214.136-.82.83-1.473 1.571-1.454z "})})}),d("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("recordVideoBtn")})]})}));m(this,"renderBrowseButton",(t,s)=>{const n=this.props.acquirers.length;return d("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-browse",onClick:s,"data-uppy-super-focusable":n===0,children:t})});m(this,"renderDropPasteBrowseTagline",t=>{const s=this.renderBrowseButton(this.props.i18n("browseFiles"),this.triggerFileInputClick),n=this.renderBrowseButton(this.props.i18n("browseFolders"),this.triggerFolderInputClick),r=this.props.fileManagerSelectionType,a=r.charAt(0).toUpperCase()+r.slice(1);return d("div",{class:"uppy-Dashboard-AddFiles-title",children:this.props.disableLocalFiles?this.props.i18n("importFiles"):t>0?this.props.i18nArray(`dropPasteImport${a}`,{browseFiles:s,browseFolders:n,browse:s}):this.props.i18nArray(`dropPaste${a}`,{browseFiles:s,browseFolders:n,browse:s})})});m(this,"renderAcquirer",t=>{var s;return d("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":t.id,children:d("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-cy":t.id,"aria-controls":`uppy-DashboardContent-panel--${t.id}`,"aria-selected":((s=this.props.activePickerPanel)==null?void 0:s.id)===t.id,"data-uppy-super-focusable":!0,onClick:()=>this.props.showPanel(t.id),children:[d("div",{className:"uppy-DashboardTab-inner",children:t.icon()}),d("div",{className:"uppy-DashboardTab-name",children:t.name})]})})});m(this,"renderAcquirers",t=>{const s=[...t],n=s.splice(t.length-2,t.length);return d(pe,{children:[s.map(r=>this.renderAcquirer(r)),d("span",{role:"presentation",style:{"white-space":"nowrap"},children:n.map(r=>this.renderAcquirer(r))})]})});m(this,"renderSourcesList",(t,s)=>{const{showNativePhotoCameraButton:n,showNativeVideoCameraButton:r}=this.props;let a=[];const o="myDevice";s||a.push({key:o,elements:this.renderMyDeviceAcquirer()}),n&&a.push({key:"nativePhotoCameraButton",elements:this.renderPhotoCamera()}),r&&a.push({key:"nativePhotoCameraButton",elements:this.renderVideoCamera()}),a.push(...t.map(u=>({key:u.id,elements:this.renderAcquirer(u)}))),a.length===1&&a[0].key===o&&(a=[]);const h=[...a],c=h.splice(a.length-2,a.length);return d(pe,{children:[this.renderDropPasteBrowseTagline(a.length),d("div",{className:"uppy-Dashboard-AddFiles-list",role:"tablist",children:[h.map(({key:u,elements:y})=>d(pe,{children:y},u)),d("span",{role:"presentation",style:{"white-space":"nowrap"},children:c.map(({key:u,elements:y})=>d(pe,{children:y},u))})]})]})})}[Symbol.for("uppy test: disable unused locale key warning")](){this.props.i18nArray("dropPasteBoth"),this.props.i18nArray("dropPasteFiles"),this.props.i18nArray("dropPasteFolders"),this.props.i18nArray("dropPasteImportBoth"),this.props.i18nArray("dropPasteImportFiles"),this.props.i18nArray("dropPasteImportFolders")}renderPoweredByUppy(){const{i18nArray:t}=this.props,s=d("span",{children:[d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-poweredByIcon",width:"11",height:"11",viewBox:"0 0 11 11",children:d("path",{d:"M7.365 10.5l-.01-4.045h2.612L5.5.806l-4.467 5.65h2.604l.01 4.044h3.718z",fillRule:"evenodd"})}),d("span",{className:"uppy-Dashboard-poweredByUppy",children:"Uppy"})]}),n=t("poweredBy",{uppy:s});return d("a",{tabIndex:-1,href:"https://uppy.io",rel:"noreferrer noopener",target:"_blank",className:"uppy-Dashboard-poweredBy",children:n})}render(){const{showNativePhotoCameraButton:t,showNativeVideoCameraButton:s,nativeCameraFacingMode:n}=this.props;return d("div",{className:"uppy-Dashboard-AddFiles",children:[this.renderHiddenInput(!1,r=>{this.fileInput=r}),this.renderHiddenInput(!0,r=>{this.folderInput=r}),t&&this.renderHiddenCameraInput("photo",n,r=>{this.mobilePhotoFileInput=r}),s&&this.renderHiddenCameraInput("video",n,r=>{this.mobileVideoFileInput=r}),this.renderSourcesList(this.props.acquirers,this.props.disableLocalFiles),d("div",{className:"uppy-Dashboard-AddFiles-info",children:[this.props.note&&d("div",{className:"uppy-Dashboard-note",children:this.props.note}),this.props.proudlyDisplayPoweredByUppy&&this.renderPoweredByUppy()]})]})}}const iu=i=>d("div",{className:fe("uppy-Dashboard-AddFilesPanel",i.className),"data-uppy-panelType":"AddFiles","aria-hidden":!i.showAddFilesPanel,children:[d("div",{className:"uppy-DashboardContent-bar",children:[d("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:i.i18n("addingMoreFiles")}),d("button",{className:"uppy-DashboardContent-back",type:"button",onClick:()=>i.toggleAddFilesPanel(!1),children:i.i18n("back")})]}),d(Ia,{...i})]});function nu(i){const e=i.files[i.fileCardFor],t=()=>{i.uppy.emit("file-editor:cancel",e),i.closeFileEditor()};return d("div",{className:fe("uppy-DashboardContent-panel",i.className),role:"tabpanel","data-uppy-panelType":"FileEditor",id:"uppy-DashboardContent-panel--editor",children:[d("div",{className:"uppy-DashboardContent-bar",children:[d("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:i.i18nArray("editing",{file:d("span",{className:"uppy-DashboardContent-titleFile",children:e.meta?e.meta.name:e.name})})}),d("button",{className:"uppy-DashboardContent-back",type:"button",onClick:t,children:i.i18n("cancel")}),d("button",{className:"uppy-DashboardContent-save",type:"button",onClick:i.saveFileEditor,children:i.i18n("save")})]}),d("div",{className:"uppy-DashboardContent-panelBody",children:i.editors.map(s=>i.uppy.getPlugin(s.id).render(i.state))})]})}function ru(){return d("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25",children:d("g",{fill:"#686DE0",fillRule:"evenodd",children:[d("path",{d:"M5 7v10h15V7H5zm0-1h15a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1z",fillRule:"nonzero"}),d("path",{d:"M6.35 17.172l4.994-5.026a.5.5 0 0 1 .707 0l2.16 2.16 3.505-3.505a.5.5 0 0 1 .707 0l2.336 2.31-.707.72-1.983-1.97-3.505 3.505a.5.5 0 0 1-.707 0l-2.16-2.159-3.938 3.939-1.409.026z",fillRule:"nonzero"}),d("circle",{cx:"7.5",cy:"9.5",r:"1.5"})]})})}function au(){return d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:d("path",{d:"M9.5 18.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V7.25a.5.5 0 0 1 .379-.485l9-2.25A.5.5 0 0 1 18.5 5v11.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V8.67l-8 2v7.97zm8-11v-2l-8 2v2l8-2zM7 19.64c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1zm9-2c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1z",fill:"#049BCF",fillRule:"nonzero"})})}function ou(){return d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:d("path",{d:"M16 11.834l4.486-2.691A1 1 0 0 1 22 10v6a1 1 0 0 1-1.514.857L16 14.167V17a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2.834zM15 9H5v8h10V9zm1 4l5 3v-6l-5 3z",fill:"#19AF67",fillRule:"nonzero"})})}function lu(){return d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:d("path",{d:"M9.766 8.295c-.691-1.843-.539-3.401.747-3.726 1.643-.414 2.505.938 2.39 3.299-.039.79-.194 1.662-.537 3.148.324.49.66.967 1.055 1.51.17.231.382.488.629.757 1.866-.128 3.653.114 4.918.655 1.487.635 2.192 1.685 1.614 2.84-.566 1.133-1.839 1.084-3.416.249-1.141-.604-2.457-1.634-3.51-2.707a13.467 13.467 0 0 0-2.238.426c-1.392 4.051-4.534 6.453-5.707 4.572-.986-1.58 1.38-4.206 4.914-5.375.097-.322.185-.656.264-1.001.08-.353.306-1.31.407-1.737-.678-1.059-1.2-2.031-1.53-2.91zm2.098 4.87c-.033.144-.068.287-.104.427l.033-.01-.012.038a14.065 14.065 0 0 1 1.02-.197l-.032-.033.052-.004a7.902 7.902 0 0 1-.208-.271c-.197-.27-.38-.526-.555-.775l-.006.028-.002-.003c-.076.323-.148.632-.186.8zm5.77 2.978c1.143.605 1.832.632 2.054.187.26-.519-.087-1.034-1.113-1.473-.911-.39-2.175-.608-3.55-.608.845.766 1.787 1.459 2.609 1.894zM6.559 18.789c.14.223.693.16 1.425-.413.827-.648 1.61-1.747 2.208-3.206-2.563 1.064-4.102 2.867-3.633 3.62zm5.345-10.97c.088-1.793-.351-2.48-1.146-2.28-.473.119-.564 1.05-.056 2.405.213.566.52 1.188.908 1.859.18-.858.268-1.453.294-1.984z",fill:"#E2514A",fillRule:"nonzero"})})}function du(){return d("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25",children:d("path",{d:"M10.45 2.05h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V2.55a.5.5 0 0 1 .5-.5zm2.05 1.024h1.05a.5.5 0 0 1 .5.5V3.6a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5v-.001zM10.45 0h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V.5a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 3.074h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 1.024h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm-2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-1.656 3.074l-.82 5.946c.52.302 1.174.458 1.976.458.803 0 1.455-.156 1.975-.458l-.82-5.946h-2.311zm0-1.025h2.312c.512 0 .946.378 1.015.885l.82 5.946c.056.412-.142.817-.501 1.026-.686.398-1.515.597-2.49.597-.974 0-1.804-.199-2.49-.597a1.025 1.025 0 0 1-.5-1.026l.819-5.946c.07-.507.503-.885 1.015-.885zm.545 6.6a.5.5 0 0 1-.397-.561l.143-.999a.5.5 0 0 1 .495-.429h.74a.5.5 0 0 1 .495.43l.143.998a.5.5 0 0 1-.397.561c-.404.08-.819.08-1.222 0z",fill:"#00C469",fillRule:"nonzero"})})}function uu(){return d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:d("g",{fill:"#A7AFB7",fillRule:"nonzero",children:[d("path",{d:"M5.5 22a.5.5 0 0 1-.5-.5v-18a.5.5 0 0 1 .5-.5h10.719a.5.5 0 0 1 .367.16l3.281 3.556a.5.5 0 0 1 .133.339V21.5a.5.5 0 0 1-.5.5h-14zm.5-1h13V7.25L16 4H6v17z"}),d("path",{d:"M15 4v3a1 1 0 0 0 1 1h3V7h-3V4h-1z"})]})})}function cu(){return d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:d("path",{d:"M4.5 7h13a.5.5 0 1 1 0 1h-13a.5.5 0 0 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h10a.5.5 0 1 1 0 1h-10a.5.5 0 1 1 0-1z",fill:"#5A5E69",fillRule:"nonzero"})})}function vn(i){const e={color:"#838999",icon:uu()};if(!i)return e;const t=i.split("/")[0],s=i.split("/")[1];return t==="text"?{color:"#5a5e69",icon:cu()}:t==="image"?{color:"#686de0",icon:ru()}:t==="audio"?{color:"#068dbb",icon:au()}:t==="video"?{color:"#19af67",icon:ou()}:t==="application"&&s==="pdf"?{color:"#e25149",icon:lu()}:t==="application"&&["zip","x-7z-compressed","x-zip-compressed","x-rar-compressed","x-tar","x-gzip","x-apple-diskimage"].indexOf(s)!==-1?{color:"#00C469",icon:du()}:e}function De(i){const{tagName:e}=i.target;if(e==="INPUT"||e==="TEXTAREA"){i.stopPropagation();return}i.preventDefault(),i.stopPropagation()}function Da(i){const{file:e}=i;if(e.preview)return d("img",{draggable:!1,className:"uppy-Dashboard-Item-previewImg",alt:e.name,src:e.preview});const{color:t,icon:s}=vn(e.type);return d("div",{className:"uppy-Dashboard-Item-previewIconWrap",children:[d("span",{className:"uppy-Dashboard-Item-previewIcon",style:{color:t},children:s}),d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-Dashboard-Item-previewIconBg",width:"58",height:"76",viewBox:"0 0 58 76",children:d("rect",{fill:"#FFF",width:"58",height:"76",rx:"3",fillRule:"evenodd"})})]})}function hu(i){const{computedMetaFields:e,requiredMetaFields:t,updateMeta:s,form:n,formState:r}=i,a={text:"uppy-u-reset uppy-c-textInput uppy-Dashboard-FileCard-input"};return e.map(o=>{const l=`uppy-Dashboard-FileCard-input-${o.id}`,h=t.includes(o.id);return d("fieldset",{className:"uppy-Dashboard-FileCard-fieldset",children:[d("label",{className:"uppy-Dashboard-FileCard-label",htmlFor:l,children:o.name}),o.render!==void 0?o.render({value:r[o.id],onChange:c=>s(c,o.id),fieldCSSClasses:a,required:h,form:n.id},jt):d("input",{className:a.text,id:l,form:n.id,type:o.type||"text",required:h,value:r[o.id],placeholder:o.placeholder,onInput:c=>s(c.target.value,o.id),"data-uppy-super-focusable":!0})]},o.id)})}function pu(i){const{files:e,fileCardFor:t,toggleFileCard:s,saveFileCard:n,metaFields:r,requiredMetaFields:a,openFileEditor:o,i18n:l,i18nArray:h,className:c,canEditFile:u}=i,y=()=>typeof r=="function"?r(e[t]):r,g=e[t],w=y()??[],x=u(g),S={};w.forEach(k=>{S[k.id]=g.meta[k.id]??""});const[C,T]=js(S),A=il(k=>{k.preventDefault(),n(C,t)},[n,C,t]),U=(k,D)=>{T({...C,[D]:k})},R=()=>{s(!1)},[O]=js(()=>{const k=document.createElement("form");return k.setAttribute("tabindex","-1"),k.id=pn(),k});return Mi(()=>(document.body.appendChild(O),O.addEventListener("submit",A),()=>{O.removeEventListener("submit",A),document.body.removeChild(O)}),[O,A]),d("div",{className:fe("uppy-Dashboard-FileCard",c),"data-uppy-panelType":"FileCard",onDragOver:De,onDragLeave:De,onDrop:De,onPaste:De,children:[d("div",{className:"uppy-DashboardContent-bar",children:[d("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:h("editing",{file:d("span",{className:"uppy-DashboardContent-titleFile",children:g.meta?g.meta.name:g.name})})}),d("button",{className:"uppy-DashboardContent-back",type:"button",form:O.id,title:l("finishEditingFile"),onClick:R,children:l("cancel")})]}),d("div",{className:"uppy-Dashboard-FileCard-inner",children:[d("div",{className:"uppy-Dashboard-FileCard-preview",style:{backgroundColor:vn(g.type).color},children:[d(Da,{file:g}),x&&d("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-FileCard-edit",onClick:k=>{A(k),o(g)},children:l("editImage")})]}),d("div",{className:"uppy-Dashboard-FileCard-info",children:d(hu,{computedMetaFields:w,requiredMetaFields:a,updateMeta:U,form:O,formState:C})}),d("div",{className:"uppy-Dashboard-FileCard-actions",children:[d("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Dashboard-FileCard-actionsBtn",type:"submit",form:O.id,children:l("saveChanges")}),d("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-link uppy-Dashboard-FileCard-actionsBtn",type:"button",onClick:R,form:O.id,children:l("cancel")})]})]})]})}function fu(i,e){if(i===e)return!0;if(!i||!e)return!1;const t=Object.keys(i),s=Object.keys(e),n=t.length;if(s.length!==n)return!1;for(let r=0;r<n;r++){const a=t[r];if(i[a]!==e[a]||!Object.prototype.hasOwnProperty.call(e,a))return!1}return!0}function mu(i,e="Copy the URL below"){return new Promise(t=>{const s=document.createElement("textarea");s.setAttribute("style",{position:"fixed",top:0,left:0,width:"2em",height:"2em",padding:0,border:"none",outline:"none",boxShadow:"none",background:"transparent"}),s.value=i,document.body.appendChild(s),s.select();const n=()=>{document.body.removeChild(s),window.prompt(e,i),t()};try{return document.execCommand("copy")?(document.body.removeChild(s),t()):n()}catch{return document.body.removeChild(s),n()}})}function gu({file:i,uploadInProgressOrComplete:e,metaFields:t,canEditFile:s,i18n:n,onClick:r}){return!e&&t&&t.length>0||!e&&s(i)?d("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-action uppy-Dashboard-Item-action--edit",type:"button","aria-label":n("editFileWithFilename",{file:i.meta.name}),title:n("editFileWithFilename",{file:i.meta.name}),onClick:()=>r(),children:d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 14",children:d("g",{fillRule:"evenodd",children:[d("path",{d:"M1.5 10.793h2.793A1 1 0 0 0 5 10.5L11.5 4a1 1 0 0 0 0-1.414L9.707.793a1 1 0 0 0-1.414 0l-6.5 6.5A1 1 0 0 0 1.5 8v2.793zm1-1V8L9 1.5l1.793 1.793-6.5 6.5H2.5z",fillRule:"nonzero"}),d("rect",{x:"1",y:"12.293",width:"11",height:"1",rx:".5"}),d("path",{fillRule:"nonzero",d:"M6.793 2.5L9.5 5.207l.707-.707L7.5 1.793z"})]})})}):null}function yu({i18n:i,onClick:e,file:t}){return d("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--remove",type:"button","aria-label":i("removeFile",{file:t.meta.name}),title:i("removeFile",{file:t.meta.name}),onClick:()=>e(),children:d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"18",height:"18",viewBox:"0 0 18 18",children:[d("path",{d:"M9 0C4.034 0 0 4.034 0 9s4.034 9 9 9 9-4.034 9-9-4.034-9-9-9z"}),d("path",{fill:"#FFF",d:"M13 12.222l-.778.778L9 9.778 5.778 13 5 12.222 8.222 9 5 5.778 5.778 5 9 8.222 12.222 5l.778.778L9.778 9z"})]})})}function bu({file:i,uppy:e,i18n:t}){const s=n=>{mu(i.uploadURL,t("copyLinkToClipboardFallback")).then(()=>{e.log("Link copied to clipboard."),e.info(t("copyLinkToClipboardSuccess"),"info",3e3)}).catch(e.log).then(()=>n.target.focus({preventScroll:!0}))};return d("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--copyLink",type:"button","aria-label":t("copyLink"),title:t("copyLink"),onClick:n=>s(n),children:d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 12",children:d("path",{d:"M7.94 7.703a2.613 2.613 0 0 1-.626 2.681l-.852.851a2.597 2.597 0 0 1-1.849.766A2.616 2.616 0 0 1 2.764 7.54l.852-.852a2.596 2.596 0 0 1 2.69-.625L5.267 7.099a1.44 1.44 0 0 0-.833.407l-.852.851a1.458 1.458 0 0 0 1.03 2.486c.39 0 .755-.152 1.03-.426l.852-.852c.231-.231.363-.522.406-.824l1.04-1.038zm4.295-5.937A2.596 2.596 0 0 0 10.387 1c-.698 0-1.355.272-1.849.766l-.852.851a2.614 2.614 0 0 0-.624 2.688l1.036-1.036c.041-.304.173-.6.407-.833l.852-.852c.275-.275.64-.426 1.03-.426a1.458 1.458 0 0 1 1.03 2.486l-.852.851a1.442 1.442 0 0 1-.824.406l-1.04 1.04a2.596 2.596 0 0 0 2.683-.628l.851-.85a2.616 2.616 0 0 0 0-3.697zm-6.88 6.883a.577.577 0 0 0 .82 0l3.474-3.474a.579.579 0 1 0-.819-.82L5.355 7.83a.579.579 0 0 0 0 .819z"})})})}function vu(i){const{uppy:e,file:t,uploadInProgressOrComplete:s,canEditFile:n,metaFields:r,showLinkToFileUploadResult:a,showRemoveButton:o,i18n:l,toggleFileCard:h,openFileEditor:c}=i;return d("div",{className:"uppy-Dashboard-Item-actionWrapper",children:[d(gu,{i18n:l,file:t,uploadInProgressOrComplete:s,canEditFile:n,metaFields:r,onClick:()=>{r&&r.length>0?h(!0,t.id):c(t)}}),a&&t.uploadURL?d(bu,{file:t,uppy:e,i18n:l}):null,o?d(yu,{i18n:l,file:t,onClick:()=>e.removeFile(t.id)}):null]})}const _i="...";function Ba(i,e){if(e===0)return"";if(i.length<=e)return i;if(e<=_i.length+1)return`${i.slice(0,e-1)}â€¦`;const t=e-_i.length,s=Math.ceil(t/2),n=Math.floor(t/2);return i.slice(0,s)+_i+i.slice(-n)}const wu=(i,e)=>(typeof e=="function"?e():e).filter(n=>n.id===i)[0].name;function La(i){const{file:e,toggleFileCard:t,i18n:s,metaFields:n}=i,{missingRequiredMetaFields:r}=e;if(!(r!=null&&r.length))return null;const a=r.map(o=>wu(o,n)).join(", ");return d("div",{className:"uppy-Dashboard-Item-errorMessage",children:[s("missingRequiredMetaFields",{smart_count:r.length,fields:a})," ",d("button",{type:"button",class:"uppy-u-reset uppy-Dashboard-Item-errorMessageBtn",onClick:()=>t(!0,e.id),children:s("editFile")})]})}const _u=i=>{const{author:e,name:t}=i.file.meta;function s(){return i.isSingleFile&&i.containerHeight>=350?90:i.containerWidth<=352?35:i.containerWidth<=576?60:e?20:30}return d("div",{className:"uppy-Dashboard-Item-name",title:t,children:Ba(t,s())})},Su=i=>{var n;const{author:e}=i.file.meta,t=(n=i.file.remote)==null?void 0:n.providerName,s="Â·";return e?d("div",{className:"uppy-Dashboard-Item-author",children:[d("a",{href:`${e.url}?utm_source=Companion&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",children:Ba(e.name,13)}),t?d(pe,{children:[` ${s} `,t,` ${s} `]}):null]}):null},Fu=i=>i.file.size&&d("div",{className:"uppy-Dashboard-Item-statusSize",children:qe(i.file.size)}),Cu=i=>i.file.isGhost&&d("span",{children:[" â€¢ ",d("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-reSelect",type:"button",onClick:()=>i.toggleAddFilesPanel(!0),children:i.i18n("reSelect")})]}),xu=({file:i,onClick:e})=>i.error?d("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-errorDetails","aria-label":i.error,"data-microtip-position":"bottom","data-microtip-size":"medium",onClick:e,type:"button",children:"?"}):null;function Pu(i){const{file:e,i18n:t,toggleFileCard:s,metaFields:n,toggleAddFilesPanel:r,isSingleFile:a,containerHeight:o,containerWidth:l}=i;return d("div",{className:"uppy-Dashboard-Item-fileInfo","data-uppy-file-source":e.source,children:[d("div",{className:"uppy-Dashboard-Item-fileName",children:[_u({file:e,isSingleFile:a,containerHeight:o,containerWidth:l}),d(xu,{file:e,onClick:()=>alert(e.error)})]}),d("div",{className:"uppy-Dashboard-Item-status",children:[Su({file:e}),Fu({file:e}),Cu({file:e,toggleAddFilesPanel:r,i18n:t})]}),d(La,{file:e,i18n:t,toggleFileCard:s,metaFields:n})]})}function ku(i){const{file:e,i18n:t,toggleFileCard:s,metaFields:n,showLinkToFileUploadResult:r}=i,o=e.preview?"rgba(255, 255, 255, 0.5)":vn(e.type).color;return d("div",{className:"uppy-Dashboard-Item-previewInnerWrap",style:{backgroundColor:o},children:[r&&e.uploadURL&&d("a",{className:"uppy-Dashboard-Item-previewLink",href:e.uploadURL,rel:"noreferrer noopener",target:"_blank","aria-label":e.meta.name,children:d("span",{hidden:!0,children:e.meta.name})}),d(Da,{file:e}),d(La,{file:e,i18n:t,toggleFileCard:s,metaFields:n})]})}function Tu(i){if(!i.isUploaded){if(i.error&&!i.hideRetryButton){i.uppy.retryUpload(i.file.id);return}i.resumableUploads&&!i.hidePauseResumeButton?i.uppy.pauseResume(i.file.id):i.individualCancellation&&!i.hideCancelButton&&i.uppy.removeFile(i.file.id)}}function _r(i){return i.isUploaded?i.i18n("uploadComplete"):i.error?i.i18n("retryUpload"):i.resumableUploads?i.file.isPaused?i.i18n("resumeUpload"):i.i18n("pauseUpload"):i.individualCancellation?i.i18n("cancelUpload"):""}function Si(i){return d("div",{className:"uppy-Dashboard-Item-progress",children:d("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-progressIndicator",type:"button","aria-label":_r(i),title:_r(i),onClick:()=>Tu(i),children:i.children})})}function Us({children:i}){return d("svg",{"aria-hidden":"true",focusable:"false",width:"70",height:"70",viewBox:"0 0 36 36",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--circle",children:i})}function Fi({progress:i}){const e=2*Math.PI*15;return d("g",{children:[d("circle",{className:"uppy-Dashboard-Item-progressIcon--bg",r:"15",cx:"18",cy:"18","stroke-width":"2",fill:"none"}),d("circle",{className:"uppy-Dashboard-Item-progressIcon--progress",r:"15",cx:"18",cy:"18",transform:"rotate(-90, 18, 18)",fill:"none","stroke-width":"2","stroke-dasharray":e,"stroke-dashoffset":e-e/100*i})]})}function Eu(i){return!i.file.progress.uploadStarted||i.file.progress.percentage===void 0?null:i.isUploaded?d("div",{className:"uppy-Dashboard-Item-progress",children:d("div",{className:"uppy-Dashboard-Item-progressIndicator",children:d(Us,{children:[d("circle",{r:"15",cx:"18",cy:"18",fill:"#1bb240"}),d("polygon",{className:"uppy-Dashboard-Item-progressIcon--check",transform:"translate(2, 3)",points:"14 22.5 7 15.2457065 8.99985857 13.1732815 14 18.3547104 22.9729883 9 25 11.1005634"})]})})}):i.recoveredState?null:i.error&&!i.hideRetryButton?d(Si,{...i,children:d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--retry",width:"28",height:"31",viewBox:"0 0 16 19",children:[d("path",{d:"M16 11a8 8 0 1 1-8-8v2a6 6 0 1 0 6 6h2z"}),d("path",{d:"M7.9 3H10v2H7.9z"}),d("path",{d:"M8.536.5l3.535 3.536-1.414 1.414L7.12 1.914z"}),d("path",{d:"M10.657 2.621l1.414 1.415L8.536 7.57 7.12 6.157z"})]})}):i.resumableUploads&&!i.hidePauseResumeButton?d(Si,{...i,children:d(Us,{children:[d(Fi,{progress:i.file.progress.percentage}),i.file.isPaused?d("polygon",{className:"uppy-Dashboard-Item-progressIcon--play",transform:"translate(3, 3)",points:"12 20 12 10 20 15"}):d("g",{className:"uppy-Dashboard-Item-progressIcon--pause",transform:"translate(14.5, 13)",children:[d("rect",{x:"0",y:"0",width:"2",height:"10",rx:"0"}),d("rect",{x:"5",y:"0",width:"2",height:"10",rx:"0"})]})]})}):!i.resumableUploads&&i.individualCancellation&&!i.hideCancelButton?d(Si,{...i,children:d(Us,{children:[d(Fi,{progress:i.file.progress.percentage}),d("polygon",{className:"cancel",transform:"translate(2, 2)",points:"19.8856516 11.0625 16 14.9481516 12.1019737 11.0625 11.0625 12.1143484 14.9481516 16 11.0625 19.8980263 12.1019737 20.9375 16 17.0518484 19.8856516 20.9375 20.9375 19.8980263 17.0518484 16 20.9375 12"})]})}):d("div",{className:"uppy-Dashboard-Item-progress",children:d("div",{className:"uppy-Dashboard-Item-progressIndicator",children:d(Us,{children:d(Fi,{progress:i.file.progress.percentage})})})})}class Nu extends ee{componentDidMount(){const{file:e}=this.props;e.preview||this.props.handleRequestThumbnail(e)}shouldComponentUpdate(e){return!fu(this.props,e)}componentDidUpdate(){const{file:e}=this.props;e.preview||this.props.handleRequestThumbnail(e)}componentWillUnmount(){const{file:e}=this.props;e.preview||this.props.handleCancelThumbnail(e)}render(){const{file:e}=this.props,t=e.progress.preprocess||e.progress.postprocess,s=!!e.progress.uploadComplete&&!t&&!e.error,n=!!e.progress.uploadStarted||!!t,r=e.progress.uploadStarted&&!e.progress.uploadComplete||t,a=e.error||!1,{isGhost:o}=e;let l=(this.props.individualCancellation||!r)&&!s;s&&this.props.showRemoveButtonAfterComplete&&(l=!0);const h=fe({"uppy-Dashboard-Item":!0,"is-inprogress":r&&!this.props.recoveredState,"is-processing":t,"is-complete":s,"is-error":!!a,"is-resumable":this.props.resumableUploads,"is-noIndividualCancellation":!this.props.individualCancellation,"is-ghost":o});return d("div",{className:h,id:`uppy_${e.id}`,role:this.props.role,children:[d("div",{className:"uppy-Dashboard-Item-preview",children:[d(ku,{file:e,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,i18n:this.props.i18n,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields}),d(Eu,{uppy:this.props.uppy,file:e,error:a,isUploaded:s,hideRetryButton:this.props.hideRetryButton,hideCancelButton:this.props.hideCancelButton,hidePauseResumeButton:this.props.hidePauseResumeButton,recoveredState:this.props.recoveredState,resumableUploads:this.props.resumableUploads,individualCancellation:this.props.individualCancellation,i18n:this.props.i18n})]}),d("div",{className:"uppy-Dashboard-Item-fileInfoAndButtons",children:[d(Pu,{file:e,containerWidth:this.props.containerWidth,containerHeight:this.props.containerHeight,i18n:this.props.i18n,toggleAddFilesPanel:this.props.toggleAddFilesPanel,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields,isSingleFile:this.props.isSingleFile}),d(vu,{file:e,metaFields:this.props.metaFields,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,showRemoveButton:l,canEditFile:this.props.canEditFile,uploadInProgressOrComplete:n,toggleFileCard:this.props.toggleFileCard,openFileEditor:this.props.openFileEditor,uppy:this.props.uppy,i18n:this.props.i18n})]})]})}}function Uu(i,e){const t=[];let s=[];return i.forEach(n=>{s.length<e?s.push(n):(t.push(s),s=[n])}),s.length&&t.push(s),t}function Au({id:i,i18n:e,uppy:t,files:s,resumableUploads:n,hideRetryButton:r,hidePauseResumeButton:a,hideCancelButton:o,showLinkToFileUploadResult:l,showRemoveButtonAfterComplete:h,metaFields:c,isSingleFile:u,toggleFileCard:y,handleRequestThumbnail:g,handleCancelThumbnail:w,recoveredState:x,individualCancellation:S,itemsPerRow:C,openFileEditor:T,canEditFile:A,toggleAddFilesPanel:U,containerWidth:R,containerHeight:O}){const k=C===1?71:200,D=hn(()=>{const L=(E,B)=>Number(s[B].isGhost)-Number(s[E].isGhost),b=Object.keys(s);return x&&b.sort(L),Uu(b,C)},[s,C,x]),H=L=>d("div",{class:"uppy-Dashboard-filesInner",role:"presentation",children:L.map(b=>d(Nu,{uppy:t,id:i,i18n:e,resumableUploads:n,individualCancellation:S,hideRetryButton:r,hidePauseResumeButton:a,hideCancelButton:o,showLinkToFileUploadResult:l,showRemoveButtonAfterComplete:h,metaFields:c,recoveredState:x,isSingleFile:u,containerWidth:R,containerHeight:O,toggleFileCard:y,handleRequestThumbnail:g,handleCancelThumbnail:w,role:"listitem",openFileEditor:T,canEditFile:A,toggleAddFilesPanel:U,file:s[b]},b))},L[0]);return u?d("div",{class:"uppy-Dashboard-files",children:H(D[0])}):d(Ql,{class:"uppy-Dashboard-files",role:"list",data:D,renderRow:H,rowHeight:k})}function Ou({activePickerPanel:i,className:e,hideAllPanels:t,i18n:s,state:n,uppy:r}){const a=Rs(null);return d("div",{className:fe("uppy-DashboardContent-panel",e),role:"tabpanel","data-uppy-panelType":"PickerPanel",id:`uppy-DashboardContent-panel--${i.id}`,onDragOver:De,onDragLeave:De,onDrop:De,onPaste:De,children:[d("div",{className:"uppy-DashboardContent-bar",children:[d("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:s("importFrom",{name:i.name})}),d("button",{className:"uppy-DashboardContent-back",type:"button",onClick:t,children:s("cancel")})]}),d("div",{ref:a,className:"uppy-DashboardContent-panelBody",children:r.getPlugin(i.id).render(n,a.current)})]})}const ge={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete",STATE_PAUSED:"paused"};function Mu(i,e,t,s={}){if(i)return ge.STATE_ERROR;if(e)return ge.STATE_COMPLETE;if(t)return ge.STATE_PAUSED;let n=ge.STATE_WAITING;const r=Object.keys(s);for(let a=0;a<r.length;a++){const{progress:o}=s[r[a]];if(o.uploadStarted&&!o.uploadComplete)return ge.STATE_UPLOADING;o.preprocess&&n!==ge.STATE_UPLOADING&&(n=ge.STATE_PREPROCESSING),o.postprocess&&n!==ge.STATE_UPLOADING&&n!==ge.STATE_PREPROCESSING&&(n=ge.STATE_POSTPROCESSING)}return n}function Ru({files:i,i18n:e,isAllComplete:t,isAllErrored:s,isAllPaused:n,inProgressNotPausedFiles:r,newFiles:a,processingFiles:o}){switch(Mu(s,t,n,i)){case"uploading":return e("uploadingXFiles",{smart_count:r.length});case"preprocessing":case"postprocessing":return e("processingXFiles",{smart_count:o.length});case"paused":return e("uploadPaused");case"waiting":return e("xFilesSelected",{smart_count:a.length});case"complete":return e("uploadComplete");case"error":return e("error")}}function Iu(i){const{i18n:e,isAllComplete:t,hideCancelButton:s,maxNumberOfFiles:n,toggleAddFilesPanel:r,uppy:a}=i;let{allowNewUpload:o}=i;return o&&n&&(o=i.totalFileCount<i.maxNumberOfFiles),d("div",{className:"uppy-DashboardContent-bar",children:[!t&&!s?d("button",{className:"uppy-DashboardContent-back",type:"button",onClick:()=>a.cancelAll(),children:e("cancel")}):d("div",{}),d("div",{className:"uppy-DashboardContent-title",children:d(Ru,{...i})}),o?d("button",{className:"uppy-DashboardContent-addMore",type:"button","aria-label":e("addMoreFiles"),title:e("addMoreFiles"),onClick:()=>r(!0),children:[d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"15",height:"15",viewBox:"0 0 15 15",children:d("path",{d:"M8 6.5h6a.5.5 0 0 1 .5.5v.5a.5.5 0 0 1-.5.5H8v6a.5.5 0 0 1-.5.5H7a.5.5 0 0 1-.5-.5V8h-6a.5.5 0 0 1-.5-.5V7a.5.5 0 0 1 .5-.5h6v-6A.5.5 0 0 1 7 0h.5a.5.5 0 0 1 .5.5v6z"})}),d("span",{className:"uppy-DashboardContent-addMoreCaption",children:e("addMore")})]}):d("div",{})]})}const nt="uppy-transition-slideDownUp",Sr=250;function As({children:i}){const[e,t]=js(null),[s,n]=js(""),r=Rs(),a=Rs(),o=Rs(),l=()=>{n(`${nt}-enter`),cancelAnimationFrame(o.current),clearTimeout(a.current),a.current=void 0,o.current=requestAnimationFrame(()=>{n(`${nt}-enter ${nt}-enter-active`),r.current=setTimeout(()=>{n("")},Sr)})},h=()=>{n(`${nt}-leave`),cancelAnimationFrame(o.current),clearTimeout(r.current),r.current=void 0,o.current=requestAnimationFrame(()=>{n(`${nt}-leave ${nt}-leave-active`),a.current=setTimeout(()=>{t(null),n("")},Sr)})};return Mi(()=>{const c=ce(i)[0];e!==c&&(c&&!e?l():e&&!c&&!a.current&&h(),t(c))},[i,e]),Mi(()=>()=>{clearTimeout(r.current),clearTimeout(a.current),cancelAnimationFrame(o.current)},[]),e?ta(e,{className:fe(s,e.props.className)}):null}const Fr=900,Cr=700,Ci=576,xr=330;function Du(i){const e=i.totalFileCount===0,t=i.totalFileCount===1,s=i.containerWidth>Ci,n=i.containerHeight>xr,r=fe({"uppy-Dashboard":!0,"uppy-Dashboard--isDisabled":i.disabled,"uppy-Dashboard--animateOpenClose":i.animateOpenClose,"uppy-Dashboard--isClosing":i.isClosing,"uppy-Dashboard--isDraggingOver":i.isDraggingOver,"uppy-Dashboard--modal":!i.inline,"uppy-size--md":i.containerWidth>Ci,"uppy-size--lg":i.containerWidth>Cr,"uppy-size--xl":i.containerWidth>Fr,"uppy-size--height-md":i.containerHeight>xr,"uppy-Dashboard--isAddFilesPanelVisible":i.showAddFilesPanel,"uppy-Dashboard--isInnerWrapVisible":i.areInsidesReadyToBeVisible,"uppy-Dashboard--singleFile":i.singleFileFullScreen&&t&&n});let a=1;i.containerWidth>Fr?a=5:i.containerWidth>Cr?a=4:i.containerWidth>Ci&&(a=3);const o=i.showSelectedFiles&&!e,l=i.recoveredState?Object.keys(i.recoveredState.files).length:null,h=i.files?Object.keys(i.files).filter(y=>i.files[y].isGhost).length:0,c=()=>h>0?i.i18n("recoveredXFiles",{smart_count:h}):i.i18n("recoveredAllFiles");return d("div",{className:r,"data-uppy-theme":i.theme,"data-uppy-num-acquirers":i.acquirers.length,"data-uppy-drag-drop-supported":!i.disableLocalFiles&&su(),"aria-hidden":i.inline?"false":i.isHidden,"aria-disabled":i.disabled,"aria-label":i.inline?i.i18n("dashboardTitle"):i.i18n("dashboardWindowTitle"),onPaste:i.handlePaste,onDragOver:i.handleDragOver,onDragLeave:i.handleDragLeave,onDrop:i.handleDrop,children:[d("div",{"aria-hidden":"true",className:"uppy-Dashboard-overlay",tabIndex:-1,onClick:i.handleClickOutside}),d("div",{className:"uppy-Dashboard-inner",role:i.inline?void 0:"dialog",style:{width:i.inline&&i.width?i.width:"",height:i.inline&&i.height?i.height:""},children:[i.inline?null:d("button",{className:"uppy-u-reset uppy-Dashboard-close",type:"button","aria-label":i.i18n("closeModal"),title:i.i18n("closeModal"),onClick:i.closeModal,children:d("span",{"aria-hidden":"true",children:"Ã—"})}),d("div",{className:"uppy-Dashboard-innerWrap",children:[d("div",{className:"uppy-Dashboard-dropFilesHereHint",children:i.i18n("dropHint")}),o&&d(Iu,{...i}),l&&d("div",{className:"uppy-Dashboard-serviceMsg",children:[d("svg",{className:"uppy-Dashboard-serviceMsg-icon","aria-hidden":"true",focusable:"false",width:"21",height:"16",viewBox:"0 0 24 19",children:d("g",{transform:"translate(0 -1)",fill:"none",fillRule:"evenodd",children:[d("path",{d:"M12.857 1.43l10.234 17.056A1 1 0 0122.234 20H1.766a1 1 0 01-.857-1.514L11.143 1.429a1 1 0 011.714 0z",fill:"#FFD300"}),d("path",{fill:"#000",d:"M11 6h2l-.3 8h-1.4z"}),d("circle",{fill:"#000",cx:"12",cy:"17",r:"1"})]})}),d("strong",{className:"uppy-Dashboard-serviceMsg-title",children:i.i18n("sessionRestored")}),d("div",{className:"uppy-Dashboard-serviceMsg-text",children:c()})]}),o?d(Au,{id:i.id,i18n:i.i18n,uppy:i.uppy,files:i.files,resumableUploads:i.resumableUploads,hideRetryButton:i.hideRetryButton,hidePauseResumeButton:i.hidePauseResumeButton,hideCancelButton:i.hideCancelButton,showLinkToFileUploadResult:i.showLinkToFileUploadResult,showRemoveButtonAfterComplete:i.showRemoveButtonAfterComplete,metaFields:i.metaFields,toggleFileCard:i.toggleFileCard,handleRequestThumbnail:i.handleRequestThumbnail,handleCancelThumbnail:i.handleCancelThumbnail,recoveredState:i.recoveredState,individualCancellation:i.individualCancellation,openFileEditor:i.openFileEditor,canEditFile:i.canEditFile,toggleAddFilesPanel:i.toggleAddFilesPanel,isSingleFile:t,itemsPerRow:a,containerWidth:i.containerWidth,containerHeight:i.containerHeight}):d(Ia,{i18n:i.i18n,i18nArray:i.i18nArray,acquirers:i.acquirers,handleInputChange:i.handleInputChange,maxNumberOfFiles:i.maxNumberOfFiles,allowedFileTypes:i.allowedFileTypes,showNativePhotoCameraButton:i.showNativePhotoCameraButton,showNativeVideoCameraButton:i.showNativeVideoCameraButton,nativeCameraFacingMode:i.nativeCameraFacingMode,showPanel:i.showPanel,activePickerPanel:i.activePickerPanel,disableLocalFiles:i.disableLocalFiles,fileManagerSelectionType:i.fileManagerSelectionType,note:i.note,proudlyDisplayPoweredByUppy:i.proudlyDisplayPoweredByUppy}),d(As,{children:i.showAddFilesPanel?d(iu,{...i,isSizeMD:s},"AddFiles"):null}),d(As,{children:i.fileCardFor?d(pu,{...i},"FileCard"):null}),d(As,{children:i.activePickerPanel?d(Ou,{...i},"Picker"):null}),d(As,{children:i.showFileEditor?d(nu,{...i},"Editor"):null}),d("div",{className:"uppy-Dashboard-progressindicators",children:i.progressindicators.map(y=>i.uppy.getPlugin(y.id).render(i.state))})]})]})]})}const Bu={strings:{closeModal:"Close Modal",addMoreFiles:"Add more files",addingMoreFiles:"Adding more files",importFrom:"Import from %{name}",dashboardWindowTitle:"Uppy Dashboard Window (Press escape to close)",dashboardTitle:"Uppy Dashboard",copyLinkToClipboardSuccess:"Link copied to clipboard.",copyLinkToClipboardFallback:"Copy the URL below",copyLink:"Copy link",back:"Back",removeFile:"Remove file",editFile:"Edit file",editImage:"Edit image",editing:"Editing %{file}",error:"Error",finishEditingFile:"Finish editing file",saveChanges:"Save changes",myDevice:"My Device",dropHint:"Drop your files here",uploadComplete:"Upload complete",uploadPaused:"Upload paused",resumeUpload:"Resume upload",pauseUpload:"Pause upload",retryUpload:"Retry upload",cancelUpload:"Cancel upload",xFilesSelected:{0:"%{smart_count} file selected",1:"%{smart_count} files selected"},uploadingXFiles:{0:"Uploading %{smart_count} file",1:"Uploading %{smart_count} files"},processingXFiles:{0:"Processing %{smart_count} file",1:"Processing %{smart_count} files"},poweredBy:"Powered by %{uppy}",addMore:"Add more",editFileWithFilename:"Edit file %{file}",save:"Save",cancel:"Cancel",dropPasteFiles:"Drop files here or %{browseFiles}",dropPasteFolders:"Drop files here or %{browseFolders}",dropPasteBoth:"Drop files here, %{browseFiles} or %{browseFolders}",dropPasteImportFiles:"Drop files here, %{browseFiles} or import from:",dropPasteImportFolders:"Drop files here, %{browseFolders} or import from:",dropPasteImportBoth:"Drop files here, %{browseFiles}, %{browseFolders} or import from:",importFiles:"Import files from:",browseFiles:"browse files",browseFolders:"browse folders",recoveredXFiles:{0:"We could not fully recover 1 file. Please re-select it and resume the upload.",1:"We could not fully recover %{smart_count} files. Please re-select them and resume the upload."},recoveredAllFiles:"We restored all files. You can now resume the upload.",sessionRestored:"Session restored",reSelect:"Re-select",missingRequiredMetaFields:{0:"Missing required meta field: %{fields}.",1:"Missing required meta fields: %{fields}."},takePictureBtn:"Take Picture",recordVideoBtn:"Record Video"}},ja=['a[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','area[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])',"input:not([disabled]):not([inert]):not([aria-hidden])","select:not([disabled]):not([inert]):not([aria-hidden])","textarea:not([disabled]):not([inert]):not([aria-hidden])","button:not([disabled]):not([inert]):not([aria-hidden])",'iframe:not([tabindex^="-"]):not([inert]):not([aria-hidden])','object:not([tabindex^="-"]):not([inert]):not([aria-hidden])','embed:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[contenteditable]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[tabindex]:not([tabindex^="-"]):not([inert]):not([aria-hidden])'];function $a(i,e){if(e){const t=i.querySelector(`[data-uppy-paneltype="${e}"]`);if(t)return t}return i}function Lu(){let i=!1;return Lo((t,s)=>{const n=$a(t,s),r=n.contains(document.activeElement);if(r&&i)return;const a=n.querySelector("[data-uppy-super-focusable]");if(!(r&&!a))if(a)a.focus({preventScroll:!0}),i=!0;else{const o=n.querySelector(ja);o==null||o.focus({preventScroll:!0}),i=!1}},260)}function Pr(i,e){const t=e[0];t&&(t.focus(),i.preventDefault())}function ju(i,e){const t=e[e.length-1];t&&(t.focus(),i.preventDefault())}function $u(i){return i.contains(document.activeElement)}function za(i,e,t){const s=$a(t,e),n=Bt(s.querySelectorAll(ja)),r=n.indexOf(document.activeElement);$u(s)?i.shiftKey&&r===0?ju(i,n):!i.shiftKey&&r===n.length-1&&Pr(i,n):Pr(i,n)}function zu(i,e,t){e===null||za(i,e,t)}const kr=9,Hu=27;function Tr(){const i={};return i.promise=new Promise((e,t)=>{i.resolve=e,i.reject=t}),i}const qu={target:"body",metaFields:[],thumbnailWidth:280,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,defaultPickerIcon:Zl,showLinkToFileUploadResult:!1,showProgressDetails:!1,hideUploadButton:!1,hideCancelButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideProgressAfterFinish:!1,note:null,singleFileFullScreen:!0,disableStatusBar:!1,disableInformer:!1,disableThumbnailGenerator:!1,fileManagerSelectionType:"files",proudlyDisplayPoweredByUppy:!0,showSelectedFiles:!0,showRemoveButtonAfterComplete:!1,showNativePhotoCameraButton:!1,showNativeVideoCameraButton:!1,theme:"light",autoOpen:null,disabled:!1,disableLocalFiles:!1,nativeCameraFacingMode:"",onDragLeave:()=>{},onDragOver:()=>{},onDrop:()=>{},plugins:[],doneButtonHandler:void 0,onRequestCloseModal:null,inline:!1,animateOpenClose:!0,browserBackButtonClose:!1,closeAfterFinish:!1,closeModalOnClickOutside:!1,disablePageScrollWhenModalOpen:!0,trigger:null,width:750,height:550};var Ti,ut,Xe,Yt,ct,Gs,Ks,Xs,Ye,Ys,Js,ht,G,Xi,Yi,Ha,Ji,Qi,qa;let Vu=(Ti=class extends Tt{constructor(t,s){var r;const n=(s==null?void 0:s.autoOpen)??null;super(t,{...qu,...s,autoOpen:n});v(this,G);v(this,ut);m(this,"modalName",`uppy-Dashboard-${pn()}`);m(this,"superFocus",Lu());m(this,"ifFocusedOnUppyRecently",!1);m(this,"dashboardIsDisabled");m(this,"savedScrollPosition");m(this,"savedActiveElement");m(this,"resizeObserver");m(this,"darkModeMediaQuery");m(this,"makeDashboardInsidesVisibleAnywayTimeout");m(this,"removeTarget",t=>{const n=this.getPluginState().targets.filter(r=>r.id!==t.id);this.setPluginState({targets:n})});m(this,"addTarget",t=>{const s=t.id||t.constructor.name,n=t.title||s,r=t.type;if(r!=="acquirer"&&r!=="progressindicator"&&r!=="editor")return this.uppy.log("Dashboard: can only be targeted by plugins of types: acquirer, progressindicator, editor","error"),null;const a={id:s,name:n,type:r},l=this.getPluginState().targets.slice();return l.push(a),this.setPluginState({targets:l}),this.el});m(this,"hideAllPanels",()=>{var n;const t=this.getPluginState(),s={activePickerPanel:void 0,showAddFilesPanel:!1,activeOverlayType:null,fileCardFor:null,showFileEditor:!1};t.activePickerPanel===s.activePickerPanel&&t.showAddFilesPanel===s.showAddFilesPanel&&t.showFileEditor===s.showFileEditor&&t.activeOverlayType===s.activeOverlayType||(this.setPluginState(s),this.uppy.emit("dashboard:close-panel",(n=t.activePickerPanel)==null?void 0:n.id))});m(this,"showPanel",t=>{const{targets:s}=this.getPluginState(),n=s.find(r=>r.type==="acquirer"&&r.id===t);this.setPluginState({activePickerPanel:n,activeOverlayType:"PickerPanel"}),this.uppy.emit("dashboard:show-panel",t)});m(this,"canEditFile",t=>{const{targets:s}=this.getPluginState();return p(this,Ye).call(this,s).some(r=>this.uppy.getPlugin(r.id).canEditFile(t))});m(this,"openFileEditor",t=>{const{targets:s}=this.getPluginState(),n=p(this,Ye).call(this,s);this.setPluginState({showFileEditor:!0,fileCardFor:t.id||null,activeOverlayType:"FileEditor"}),n.forEach(r=>{this.uppy.getPlugin(r.id).selectFile(t)})});m(this,"closeFileEditor",()=>{const{metaFields:t}=this.getPluginState();t&&t.length>0?this.setPluginState({showFileEditor:!1,activeOverlayType:"FileCard"}):this.setPluginState({showFileEditor:!1,fileCardFor:null,activeOverlayType:"AddFiles"})});m(this,"saveFileEditor",()=>{const{targets:t}=this.getPluginState();p(this,Ye).call(this,t).forEach(n=>{this.uppy.getPlugin(n.id).save()}),this.closeFileEditor()});m(this,"openModal",()=>{const{promise:t,resolve:s}=Tr();if(this.savedScrollPosition=window.pageYOffset,this.savedActiveElement=document.activeElement,this.opts.disablePageScrollWhenModalOpen&&document.body.classList.add("uppy-Dashboard-isFixed"),this.opts.animateOpenClose&&this.getPluginState().isClosing){const n=()=>{this.setPluginState({isHidden:!1}),this.el.removeEventListener("animationend",n,!1),s()};this.el.addEventListener("animationend",n,!1)}else this.setPluginState({isHidden:!1}),s();return this.opts.browserBackButtonClose&&this.updateBrowserHistory(),document.addEventListener("keydown",this.handleKeyDownInModal),this.uppy.emit("dashboard:modal-open"),t});m(this,"closeModal",t=>{var l;const s=(t==null?void 0:t.manualClose)??!0,{isHidden:n,isClosing:r}=this.getPluginState();if(n||r)return;const{promise:a,resolve:o}=Tr();if(this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),this.opts.animateOpenClose){this.setPluginState({isClosing:!0});const h=()=>{this.setPluginState({isHidden:!0,isClosing:!1}),this.superFocus.cancel(),this.savedActiveElement.focus(),this.el.removeEventListener("animationend",h,!1),o()};this.el.addEventListener("animationend",h,!1)}else this.setPluginState({isHidden:!0}),this.superFocus.cancel(),this.savedActiveElement.focus(),o();return document.removeEventListener("keydown",this.handleKeyDownInModal),s&&this.opts.browserBackButtonClose&&(l=history.state)!=null&&l[this.modalName]&&history.back(),this.uppy.emit("dashboard:modal-closed"),a});m(this,"isModalOpen",()=>!this.getPluginState().isHidden||!1);m(this,"requestCloseModal",()=>this.opts.onRequestCloseModal?this.opts.onRequestCloseModal():this.closeModal());m(this,"setDarkModeCapability",t=>{const{capabilities:s}=this.uppy.getState();this.uppy.setState({capabilities:{...s,darkMode:t}})});m(this,"handleSystemDarkModeChange",t=>{const s=t.matches;this.uppy.log(`[Dashboard] Dark mode is ${s?"on":"off"}`),this.setDarkModeCapability(s)});m(this,"toggleFileCard",(t,s)=>{const n=this.uppy.getFile(s);t?this.uppy.emit("dashboard:file-edit-start",n):this.uppy.emit("dashboard:file-edit-complete",n),this.setPluginState({fileCardFor:t?s:null,activeOverlayType:t?"FileCard":null})});m(this,"toggleAddFilesPanel",t=>{this.setPluginState({showAddFilesPanel:t,activeOverlayType:t?"AddFiles":null})});m(this,"addFiles",t=>{const s=t.map(n=>({source:this.id,name:n.name,type:n.type,data:n,meta:{relativePath:n.relativePath||n.webkitRelativePath||null}}));try{this.uppy.addFiles(s)}catch(n){this.uppy.log(n)}});m(this,"startListeningToResize",()=>{this.resizeObserver=new ResizeObserver(t=>{const s=t[0],{width:n,height:r}=s.contentRect;this.setPluginState({containerWidth:n,containerHeight:r,areInsidesReadyToBeVisible:!0})}),this.resizeObserver.observe(this.el.querySelector(".uppy-Dashboard-inner")),this.makeDashboardInsidesVisibleAnywayTimeout=setTimeout(()=>{const t=this.getPluginState(),s=!this.opts.inline&&t.isHidden;!t.areInsidesReadyToBeVisible&&!s&&(this.uppy.log("[Dashboard] resize event didnâ€™t fire on time: defaulted to mobile layout","warning"),this.setPluginState({areInsidesReadyToBeVisible:!0}))},1e3)});m(this,"stopListeningToResize",()=>{this.resizeObserver.disconnect(),clearTimeout(this.makeDashboardInsidesVisibleAnywayTimeout)});m(this,"recordIfFocusedOnUppyRecently",t=>{this.el.contains(t.target)?this.ifFocusedOnUppyRecently=!0:(this.ifFocusedOnUppyRecently=!1,this.superFocus.cancel())});m(this,"disableInteractiveElements",t=>{const s=["a[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])",'[role="button"]:not([disabled])'],n=p(this,ut)??Bt(this.el.querySelectorAll(s)).filter(r=>!r.classList.contains("uppy-Dashboard-close"));for(const r of n)r.tagName==="A"?r.setAttribute("aria-disabled",t):r.disabled=t;t?F(this,ut,n):F(this,ut,null),this.dashboardIsDisabled=t});m(this,"updateBrowserHistory",()=>{var t;(t=history.state)!=null&&t[this.modalName]||history.pushState({...history.state,[this.modalName]:!0},""),window.addEventListener("popstate",this.handlePopState,!1)});m(this,"handlePopState",t=>{var s;this.isModalOpen()&&(!t.state||!t.state[this.modalName])&&this.closeModal({manualClose:!1}),!this.isModalOpen()&&((s=t.state)!=null&&s[this.modalName])&&history.back()});m(this,"handleKeyDownInModal",t=>{t.keyCode===Hu&&this.requestCloseModal(),t.keyCode===kr&&za(t,this.getPluginState().activeOverlayType,this.el)});m(this,"handleClickOutside",()=>{this.opts.closeModalOnClickOutside&&this.requestCloseModal()});m(this,"handlePaste",t=>{this.uppy.iteratePlugins(n=>{var r;n.type==="acquirer"&&((r=n.handleRootPaste)==null||r.call(n,t))});const s=Bt(t.clipboardData.files);s.length>0&&(this.uppy.log("[Dashboard] Files pasted"),this.addFiles(s))});m(this,"handleInputChange",t=>{t.preventDefault();const s=Bt(t.currentTarget.files||[]);s.length>0&&(this.uppy.log("[Dashboard] Files selected through input"),this.addFiles(s))});m(this,"handleDragOver",t=>{t.preventDefault(),t.stopPropagation();const s=()=>{let o=!0;return this.uppy.iteratePlugins(l=>{var h;(h=l.canHandleRootDrop)!=null&&h.call(l,t)&&(o=!0)}),o},n=()=>{const{types:o}=t.dataTransfer;return o.some(l=>l==="Files")},r=s(),a=n();if(!r&&!a||this.opts.disabled||this.opts.disableLocalFiles&&(a||!r)||!this.uppy.getState().allowNewUpload){t.dataTransfer.dropEffect="none";return}t.dataTransfer.dropEffect="copy",this.setPluginState({isDraggingOver:!0}),this.opts.onDragOver(t)});m(this,"handleDragLeave",t=>{t.preventDefault(),t.stopPropagation(),this.setPluginState({isDraggingOver:!1}),this.opts.onDragLeave(t)});m(this,"handleDrop",async t=>{t.preventDefault(),t.stopPropagation(),this.setPluginState({isDraggingOver:!1}),this.uppy.iteratePlugins(a=>{var o;a.type==="acquirer"&&((o=a.handleRootDrop)==null||o.call(a,t))});let s=!1;const n=a=>{this.uppy.log(a,"error"),s||(this.uppy.info(a.message,"error"),s=!0)};this.uppy.log("[Dashboard] Processing dropped files");const r=await Zd(t.dataTransfer,{logDropError:n});r.length>0&&(this.uppy.log("[Dashboard] Files dropped"),this.addFiles(r)),this.opts.onDrop(t)});m(this,"handleRequestThumbnail",t=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit("thumbnail:request",t)});m(this,"handleCancelThumbnail",t=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit("thumbnail:cancel",t)});m(this,"handleKeyDownInInline",t=>{t.keyCode===kr&&zu(t,this.getPluginState().activeOverlayType,this.el)});m(this,"handlePasteOnBody",t=>{this.el.contains(document.activeElement)&&this.handlePaste(t)});m(this,"handleComplete",({failed:t})=>{this.opts.closeAfterFinish&&!(t!=null&&t.length)&&this.requestCloseModal()});m(this,"handleCancelRestore",()=>{this.uppy.emit("restore-canceled")});v(this,Xe,()=>{if(this.opts.disableThumbnailGenerator)return;const t=600,s=this.uppy.getFiles();if(s.length===1){const n=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);n==null||n.setOptions({thumbnailWidth:t});const r={...s[0],preview:void 0};n==null||n.requestThumbnail(r).then(()=>{n==null||n.setOptions({thumbnailWidth:this.opts.thumbnailWidth})})}});v(this,Yt,t=>{const s=t[0],{metaFields:n}=this.getPluginState(),r=n&&n.length>0,a=this.canEditFile(s);r&&this.opts.autoOpen==="metaEditor"?this.toggleFileCard(!0,s.id):a&&this.opts.autoOpen==="imageEditor"&&this.openFileEditor(s)});m(this,"initEvents",()=>{if(this.opts.trigger&&!this.opts.inline){const t=wr(this.opts.trigger);t?t.forEach(s=>s.addEventListener("click",this.openModal)):this.uppy.log("Dashboard modal trigger not found. Make sure `trigger` is set in Dashboard options, unless you are planning to call `dashboard.openModal()` method yourself","warning")}this.startListeningToResize(),document.addEventListener("paste",this.handlePasteOnBody),this.uppy.on("plugin-added",p(this,ht)),this.uppy.on("plugin-remove",this.removeTarget),this.uppy.on("file-added",this.hideAllPanels),this.uppy.on("dashboard:modal-closed",this.hideAllPanels),this.uppy.on("complete",this.handleComplete),this.uppy.on("files-added",p(this,Xe)),this.uppy.on("file-removed",p(this,Xe)),document.addEventListener("focus",this.recordIfFocusedOnUppyRecently,!0),document.addEventListener("click",this.recordIfFocusedOnUppyRecently,!0),this.opts.inline&&this.el.addEventListener("keydown",this.handleKeyDownInInline),this.opts.autoOpen&&this.uppy.on("files-added",p(this,Yt))});m(this,"removeEvents",()=>{const t=wr(this.opts.trigger);!this.opts.inline&&t&&t.forEach(s=>s.removeEventListener("click",this.openModal)),this.stopListeningToResize(),document.removeEventListener("paste",this.handlePasteOnBody),window.removeEventListener("popstate",this.handlePopState,!1),this.uppy.off("plugin-added",p(this,ht)),this.uppy.off("plugin-remove",this.removeTarget),this.uppy.off("file-added",this.hideAllPanels),this.uppy.off("dashboard:modal-closed",this.hideAllPanels),this.uppy.off("complete",this.handleComplete),this.uppy.off("files-added",p(this,Xe)),this.uppy.off("file-removed",p(this,Xe)),document.removeEventListener("focus",this.recordIfFocusedOnUppyRecently),document.removeEventListener("click",this.recordIfFocusedOnUppyRecently),this.opts.inline&&this.el.removeEventListener("keydown",this.handleKeyDownInInline),this.opts.autoOpen&&this.uppy.off("files-added",p(this,Yt))});m(this,"superFocusOnEachUpdate",()=>{const t=this.el.contains(document.activeElement),s=document.activeElement===document.body||document.activeElement===null,n=this.uppy.getState().info.length===0,r=!this.opts.inline;n&&(r||t||s&&this.ifFocusedOnUppyRecently)?this.superFocus(this.el,this.getPluginState().activeOverlayType):this.superFocus.cancel()});m(this,"afterUpdate",()=>{if(this.opts.disabled&&!this.dashboardIsDisabled){this.disableInteractiveElements(!0);return}!this.opts.disabled&&this.dashboardIsDisabled&&this.disableInteractiveElements(!1),this.superFocusOnEachUpdate()});m(this,"saveFileCard",(t,s)=>{this.uppy.setFileMeta(s,t),this.toggleFileCard(!1,s)});v(this,ct,t=>{const s=this.uppy.getPlugin(t.id);return{...t,icon:s.icon||this.opts.defaultPickerIcon,render:s.render}});v(this,Gs,t=>{const s=this.uppy.getPlugin(t.id);return typeof s.isSupported!="function"?!0:s.isSupported()});v(this,Ks,t=>t.filter(s=>s.type==="acquirer"&&p(this,Gs).call(this,s)).map(p(this,ct)));v(this,Xs,t=>t.filter(s=>s.type==="progressindicator").map(p(this,ct)));v(this,Ye,t=>t.filter(s=>s.type==="editor").map(p(this,ct)));m(this,"render",t=>{const s=this.getPluginState(),{files:n,capabilities:r,allowNewUpload:a}=t,{newFiles:o,uploadStartedFiles:l,completeFiles:h,erroredFiles:c,inProgressFiles:u,inProgressNotPausedFiles:y,processingFiles:g,isUploadStarted:w,isAllComplete:x,isAllPaused:S}=this.uppy.getObjectOfFilesPerState(),C=p(this,Ks).call(this,s.targets),T=p(this,Xs).call(this,s.targets),A=p(this,Ye).call(this,s.targets);let U;return this.opts.theme==="auto"?U=r.darkMode?"dark":"light":U=this.opts.theme,["files","folders","both"].indexOf(this.opts.fileManagerSelectionType)<0&&(this.opts.fileManagerSelectionType="files",console.warn(`Unsupported option for "fileManagerSelectionType". Using default of "${this.opts.fileManagerSelectionType}".`)),Du({state:t,isHidden:s.isHidden,files:n,newFiles:o,uploadStartedFiles:l,completeFiles:h,erroredFiles:c,inProgressFiles:u,inProgressNotPausedFiles:y,processingFiles:g,isUploadStarted:w,isAllComplete:x,isAllPaused:S,totalFileCount:Object.keys(n).length,totalProgress:t.totalProgress,allowNewUpload:a,acquirers:C,theme:U,disabled:this.opts.disabled,disableLocalFiles:this.opts.disableLocalFiles,direction:this.opts.direction,activePickerPanel:s.activePickerPanel,showFileEditor:s.showFileEditor,saveFileEditor:this.saveFileEditor,closeFileEditor:this.closeFileEditor,disableInteractiveElements:this.disableInteractiveElements,animateOpenClose:this.opts.animateOpenClose,isClosing:s.isClosing,progressindicators:T,editors:A,autoProceed:this.uppy.opts.autoProceed,id:this.id,closeModal:this.requestCloseModal,handleClickOutside:this.handleClickOutside,handleInputChange:this.handleInputChange,handlePaste:this.handlePaste,inline:this.opts.inline,showPanel:this.showPanel,hideAllPanels:this.hideAllPanels,i18n:this.i18n,i18nArray:this.i18nArray,uppy:this.uppy,note:this.opts.note,recoveredState:t.recoveredState,metaFields:s.metaFields,resumableUploads:r.resumableUploads||!1,individualCancellation:r.individualCancellation,isMobileDevice:r.isMobileDevice,fileCardFor:s.fileCardFor,toggleFileCard:this.toggleFileCard,toggleAddFilesPanel:this.toggleAddFilesPanel,showAddFilesPanel:s.showAddFilesPanel,saveFileCard:this.saveFileCard,openFileEditor:this.openFileEditor,canEditFile:this.canEditFile,width:this.opts.width,height:this.opts.height,showLinkToFileUploadResult:this.opts.showLinkToFileUploadResult,fileManagerSelectionType:this.opts.fileManagerSelectionType,proudlyDisplayPoweredByUppy:this.opts.proudlyDisplayPoweredByUppy,hideCancelButton:this.opts.hideCancelButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,showRemoveButtonAfterComplete:this.opts.showRemoveButtonAfterComplete,containerWidth:s.containerWidth,containerHeight:s.containerHeight,areInsidesReadyToBeVisible:s.areInsidesReadyToBeVisible,parentElement:this.el,allowedFileTypes:this.uppy.opts.restrictions.allowedFileTypes,maxNumberOfFiles:this.uppy.opts.restrictions.maxNumberOfFiles,requiredMetaFields:this.uppy.opts.restrictions.requiredMetaFields,showSelectedFiles:this.opts.showSelectedFiles,showNativePhotoCameraButton:this.opts.showNativePhotoCameraButton,showNativeVideoCameraButton:this.opts.showNativeVideoCameraButton,nativeCameraFacingMode:this.opts.nativeCameraFacingMode,singleFileFullScreen:this.opts.singleFileFullScreen,handleCancelRestore:this.handleCancelRestore,handleRequestThumbnail:this.handleRequestThumbnail,handleCancelThumbnail:this.handleCancelThumbnail,isDraggingOver:s.isDraggingOver,handleDragOver:this.handleDragOver,handleDragLeave:this.handleDragLeave,handleDrop:this.handleDrop})});v(this,Ys,()=>{const{plugins:t}=this.opts;t.forEach(s=>{const n=this.uppy.getPlugin(s);n?n.mount(this,n):this.uppy.log(`[Uppy] Dashboard could not find plugin '${s}', make sure to uppy.use() the plugins you are specifying`,"warning")})});v(this,Js,()=>{this.uppy.iteratePlugins(p(this,ht))});v(this,ht,t=>{var n;const s=["acquirer","editor"];t&&!((n=t.opts)!=null&&n.target)&&s.includes(t.type)&&(this.getPluginState().targets.some(a=>t.id===a.id)||t.mount(this,t))});m(this,"install",()=>{var l;this.setPluginState({isHidden:!0,fileCardFor:null,activeOverlayType:null,showAddFilesPanel:!1,activePickerPanel:void 0,showFileEditor:!1,metaFields:this.opts.metaFields,targets:[],areInsidesReadyToBeVisible:!1,isDraggingOver:!1});const{inline:t,closeAfterFinish:s}=this.opts;if(t&&s)throw new Error("[Dashboard] `closeAfterFinish: true` cannot be used on an inline Dashboard, because an inline Dashboard cannot be closed at all. Either set `inline: false`, or disable the `closeAfterFinish` option.");const{allowMultipleUploads:n,allowMultipleUploadBatches:r}=this.uppy.opts;(n||r)&&s&&this.uppy.log("[Dashboard] When using `closeAfterFinish`, we recommended setting the `allowMultipleUploadBatches` option to `false` in the Uppy constructor. See https://uppy.io/docs/uppy/#allowMultipleUploads-true","warning");const{target:a}=this.opts;a&&this.mount(a,this),this.opts.disableStatusBar||this.uppy.use(Fd,{id:_(this,G,Ji).call(this),target:this,..._(this,G,Xi).call(this)}),this.opts.disableInformer||this.uppy.use(va,{id:_(this,G,qa).call(this),target:this,..._(this,G,Ha).call(this)}),this.opts.disableThumbnailGenerator||this.uppy.use(Aa,{id:_(this,G,Qi).call(this),..._(this,G,Yi).call(this)}),this.darkModeMediaQuery=typeof window<"u"&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)"):null;const o=this.darkModeMediaQuery?this.darkModeMediaQuery.matches:!1;this.uppy.log(`[Dashboard] Dark mode is ${o?"on":"off"}`),this.setDarkModeCapability(o),this.opts.theme==="auto"&&((l=this.darkModeMediaQuery)==null||l.addListener(this.handleSystemDarkModeChange)),p(this,Ys).call(this),p(this,Js).call(this),this.initEvents()});m(this,"uninstall",()=>{var s;if(!this.opts.disableInformer){const n=this.uppy.getPlugin(`${this.id}:Informer`);n&&this.uppy.removePlugin(n)}if(!this.opts.disableStatusBar){const n=this.uppy.getPlugin(`${this.id}:StatusBar`);n&&this.uppy.removePlugin(n)}if(!this.opts.disableThumbnailGenerator){const n=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);n&&this.uppy.removePlugin(n)}const{plugins:t}=this.opts;t.forEach(n=>{const r=this.uppy.getPlugin(n);r&&r.unmount()}),this.opts.theme==="auto"&&((s=this.darkModeMediaQuery)==null||s.removeListener(this.handleSystemDarkModeChange)),this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),this.unmount(),this.removeEvents()});this.id=this.opts.id||"Dashboard",this.title="Dashboard",this.type="orchestrator",this.defaultLocale=Bu,this.opts.doneButtonHandler===void 0&&(this.opts.doneButtonHandler=()=>{this.uppy.clear(),this.requestCloseModal()}),(r=this.opts).onRequestCloseModal??(r.onRequestCloseModal=()=>this.closeModal()),this.i18nInit()}setOptions(t){var s,n;super.setOptions(t),(s=this.uppy.getPlugin(_(this,G,Ji).call(this)))==null||s.setOptions(_(this,G,Xi).call(this)),(n=this.uppy.getPlugin(_(this,G,Qi).call(this)))==null||n.setOptions(_(this,G,Yi).call(this))}},ut=new WeakMap,Xe=new WeakMap,Yt=new WeakMap,ct=new WeakMap,Gs=new WeakMap,Ks=new WeakMap,Xs=new WeakMap,Ye=new WeakMap,Ys=new WeakMap,Js=new WeakMap,ht=new WeakMap,G=new WeakSet,Xi=function(){const{hideUploadButton:t,hideRetryButton:s,hidePauseResumeButton:n,hideCancelButton:r,showProgressDetails:a,hideProgressAfterFinish:o,locale:l,doneButtonHandler:h}=this.opts;return{hideUploadButton:t,hideRetryButton:s,hidePauseResumeButton:n,hideCancelButton:r,showProgressDetails:a,hideAfterFinish:o,locale:l,doneButtonHandler:h}},Yi=function(){const{thumbnailWidth:t,thumbnailHeight:s,thumbnailType:n,waitForThumbnailsBeforeUpload:r}=this.opts;return{thumbnailWidth:t,thumbnailHeight:s,thumbnailType:n,waitForThumbnailsBeforeUpload:r,lazy:!r}},Ha=function(){return{}},Ji=function(){return`${this.id}:StatusBar`},Qi=function(){return`${this.id}:ThumbnailGenerator`},qa=function(){return`${this.id}:Informer`},m(Ti,"VERSION",tu.version),Ti);const Wu=["defaultChecked","defaultValue","suppressContentEditableWarning","suppressHydrationWarning","dangerouslySetInnerHTML","accessKey","className","contentEditable","contextMenu","dir","draggable","hidden","id","lang","placeholder","slot","spellCheck","style","tabIndex","title","translate","radioGroup","role","about","datatype","inlist","prefix","property","resource","typeof","vocab","autoCapitalize","autoCorrect","autoSave","color","itemProp","itemScope","itemType","itemID","itemRef","results","security","unselectable","inputMode","is","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],Gu=/^(aria-|data-)/,Va=i=>Object.fromEntries(Object.entries(i).filter(([e])=>Gu.test(e)||Wu.includes(e)));function Ku(i,e){const t=Va(i);return Object.keys(i).some(s=>!Object.hasOwn(t,s)&&i[s]!==e[s])}class Wa extends j.Component{constructor(){super(...arguments);m(this,"container");m(this,"plugin")}componentDidMount(){this.installPlugin()}componentDidUpdate(t){const{uppy:s,open:n,onRequestClose:r}=this.props;if(t.uppy!==s)this.uninstallPlugin(t),this.installPlugin();else if(Ku(this.props,t)){const{uppy:a,...o}={...this.props,inline:!1,onRequestCloseModal:r};this.plugin.setOptions(o)}t.open&&!n?this.plugin.closeModal():!t.open&&n&&this.plugin.openModal()}componentWillUnmount(){this.uninstallPlugin()}installPlugin(){const{target:t=this.container,open:s,onRequestClose:n,uppy:r,...a}=this.props,o={id:"DashboardModal",...a,inline:!1,target:t,open:s,onRequestCloseModal:n};r.use(Vu,o),this.plugin=r.getPlugin(o.id),s&&this.plugin.openModal()}uninstallPlugin(t=this.props){const{uppy:s}=t;s.removePlugin(this.plugin)}render(){return j.createElement("div",{className:"uppy-Container",ref:t=>{this.container=t},...Va(this.props)})}}m(Wa,"defaultProps",{open:void 0,onRequestClose:void 0});j.createContext({uppy:void 0,status:"init",progress:0});var Xu={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ps=j;function Yu(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var Ju=typeof Object.is=="function"?Object.is:Yu,Qu=ps.useSyncExternalStore,Zu=ps.useRef,ec=ps.useEffect,tc=ps.useMemo,sc=ps.useDebugValue;Xu.useSyncExternalStoreWithSelector=function(i,e,t,s,n){var r=Zu(null);if(r.current===null){var a={hasValue:!1,value:null};r.current=a}else a=r.current;r=tc(function(){function l(g){if(!h){if(h=!0,c=g,g=s(g),n!==void 0&&a.hasValue){var w=a.value;if(n(w,g))return u=w}return u=g}if(w=u,Ju(c,g))return w;var x=s(g);return n!==void 0&&n(w,x)?(c=g,w):(c=g,u=x)}var h=!1,c,u,y=t===void 0?null:t;return[function(){return l(e())},y===null?void 0:function(){return l(y())}]},[e,t,s,n]);var o=Qu(i,r[0],r[1]);return ec(function(){a.hasValue=!0,a.value=o},[o]),sc(o),o};function Ga(i,e){return Object.hasOwn(i,e)}class ic extends Error{constructor(t,s){super(t);m(this,"isNetworkError");m(this,"cause");this.cause=s==null?void 0:s.cause,this.cause&&Ga(this.cause,"isNetworkError")?this.isNetworkError=this.cause.isNetworkError:this.isNetworkError=!1}}class nc extends Error{constructor(t,s=null){super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall.");m(this,"cause");m(this,"isNetworkError");m(this,"request");this.cause=t,this.isNetworkError=!0,this.request=s}}function rc(...i){return fetch(...i).catch(e=>{throw e.name==="AbortError"?e:new nc(e)})}function ac(i){var n;const t=(n=/^(?:https?:\/\/|\/\/)?(?:[^@\n]+@)?([^\n]+)/i.exec(i))==null?void 0:n[1];return`${/^http:\/\//i.test(i)?"ws":"wss"}://${t}`}class oc extends Error{constructor(){super(...arguments);m(this,"name","UserFacingApiError")}}var Ka={};function se(i,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(i)),this._timeouts=i,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var lc=se;se.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};se.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};se.prototype.retry=function(i){if(this._timeout&&clearTimeout(this._timeout),!i)return!1;var e=new Date().getTime();if(i&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(i),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(i);var t=this._timeouts.shift();if(t===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),t=this._cachedTimeouts.slice(-1);else return!1;var s=this;return this._timer=setTimeout(function(){s._attempts++,s._operationTimeoutCb&&(s._timeout=setTimeout(function(){s._operationTimeoutCb(s._attempts)},s._operationTimeout),s._options.unref&&s._timeout.unref()),s._fn(s._attempts)},t),this._options.unref&&this._timer.unref(),!0};se.prototype.attempt=function(i,e){this._fn=i,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var t=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){t._operationTimeoutCb()},t._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};se.prototype.try=function(i){console.log("Using RetryOperation.try() is deprecated"),this.attempt(i)};se.prototype.start=function(i){console.log("Using RetryOperation.start() is deprecated"),this.attempt(i)};se.prototype.start=se.prototype.try;se.prototype.errors=function(){return this._errors};se.prototype.attempts=function(){return this._attempts};se.prototype.mainError=function(){if(this._errors.length===0)return null;for(var i={},e=null,t=0,s=0;s<this._errors.length;s++){var n=this._errors[s],r=n.message,a=(i[r]||0)+1;i[r]=a,a>=t&&(e=n,t=a)}return e};(function(i){var e=lc;i.operation=function(t){var s=i.timeouts(t);return new e(s,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})},i.timeouts=function(t){if(t instanceof Array)return[].concat(t);var s={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var n in t)s[n]=t[n];if(s.minTimeout>s.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var r=[],a=0;a<s.retries;a++)r.push(this.createTimeout(a,s));return t&&t.forever&&!r.length&&r.push(this.createTimeout(a,s)),r.sort(function(o,l){return o-l}),r},i.createTimeout=function(t,s){var n=s.randomize?Math.random()+1:1,r=Math.round(n*Math.max(s.minTimeout,1)*Math.pow(s.factor,t));return r=Math.min(r,s.maxTimeout),r},i.wrap=function(t,s,n){if(s instanceof Array&&(n=s,s=null),!n){n=[];for(var r in t)typeof t[r]=="function"&&n.push(r)}for(var a=0;a<n.length;a++){var o=n[a],l=t[o];t[o]=(function(c){var u=i.operation(s),y=Array.prototype.slice.call(arguments,1),g=y.pop();y.push(function(w){u.retry(w)||(w&&(arguments[0]=u.mainError()),g.apply(this,arguments))}),u.attempt(function(){c.apply(t,y)})}).bind(t,l),t[o].options=s}}})(Ka);var dc=Ka;const uc=cs(dc),cc=Object.prototype.toString,hc=i=>cc.call(i)==="[object Error]",pc=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed","fetch failed","terminated"," A network error occurred.","Network connection lost"]);function fc(i){if(!(i&&hc(i)&&i.name==="TypeError"&&typeof i.message=="string"))return!1;const{message:t,stack:s}=i;return t==="Load failed"?s===void 0||"__sentry_captured__"in i:t.startsWith("error sending request for url")?!0:pc.has(t)}class Zi extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const Er=(i,e,t)=>{const s=t.retries-(e-1);return i.attemptNumber=e,i.retriesLeft=s,i};async function Nr(i,e){return new Promise((t,s)=>{e={...e},e.onFailedAttempt??(e.onFailedAttempt=()=>{}),e.shouldRetry??(e.shouldRetry=()=>!0),e.retries??(e.retries=10);const n=uc.operation(e),r=()=>{var o;n.stop(),s((o=e.signal)==null?void 0:o.reason)};e.signal&&!e.signal.aborted&&e.signal.addEventListener("abort",r,{once:!0});const a=()=>{var o;(o=e.signal)==null||o.removeEventListener("abort",r),n.stop()};n.attempt(async o=>{try{const l=await i(o);a(),t(l)}catch(l){try{if(!(l instanceof Error))throw new TypeError(`Non-error was thrown: "${l}". You should only throw errors.`);if(l instanceof Zi)throw l.originalError;if(l instanceof TypeError&&!fc(l))throw l;if(Er(l,o,e),await e.shouldRetry(l)||(n.stop(),s(l)),await e.onFailedAttempt(l),!n.retry(l))throw n.mainError()}catch(h){Er(h,o,e),a(),s(h)}}})})}const mc="4.5.2",gc={version:mc};class yc extends Error{constructor(){super("Authorization required");m(this,"isAuthError");this.name="AuthError",this.isAuthError=!0}}function bc(i){return i.replace(/\/$/,"")}const Ur=10,vc=5*60*1e3,wc=401;class _c extends Error{constructor({statusCode:t,message:s}){super(s);m(this,"statusCode");this.name="HttpError",this.statusCode=t}}async function Sc(i){if(i.status===wc)throw new yc;if(i.ok)return i.json();let e=`Failed request with status: ${i.status}. ${i.statusText}`,t;try{t=await i.json(),t.message&&(e=`${e} message: ${t.message}`),t.requestId&&(e=`${e} request-Id: ${t.requestId}`)}catch(s){throw new Error(e,{cause:s})}throw i.status>=400&&i.status<=499&&t.message?new oc(t.message):new _c({statusCode:i.status,message:e})}function Fc(i,e,t){const{progress:s,bytesUploaded:n,bytesTotal:r}=e;s&&(i.uppy.log(`Upload progress: ${s}`),i.uppy.emit("upload-progress",t,{uploadStarted:t.progress.uploadStarted??0,bytesUploaded:n,bytesTotal:r}))}var Je,Be,en,Qs,tn;class Xa{constructor(e,t){v(this,Be);v(this,Je);m(this,"uppy");m(this,"opts");v(this,Qs,async({file:e,postBody:t,signal:s})=>{var r;if(((r=e.remote)==null?void 0:r.url)==null)throw new Error("Cannot connect to an undefined URL");return(await this.post(e.remote.url,{...e.remote.body,...t},{signal:s})).token});this.uppy=e,this.opts=t,this.onReceiveResponse=this.onReceiveResponse.bind(this),F(this,Je,t.companionHeaders)}setCompanionHeaders(e){F(this,Je,e)}[Symbol.for("uppy test: getCompanionHeaders")](){return p(this,Je)}get hostname(){const{companion:e}=this.uppy.getState(),t=this.opts.companionUrl;return bc(e!=null&&e[t]?e[t]:t)}async headers(e=!1){return{...{Accept:"application/json",...e?void 0:{"Content-Type":"application/json"}},...p(this,Je)}}onReceiveResponse(e){const{headers:t}=e,n=this.uppy.getState().companion||{},r=this.opts.companionUrl;t.has("i-am")&&t.get("i-am")!==n[r]&&this.uppy.setState({companion:{...n,[r]:t.get("i-am")}})}async request({path:e,method:t="GET",data:s,skipPostResponse:n,signal:r}){try{const a=await this.headers(!s),o=await rc(_(this,Be,en).call(this,e),{method:t,signal:r,headers:a,credentials:this.opts.companionCookiesRule||"same-origin",body:s?JSON.stringify(s):null});return n||this.onReceiveResponse(o),await Sc(o)}catch(a){throw a.isAuthError||a.name==="UserFacingApiError"||a.name==="AbortError"?a:new ic(`Could not ${t} ${_(this,Be,en).call(this,e)}`,{cause:a})}}async get(e,t){return this.request({...t,path:e})}async post(e,t,s){return this.request({...s,path:e,method:"POST",data:t})}async delete(e,t,s){return this.request({...s,path:e,method:"DELETE",data:t})}async uploadRemoteFile(e,t,s){try{const{signal:n,getQueue:r}=s||{};return await Nr(async()=>{var h;const a=(h=this.uppy.getFile(e.id))==null?void 0:h.serverToken;if(a!=null)return this.uppy.log(`Connecting to exiting websocket ${a}`),_(this,Be,tn).call(this,{file:e,queue:r(),signal:n});const l=await r().wrapPromiseFunction(async(...c)=>{try{return await p(this,Qs).call(this,...c)}catch(u){if(u.isAuthError)throw new Zi(u);if(u.cause==null)throw u;const y=u.cause,g=()=>[408,409,429,418,423].includes(y.statusCode)||y.statusCode>=500&&y.statusCode<=599&&![501,505].includes(y.statusCode);throw y.name==="HttpError"&&!g()?new Zi(y):y}},{priority:-1})({file:e,postBody:t,signal:n}).abortOn(n);if(this.uppy.getFile(e.id))return this.uppy.setFileState(e.id,{serverToken:l}),_(this,Be,tn).call(this,{file:this.uppy.getFile(e.id),queue:r(),signal:n})},{retries:Ur,signal:n,onFailedAttempt:a=>this.uppy.log(`Retrying upload due to: ${a.message}`,"warning")})}catch(n){if(n.name==="AbortError")return;throw this.uppy.emit("upload-error",e,n),n}}}Je=new WeakMap,Be=new WeakSet,en=function(e){return/^(https?:|)\/\//.test(e)?e:`${this.hostname}/${e}`},Qs=new WeakMap,tn=async function({file:e,queue:t,signal:s}){let n;const{capabilities:r}=this.uppy.getState();try{return await new Promise((a,o)=>{const l=e.serverToken,h=ac(e.remote.companionUrl);let c,u,y,{isPaused:g}=e;const w=(k,D)=>{if(c==null||c.readyState!==c.OPEN){this.uppy.log(`Cannot send "${k}" to socket ${e.id} because the socket state was ${String(c==null?void 0:c.readyState)}`,"warning");return}c.send(JSON.stringify({action:k,payload:D??{}}))};function x(){r.resumableUploads&&w(g?"pause":"resume")}const S=async()=>{u&&u.abort(),u=new AbortController;const k=H=>{var L;this.uppy.setFileState(e.id,{serverToken:null}),(L=u==null?void 0:u.abort)==null||L.call(u),o(H)};function D(){clearTimeout(y),!g&&(y=setTimeout(()=>k(new Error("Timeout waiting for message from Companion socket")),vc))}try{await t.wrapPromiseFunction(async()=>{await Nr(async()=>new Promise((L,b)=>{c=new WebSocket(`${h}/api/${l}`),D(),c.addEventListener("close",()=>{c=void 0,b(new Error("Socket closed unexpectedly"))}),c.addEventListener("error",B=>{this.uppy.log(`Companion socket error ${JSON.stringify(B)}, closing socket`,"warning"),c==null||c.close()}),c.addEventListener("open",()=>{x()}),c.addEventListener("message",B=>{var I,K,J;D();try{const{action:Le,payload:Ce}=JSON.parse(B.data);switch(Le){case"progress":{Fc(this,Ce,this.uppy.getFile(e.id));break}case"success":{const je=(I=Ce.response)==null?void 0:I.responseText;this.uppy.emit("upload-success",this.uppy.getFile(e.id),{uploadURL:Ce.url,status:((K=Ce.response)==null?void 0:K.status)??200,body:je?JSON.parse(je):void 0}),(J=u==null?void 0:u.abort)==null||J.call(u),a();break}case"error":{const{message:je}=Ce.error;throw Object.assign(new Error(je),{cause:Ce.error})}default:this.uppy.log(`Companion socket unknown action ${Le}`,"warning")}}catch(Le){k(Le)}});const E=()=>{this.uppy.log(`Closing socket ${e.id}`),clearTimeout(y),c&&c.close(),c=void 0};u.signal.addEventListener("abort",()=>{E()})}),{retries:Ur,signal:u.signal,onFailedAttempt:()=>{u.signal.aborted||this.uppy.log(`Retrying websocket ${e.id}`)}})})().abortOn(u.signal)}catch(H){if(u.signal.aborted)return;k(H)}},C=k=>{r.resumableUploads&&(g=k,c&&x())},T=k=>{var D;r.individualCancellation&&k.id===e.id&&(w("cancel"),(D=u==null?void 0:u.abort)==null||D.call(u),this.uppy.log(`upload ${e.id} was removed`),a())},A=()=>{var k;w("cancel"),(k=u==null?void 0:u.abort)==null||k.call(u),this.uppy.log(`upload ${e.id} was canceled`),a()},U=(k,D)=>{(k==null?void 0:k.id)===e.id&&C(D)},R=()=>C(!0),O=()=>C(!1);this.uppy.on("file-removed",T),this.uppy.on("cancel-all",A),this.uppy.on("upload-pause",U),this.uppy.on("pause-all",R),this.uppy.on("resume-all",O),n=()=>{this.uppy.off("file-removed",T),this.uppy.off("cancel-all",A),this.uppy.off("upload-pause",U),this.uppy.off("pause-all",R),this.uppy.off("resume-all",O)},s.addEventListener("abort",()=>{u==null||u.abort()}),S()})}finally{n==null||n()}},m(Xa,"VERSION",gc.version);var we,Jt;class Cc{constructor(e){v(this,we);v(this,Jt,[]);F(this,we,e)}on(e,t){return p(this,Jt).push([e,t]),p(this,we).on(e,t)}remove(){for(const[e,t]of p(this,Jt).splice(0))p(this,we).off(e,t)}onFilePause(e,t){this.on("upload-pause",(s,n)=>{e===(s==null?void 0:s.id)&&t(n)})}onFileRemove(e,t){this.on("file-removed",s=>{e===s.id&&t(s.id)})}onPause(e,t){this.on("upload-pause",(s,n)=>{e===(s==null?void 0:s.id)&&t(n)})}onRetry(e,t){this.on("upload-retry",s=>{e===(s==null?void 0:s.id)&&t()})}onRetryAll(e,t){this.on("retry-all",()=>{p(this,we).getFile(e)&&t()})}onPauseAll(e,t){this.on("pause-all",()=>{p(this,we).getFile(e)&&t()})}onCancelAll(e,t){this.on("cancel-all",(...s)=>{p(this,we).getFile(e)&&t(...s)})}onResumeAll(e,t){this.on("resume-all",()=>{p(this,we).getFile(e)&&t()})}}we=new WeakMap,Jt=new WeakMap;const{AbortController:xi}=globalThis,Ya=(i="Aborted",e)=>{const t=new DOMException(i,"AbortError");return e!=null&&Ga(e,"cause")&&Object.defineProperty(t,"cause",{__proto__:null,configurable:!0,writable:!0,value:e.cause}),t};function xc(i){const e=t=>"error"in t&&!!t.error;return i.filter(t=>!e(t))}function Pc(i){return i.filter(e=>{var t;return!((t=e.progress)!=null&&t.uploadStarted)||!e.isRestored})}function Ar(i,e){return i===!0?Object.keys(e):Array.isArray(i)?i:[]}function kc(i){return new Error("Cancelled",{cause:i})}function Or(i){var e;if(i!=null){const t=()=>this.abort(i.reason);i.addEventListener("abort",t,{once:!0});const s=()=>{i.removeEventListener("abort",t)};(e=this.then)==null||e.call(this,s,s)}return this}var ke,_e,Te,pt,Se,ft,Qe,Y,sn,It,Ja,Qa,Za,Zs,mt;class Tc{constructor(e){v(this,Y);v(this,ke,0);v(this,_e,[]);v(this,Te,!1);v(this,pt);v(this,Se,1);v(this,ft);v(this,Qe);m(this,"limit");v(this,Zs,()=>this.resume());v(this,mt,()=>{if(p(this,Te)){F(this,Qe,setTimeout(p(this,mt),0));return}F(this,Se,this.limit),this.limit=Math.ceil((p(this,ft)+p(this,Se))/2);for(let e=p(this,Se);e<=this.limit;e++)_(this,Y,It).call(this);p(this,ft)-p(this,Se)>3?F(this,Qe,setTimeout(p(this,mt),2e3)):F(this,Se,Math.floor(p(this,Se)/2))});typeof e!="number"||e===0?this.limit=1/0:this.limit=e}run(e,t){return!p(this,Te)&&p(this,ke)<this.limit?_(this,Y,sn).call(this,e):_(this,Y,Qa).call(this,e,t)}wrapSyncFunction(e,t){return(...s)=>{const n=this.run(()=>(e(...s),queueMicrotask(()=>n.done()),()=>{}),t);return{abortOn:Or,abort(){n.abort()}}}}wrapPromiseFunction(e,t){return(...s)=>{let n;const r=new Promise((a,o)=>{n=this.run(()=>{let l,h;try{h=Promise.resolve(e(...s))}catch(c){h=Promise.reject(c)}return h.then(c=>{l?o(l):(n.done(),a(c))},c=>{l?o(l):(n.done(),o(c))}),c=>{l=kc(c)}},t)});return r.abort=a=>{n.abort(a)},r.abortOn=Or,r}}resume(){F(this,Te,!1),clearTimeout(p(this,pt));for(let e=0;e<this.limit;e++)_(this,Y,It).call(this)}pause(e=null){F(this,Te,!0),clearTimeout(p(this,pt)),e!=null&&F(this,pt,setTimeout(p(this,Zs),e))}rateLimit(e){clearTimeout(p(this,Qe)),this.pause(e),this.limit>1&&Number.isFinite(this.limit)&&(F(this,ft,this.limit-1),this.limit=p(this,Se),F(this,Qe,setTimeout(p(this,mt),e)))}get isPaused(){return p(this,Te)}}ke=new WeakMap,_e=new WeakMap,Te=new WeakMap,pt=new WeakMap,Se=new WeakMap,ft=new WeakMap,Qe=new WeakMap,Y=new WeakSet,sn=function(e){F(this,ke,p(this,ke)+1);let t=!1,s;try{s=e()}catch(n){throw F(this,ke,p(this,ke)-1),n}return{abort:n=>{t||(t=!0,F(this,ke,p(this,ke)-1),s==null||s(n),_(this,Y,It).call(this))},done:()=>{t||(t=!0,F(this,ke,p(this,ke)-1),_(this,Y,It).call(this))}}},It=function(){queueMicrotask(()=>_(this,Y,Ja).call(this))},Ja=function(){if(p(this,Te)||p(this,ke)>=this.limit||p(this,_e).length===0)return;const e=p(this,_e).shift();if(e==null)throw new Error("Invariant violation: next is null");const t=_(this,Y,sn).call(this,e.fn);e.abort=t.abort,e.done=t.done},Qa=function(e,t){const s={fn:e,priority:(t==null?void 0:t.priority)||0,abort:()=>{_(this,Y,Za).call(this,s)},done:()=>{throw new Error("Cannot mark a queued request as done: this indicates a bug")}},n=p(this,_e).findIndex(r=>s.priority>r.priority);return n===-1?p(this,_e).push(s):p(this,_e).splice(n,0,s),s},Za=function(e){const t=p(this,_e).indexOf(e);t!==-1&&p(this,_e).splice(t,1)},Zs=new WeakMap,mt=new WeakMap;const Ec="4.3.2",Nc={version:Ec};function Uc({method:i="PUT",CanonicalUri:e="/",CanonicalQueryString:t="",SignedHeaders:s,HashedPayload:n}){const r=Object.keys(s).map(a=>a.toLowerCase()).sort();return[i,e,t,...r.map(a=>`${a}:${s[a]}`),"",r.join(";"),n].join(`
`)}const wn=new TextEncoder,_n={name:"HMAC",hash:"SHA-256"};async function Ac(i){const{subtle:e}=globalThis.crypto;return e.digest(_n.hash,wn.encode(i))}async function Oc(i){const{subtle:e}=globalThis.crypto;return e.importKey("raw",typeof i=="string"?wn.encode(i):i,_n,!1,["sign"])}function Mr(i){const e=new Uint8Array(i);let t="";for(let s=0;s<e.length;s++)t+=e[s].toString(16).padStart(2,"0");return t}async function Ut(i,e){const{subtle:t}=globalThis.crypto;return t.sign(_n,await Oc(i),wn.encode(e))}async function Mc({accountKey:i,accountSecret:e,sessionToken:t,bucketName:s,Key:n,Region:r,expires:a,uploadId:o,partNumber:l}){const h="s3",c=`${h}.${r}.amazonaws.com`,u=`/${s}/${encodeURI(n).replace(/[;?:@&=+$,#!'()*]/g,H=>`%${H.charCodeAt(0).toString(16).toUpperCase()}`)}`,y="UNSIGNED-PAYLOAD",g=new Date().toISOString().replace(/[-:]|\.\d+/g,""),w=g.slice(0,8),x=`${w}/${r}/${h}/aws4_request`,S=new URL(`https://${c}${u}`);S.searchParams.set("X-Amz-Algorithm","AWS4-HMAC-SHA256"),S.searchParams.set("X-Amz-Content-Sha256",y),S.searchParams.set("X-Amz-Credential",`${i}/${x}`),S.searchParams.set("X-Amz-Date",g),S.searchParams.set("X-Amz-Expires",a),S.searchParams.set("X-Amz-Security-Token",t),S.searchParams.set("X-Amz-SignedHeaders","host"),l&&S.searchParams.set("partNumber",l),o&&S.searchParams.set("uploadId",o),S.searchParams.set("x-id",l&&o?"UploadPart":"PutObject");const C=Uc({CanonicalUri:u,CanonicalQueryString:S.search.slice(1),SignedHeaders:{host:c},HashedPayload:y}),T=Mr(await Ac(C)),A=["AWS4-HMAC-SHA256",g,x,T].join(`
`),U=await Ut(`AWS4${e}`,w),R=await Ut(U,r),O=await Ut(R,h),k=await Ut(O,"aws4_request"),D=Mr(await Ut(k,A));return S.searchParams.set("X-Amz-Signature",D),S}const Rc=1024*1024,Rr={getChunkSize(i){return Math.ceil(i.size/1e4)},onProgress(){},onPartComplete(){},onSuccess(){},onError(i){throw i}};function Ic(i){if(typeof i=="string")return parseInt(i,10);if(typeof i=="number")return i;throw new TypeError("Expected a number")}const Bs=Symbol("pausing upload, not an actual error");var re,te,Fe,Ee,Ne,Qt,Zt,gt,Ze,yt,es,bt,ts,me,eo,to,nn,ss,is,so;class Dc{constructor(e,t){v(this,me);m(this,"options");v(this,re,new xi);v(this,te,[]);v(this,Fe,[]);v(this,Ee);v(this,Ne);v(this,Qt,!1);v(this,Zt);v(this,gt);v(this,Ze);v(this,yt);v(this,es,e=>(e==null?void 0:e.cause)===Bs?null:p(this,Zt).call(this,e));v(this,bt,1e4);v(this,ts,5*Rc);v(this,ss,e=>t=>{if(!t.lengthComputable)return;p(this,Fe)[e].uploaded=Ic(t.loaded);const s=p(this,Fe).reduce((n,r)=>n+r.uploaded,0);this.options.onProgress(s,p(this,Ee).size)});v(this,is,e=>t=>{p(this,te)[e]=null,p(this,Fe)[e].etag=t,p(this,Fe)[e].done=!0;const s={PartNumber:e+1,ETag:t};this.options.onPartComplete(s)});var s;this.options={...Rr,...t},(s=this.options).getChunkSize??(s.getChunkSize=Rr.getChunkSize),F(this,Ee,e),F(this,Ne,t.file),F(this,gt,this.options.onSuccess),F(this,Zt,this.options.onError),F(this,Ze,this.options.shouldUseMultipart),F(this,yt,t.uploadId&&t.key),_(this,me,eo).call(this)}start(){p(this,Qt)?(p(this,re).signal.aborted||p(this,re).abort(Bs),F(this,re,new xi),_(this,me,nn).call(this)):p(this,yt)?(this.options.companionComm.restoreUploadFile(p(this,Ne),{uploadId:this.options.uploadId,key:this.options.key}),_(this,me,nn).call(this)):_(this,me,to).call(this)}pause(){p(this,re).abort(Bs),F(this,re,new xi)}abort(e){e!=null&&e.really?_(this,me,so).call(this):this.pause()}[Symbol.for("uppy test: getChunkState")](){return p(this,Fe)}}re=new WeakMap,te=new WeakMap,Fe=new WeakMap,Ee=new WeakMap,Ne=new WeakMap,Qt=new WeakMap,Zt=new WeakMap,gt=new WeakMap,Ze=new WeakMap,yt=new WeakMap,es=new WeakMap,bt=new WeakMap,ts=new WeakMap,me=new WeakSet,eo=function(){const e=p(this,Ee).size,t=typeof p(this,Ze)=="function"?p(this,Ze).call(this,p(this,Ne)):!!p(this,Ze);if(t&&e>p(this,ts)){let s=Math.max(this.options.getChunkSize(p(this,Ee)),p(this,ts)),n=Math.floor(e/s);n>p(this,bt)&&(n=p(this,bt),s=e/p(this,bt)),F(this,te,Array(n));for(let r=0,a=0;r<e;r+=s,a++){const o=Math.min(e,r+s),l=()=>{const h=r;return p(this,Ee).slice(h,o)};if(p(this,te)[a]={getData:l,onProgress:p(this,ss).call(this,a),onComplete:p(this,is).call(this,a),shouldUseMultipart:t},p(this,yt)){const h=r+s>e?e-r:s;p(this,te)[a].setAsUploaded=()=>{p(this,te)[a]=null,p(this,Fe)[a].uploaded=h}}}}else F(this,te,[{getData:()=>p(this,Ee),onProgress:p(this,ss).call(this,0),onComplete:p(this,is).call(this,0),shouldUseMultipart:t}]);F(this,Fe,p(this,te).map(()=>({uploaded:0})))},to=function(){this.options.companionComm.uploadFile(p(this,Ne),p(this,te),p(this,re).signal).then(p(this,gt),p(this,es)),F(this,Qt,!0)},nn=function(){this.options.companionComm.resumeUploadFile(p(this,Ne),p(this,te),p(this,re).signal).then(p(this,gt),p(this,es))},ss=new WeakMap,is=new WeakMap,so=function(){p(this,re).abort(),this.options.companionComm.abortFileUpload(p(this,Ne)).catch(e=>this.options.log(e))};function X(i){if(i!=null&&i.aborted)throw Ya("The operation was aborted",{cause:i.reason})}function Bc(i){const e=new URL(i);return e.search="",e.hash="",e.href}var ns,ae,rs,as,os,ls,vt,wt,_t,St,et,Ft,oe,st,io,rn;class Lc{constructor(e,t,s,n){v(this,st);v(this,ns);v(this,ae,new WeakMap);v(this,rs);v(this,as);v(this,os);v(this,ls);v(this,vt);v(this,wt);v(this,_t);v(this,St);v(this,et);v(this,Ft);v(this,oe);F(this,wt,e),F(this,et,s),F(this,oe,n),this.setOptions(t)}setOptions(e){const t=p(this,wt);"abortMultipartUpload"in e&&F(this,ns,t.wrapPromiseFunction(e.abortMultipartUpload,{priority:1})),"createMultipartUpload"in e&&F(this,rs,t.wrapPromiseFunction(e.createMultipartUpload,{priority:-1})),"signPart"in e&&F(this,as,t.wrapPromiseFunction(e.signPart)),"listParts"in e&&F(this,ls,t.wrapPromiseFunction(e.listParts)),"completeMultipartUpload"in e&&F(this,St,t.wrapPromiseFunction(e.completeMultipartUpload,{priority:1})),"retryDelays"in e&&F(this,_t,e.retryDelays??[]),"uploadPartBytes"in e&&F(this,Ft,t.wrapPromiseFunction(e.uploadPartBytes,{priority:1/0})),"getUploadParameters"in e&&F(this,os,t.wrapPromiseFunction(e.getUploadParameters))}async getUploadId(e,t){let s;for(;s=p(this,ae).get(e.data),s!=null;)try{return await s}catch{}const n=p(this,rs).call(this,p(this,oe).call(this,e),t),r=()=>{n.abort(t.reason),p(this,ae).delete(e.data)};return t.addEventListener("abort",r,{once:!0}),p(this,ae).set(e.data,n),n.then(async a=>{t.removeEventListener("abort",r),p(this,et).call(this,e,a),p(this,ae).set(e.data,a)},()=>{t.removeEventListener("abort",r),p(this,ae).delete(e.data)}),n}async abortFileUpload(e){const t=p(this,ae).get(e.data);if(t==null)return;p(this,ae).delete(e.data),p(this,et).call(this,e,Object.create(null));let s;try{s=await t}catch{return}await p(this,ns).call(this,p(this,oe).call(this,e),s)}async uploadFile(e,t,s){if(X(s),t.length===1&&!t[0].shouldUseMultipart)return _(this,st,rn).call(this,e,t[0],s);const{uploadId:n,key:r}=await this.getUploadId(e,s);X(s);try{const a=await Promise.all(t.map((o,l)=>this.uploadChunk(e,l+1,o,s)));return X(s),await p(this,St).call(this,p(this,oe).call(this,e),{key:r,uploadId:n,parts:a,signal:s},s).abortOn(s)}catch(a){throw(a==null?void 0:a.cause)!==Bs&&(a==null?void 0:a.name)!=="AbortError"&&this.abortFileUpload(e),a}}restoreUploadFile(e,t){p(this,ae).set(e.data,t)}async resumeUploadFile(e,t,s){if(X(s),t.length===1&&t[0]!=null&&!t[0].shouldUseMultipart)return _(this,st,rn).call(this,e,t[0],s);const{uploadId:n,key:r}=await this.getUploadId(e,s);X(s);const a=await p(this,ls).call(this,p(this,oe).call(this,e),{uploadId:n,key:r,signal:s},s).abortOn(s);X(s);const o=await Promise.all(t.map((l,h)=>{var y;const c=h+1,u=a.find(({PartNumber:g})=>g===c);return u==null?this.uploadChunk(e,c,l,s):((y=l==null?void 0:l.setAsUploaded)==null||y.call(l),{PartNumber:c,ETag:u.ETag})}));return X(s),p(this,St).call(this,p(this,oe).call(this,e),{key:r,uploadId:n,parts:o,signal:s},s).abortOn(s)}async uploadChunk(e,t,s,n){X(n);const{uploadId:r,key:a}=await this.getUploadId(e,n),o=p(this,_t).values(),l=p(this,_t).values(),h=()=>{const c=o.next();return c==null||c.done?null:c.value};for(;;){X(n);const c=s.getData(),{onProgress:u,onComplete:y}=s;let g;try{g=await p(this,as).call(this,p(this,oe).call(this,e),{uploadId:r,key:a,partNumber:t,body:c,signal:n}).abortOn(n)}catch(w){const x=h();if(x==null||n.aborted)throw w;await new Promise(S=>setTimeout(S,x));continue}X(n);try{return{PartNumber:t,...await p(this,Ft).call(this,{signature:g,body:c,size:c.size,onProgress:u,onComplete:y,signal:n}).abortOn(n)}}catch(w){if(!await _(this,st,io).call(this,w,l))throw w}}}}ns=new WeakMap,ae=new WeakMap,rs=new WeakMap,as=new WeakMap,os=new WeakMap,ls=new WeakMap,vt=new WeakMap,wt=new WeakMap,_t=new WeakMap,St=new WeakMap,et=new WeakMap,Ft=new WeakMap,oe=new WeakMap,st=new WeakSet,io=async function(e,t){var r;const s=p(this,wt),n=(r=e==null?void 0:e.source)==null?void 0:r.status;if(n==null)return!1;if(n===403&&e.message==="Request has expired"){if(!s.isPaused){if(s.limit===1||p(this,vt)==null){const a=t.next();if(a==null||a.done)return!1;F(this,vt,a.value)}s.rateLimit(0),await new Promise(a=>setTimeout(a,p(this,vt)))}}else if(n===429){if(!s.isPaused){const a=t.next();if(a==null||a.done)return!1;s.rateLimit(a.value)}}else{if(n>400&&n<500&&n!==409)return!1;if(typeof navigator<"u"&&navigator.onLine===!1)s.isPaused||(s.pause(),window.addEventListener("online",()=>{s.resume()},{once:!0}));else{const a=t.next();if(a==null||a.done)return!1;await new Promise(o=>setTimeout(o,a.value))}}return!0},rn=async function(e,t,s){const{method:n="POST",url:r,fields:a,headers:o}=await p(this,os).call(this,p(this,oe).call(this,e),{signal:s}).abortOn(s);let l;const h=t.getData();if(n.toUpperCase()==="POST"){const w=new FormData;Object.entries(a).forEach(([x,S])=>w.set(x,S)),w.set("file",h),l=w}else l=h;const{onProgress:c,onComplete:u}=t,y=await p(this,Ft).call(this,{signature:{url:r,headers:o,method:n},body:l,size:h.size,onProgress:c,onComplete:u,signal:s}).abortOn(s),g=a==null?void 0:a.key;return p(this,et).call(this,e,{key:g}),{...y,location:y.location??Bc(r),bucket:a==null?void 0:a.bucket,key:g}};function rt(i){if(i!=null&&i.error){const e=new Error(i.message);throw Object.assign(e,i.error),e}return i}function Ir(i){const e=i.Expiration;if(e){const t=Math.floor((new Date(e)-Date.now())/1e3);if(t>9)return t}}function Dr({meta:i,allowedMetaFields:e,querify:t=!1}){const s=e??Object.keys(i);return i?Object.fromEntries(s.filter(n=>i[n]!=null).map(n=>{const r=t?`metadata[${n}]`:n,a=String(i[n]);return[r,a]})):{}}const jc={allowedMetaFields:!0,limit:6,getTemporarySecurityCredentials:!1,shouldUseMultipart:i=>(i.size||0)>100*1024*1024,retryDelays:[0,1e3,3e3,5e3]};var Ct,Z,q,on,Oe,le,no,ei,xt,ro,ao,ds,Pt,tt,us;const ti=class ti extends Hr{constructor(t,s){super(t,{...jc,uploadPartBytes:ti.uploadPartBytes,createMultipartUpload:null,listParts:null,abortMultipartUpload:null,completeMultipartUpload:null,signPart:null,getUploadParameters:null,...s});v(this,q);v(this,Ct);v(this,Z);m(this,"requests");m(this,"uploaderEvents");m(this,"uploaders");v(this,le);v(this,ei,(t,{key:s,uploadId:n})=>{const r=this.uppy.getFile(t.id);r!=null&&this.uppy.setFileState(t.id,{s3Multipart:{...r.s3Multipart,key:s,uploadId:n}})});v(this,xt,t=>this.uppy.getFile(t.id)||t);v(this,ds,async t=>{if(t.length===0)return;const s=this.uppy.getFilesByIds(t),n=xc(s),r=Pc(n);this.uppy.emit("upload-start",r);const a=n.map(l=>{if(l.isRemote){const h=()=>this.requests;p(this,tt).call(this,!1);const c=new AbortController,u=g=>{g.id===l.id&&c.abort()};this.uppy.on("file-removed",u);const y=this.uppy.getRequestClientForFile(l).uploadRemoteFile(l,_(this,q,ao).call(this,l),{signal:c.signal,getQueue:h});return this.requests.wrapSyncFunction(()=>{this.uppy.off("file-removed",u)},{priority:-1})(),y}return _(this,q,ro).call(this,l)}),o=await Promise.allSettled(a);return p(this,tt).call(this,!0),o});v(this,Pt,()=>{var t;(t=p(this,Z))==null||t.setCompanionHeaders(this.opts.headers)});v(this,tt,t=>{const{capabilities:s}=this.uppy.getState();this.uppy.setState({capabilities:{...s,resumableUploads:t}})});v(this,us,()=>{p(this,tt).call(this,!0)});this.type="uploader",this.id=this.opts.id||"AwsS3Multipart",_(this,q,on).call(this,s);const n={createMultipartUpload:this.createMultipartUpload,listParts:this.listParts,abortMultipartUpload:this.abortMultipartUpload,completeMultipartUpload:this.completeMultipartUpload,signPart:s!=null&&s.getTemporarySecurityCredentials?this.createSignedURL:this.signPart,getUploadParameters:s!=null&&s.getTemporarySecurityCredentials?this.createSignedURL:this.getUploadParameters};for(const r of Object.keys(n))this.opts[r]==null&&(this.opts[r]=n[r].bind(this));this.requests=this.opts.rateLimitedQueue??new Tc(this.opts.limit),F(this,Ct,new Lc(this.requests,this.opts,p(this,ei),p(this,xt))),this.uploaders=Object.create(null),this.uploaderEvents=Object.create(null)}[Symbol.for("uppy test: getClient")](){return p(this,Z)}setOptions(t){p(this,Ct).setOptions(t),super.setOptions(t),_(this,q,on).call(this,t)}resetUploaderReferences(t,s){this.uploaders[t]&&(this.uploaders[t].abort({really:(s==null?void 0:s.abort)||!1}),this.uploaders[t]=null),this.uploaderEvents[t]&&(this.uploaderEvents[t].remove(),this.uploaderEvents[t]=null)}createMultipartUpload(t,s){_(this,q,Oe).call(this,"createMultipartUpload"),X(s);const n=Ar(this.opts.allowedMetaFields,t.meta),r=Dr({meta:t.meta,allowedMetaFields:n});return p(this,Z).post("s3/multipart",{filename:t.name,type:t.type,metadata:r},{signal:s}).then(rt)}listParts(t,{key:s,uploadId:n,signal:r},a){r??(r=a),_(this,q,Oe).call(this,"listParts"),X(r);const o=encodeURIComponent(s);return p(this,Z).get(`s3/multipart/${encodeURIComponent(n)}?key=${o}`,{signal:r}).then(rt)}completeMultipartUpload(t,{key:s,uploadId:n,parts:r,signal:a},o){a??(a=o),_(this,q,Oe).call(this,"completeMultipartUpload"),X(a);const l=encodeURIComponent(s),h=encodeURIComponent(n);return p(this,Z).post(`s3/multipart/${h}/complete?key=${l}`,{parts:r.map(({ETag:c,PartNumber:u})=>({ETag:c,PartNumber:u}))},{signal:a}).then(rt)}async createSignedURL(t,s){const n=await _(this,q,no).call(this,s),r=Ir(n.credentials)||604800,{uploadId:a,key:o,partNumber:l}=s;return{method:"PUT",expires:r,fields:{},url:`${await Mc({accountKey:n.credentials.AccessKeyId,accountSecret:n.credentials.SecretAccessKey,sessionToken:n.credentials.SessionToken,expires:r,bucketName:n.bucket,Region:n.region,Key:o??`${crypto.randomUUID()}-${t.name}`,uploadId:a,partNumber:l})}`,headers:{"Content-Type":t.type}}}signPart(t,{uploadId:s,key:n,partNumber:r,signal:a}){if(_(this,q,Oe).call(this,"signPart"),X(a),s==null||n==null||r==null)throw new Error("Cannot sign without a key, an uploadId, and a partNumber");const o=encodeURIComponent(n);return p(this,Z).get(`s3/multipart/${encodeURIComponent(s)}/${r}?key=${o}`,{signal:a}).then(rt)}abortMultipartUpload(t,{key:s,uploadId:n,signal:r}){_(this,q,Oe).call(this,"abortMultipartUpload");const a=encodeURIComponent(s),o=encodeURIComponent(n);return p(this,Z).delete(`s3/multipart/${o}?key=${a}`,void 0,{signal:r}).then(rt)}getUploadParameters(t,s){_(this,q,Oe).call(this,"getUploadParameters");const{meta:n}=t,{type:r,name:a}=n,o=Ar(this.opts.allowedMetaFields,t.meta),l=Dr({meta:n,allowedMetaFields:o,querify:!0}),h=new URLSearchParams({filename:a,type:r,...l});return p(this,Z).get(`s3/params?${h}`,s)}static async uploadPartBytes({signature:{url:t,expires:s,headers:n,method:r="PUT"},body:a,size:o=a.size,onProgress:l,onComplete:h,signal:c}){if(X(c),t==null)throw new Error("Cannot upload to an undefined URL");return new Promise((u,y)=>{const g=new XMLHttpRequest;g.open(r,t,!0),n&&Object.keys(n).forEach(S=>{g.setRequestHeader(S,n[S])}),g.responseType="text",typeof s=="number"&&(g.timeout=s*1e3);function w(){g.abort()}function x(){c==null||c.removeEventListener("abort",w)}c==null||c.addEventListener("abort",w),g.upload.addEventListener("progress",S=>{l(S)}),g.addEventListener("abort",()=>{x(),y(Ya())}),g.addEventListener("timeout",()=>{x();const S=new Error("Request has expired");S.source={status:403},y(S)}),g.addEventListener("load",()=>{if(x(),g.status===403&&g.responseText.includes("<Message>Request has expired</Message>")){const U=new Error("Request has expired");U.source=g,y(U);return}if(g.status<200||g.status>=300){const U=new Error("Non 2xx");U.source=g,y(U);return}l==null||l({loaded:o,lengthComputable:!0});const S=g.getAllResponseHeaders().trim().split(/[\r\n]+/),C={__proto__:null};for(const U of S){const R=U.split(": "),O=R.shift(),k=R.join(": ");C[O]=k}const{etag:T,location:A}=C;if(r.toUpperCase()==="POST"&&A==null&&console.error("@uppy/aws-s3: Could not read the Location header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3/#setting-up-your-s3-bucket"),T==null){console.error("@uppy/aws-s3: Could not read the ETag header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3/#setting-up-your-s3-bucket");return}h==null||h(T),u({...C,ETag:T})}),g.addEventListener("error",S=>{x();const C=new Error("Unknown error");C.source=S.target,y(C)}),g.send(a)})}install(){p(this,tt).call(this,!0),this.uppy.addPreProcessor(p(this,Pt)),this.uppy.addUploader(p(this,ds)),this.uppy.on("cancel-all",p(this,us))}uninstall(){this.uppy.removePreProcessor(p(this,Pt)),this.uppy.removeUploader(p(this,ds)),this.uppy.off("cancel-all",p(this,us))}};Ct=new WeakMap,Z=new WeakMap,q=new WeakSet,on=function(t){t==null||!("endpoint"in t||"companionUrl"in t||"headers"in t||"companionHeaders"in t||"cookiesRule"in t||"companionCookiesRule"in t)||("companionUrl"in t&&!("endpoint"in t)&&this.uppy.log("`companionUrl` option has been removed in @uppy/aws-s3, use `endpoint` instead.","warning"),"companionHeaders"in t&&!("headers"in t)&&this.uppy.log("`companionHeaders` option has been removed in @uppy/aws-s3, use `headers` instead.","warning"),"companionCookiesRule"in t&&!("cookiesRule"in t)&&this.uppy.log("`companionCookiesRule` option has been removed in @uppy/aws-s3, use `cookiesRule` instead.","warning"),"endpoint"in t?F(this,Z,new Xa(this.uppy,{pluginId:this.id,provider:"AWS",companionUrl:this.opts.endpoint,companionHeaders:this.opts.headers,companionCookiesRule:this.opts.cookiesRule})):("headers"in t&&p(this,Pt).call(this),"cookiesRule"in t&&(p(this,Z).opts.companionCookiesRule=t.cookiesRule)))},Oe=function(t){if(!p(this,Z))throw new Error(`Expected a \`endpoint\` option containing a URL, or if you are not using Companion, a custom \`${t}\` implementation.`)},le=new WeakMap,no=async function(t){if(X(t==null?void 0:t.signal),p(this,le)==null){const{getTemporarySecurityCredentials:s}=this.opts;s===!0?(_(this,q,Oe).call(this,"getTemporarySecurityCredentials"),F(this,le,p(this,Z).get("s3/sts",t).then(rt))):F(this,le,s(t)),F(this,le,await p(this,le)),setTimeout(()=>{F(this,le,null)},(Ir(p(this,le).credentials)||0)*500)}return p(this,le)},ei=new WeakMap,xt=new WeakMap,ro=function(t){return new Promise((s,n)=>{const r=(c,u)=>{const y=this.uppy.getFile(t.id);this.uppy.emit("upload-progress",y,{uploadStarted:y.progress.uploadStarted??0,bytesUploaded:c,bytesTotal:u})},a=c=>{this.uppy.log(c),this.uppy.emit("upload-error",t,c),this.resetUploaderReferences(t.id),n(c)},o=c=>{const u={body:{...c},status:200,uploadURL:c.location};this.resetUploaderReferences(t.id),this.uppy.emit("upload-success",p(this,xt).call(this,t),u),c.location&&this.uppy.log(`Download ${t.name} from ${c.location}`),s(void 0)},l=new Dc(t.data,{companionComm:p(this,Ct),log:(...c)=>this.uppy.log(...c),getChunkSize:this.opts.getChunkSize?this.opts.getChunkSize.bind(this):void 0,onProgress:r,onError:a,onSuccess:o,onPartComplete:c=>{this.uppy.emit("s3-multipart:part-uploaded",p(this,xt).call(this,t),c)},file:t,shouldUseMultipart:this.opts.shouldUseMultipart,...t.s3Multipart});this.uploaders[t.id]=l;const h=new Cc(this.uppy);this.uploaderEvents[t.id]=h,h.onFileRemove(t.id,c=>{l.abort(),this.resetUploaderReferences(t.id,{abort:!0}),s(`upload ${c} was removed`)}),h.onCancelAll(t.id,()=>{l.abort(),this.resetUploaderReferences(t.id,{abort:!0}),s(`upload ${t.id} was canceled`)}),h.onFilePause(t.id,c=>{c?l.pause():l.start()}),h.onPauseAll(t.id,()=>{l.pause()}),h.onResumeAll(t.id,()=>{l.start()}),l.start()})},ao=function(t){var s;return{...(s=t.remote)==null?void 0:s.body,protocol:"s3-multipart",size:t.data.size,metadata:t.meta}},ds=new WeakMap,Pt=new WeakMap,tt=new WeakMap,us=new WeakMap,m(ti,"VERSION",Nc.version);let an=ti;function $c({maxNumberOfFiles:i=1,maxFileSize:e=10485760,onGetUploadParameters:t,onComplete:s,buttonClassName:n,children:r}){const[a,o]=j.useState(!1),{toast:l}=Lr(),[h]=j.useState(()=>new Ii({restrictions:{maxNumberOfFiles:i,maxFileSize:e,allowedFileTypes:["image/*"]},autoProceed:!1}).use(an,{shouldUseMultipart:!1,getUploadParameters:t}).on("complete",c=>{o(!1),s==null||s(c),c.successful.length>0&&l({title:"Â¡Subida exitosa!",description:`${c.successful.length} archivo(s) subido(s) correctamente.`})}).on("error",c=>{l({title:"Error de subida",description:"Hubo un problema al subir el archivo. IntÃ©ntalo de nuevo.",variant:"destructive"}),console.error("Upload error:",c)}));return f.jsxs("div",{children:[f.jsx(Ei,{onClick:()=>o(!0),className:`bg-chalk-green text-blackboard hover:bg-opacity-80 transition-all duration-200 ${n}`,children:r}),f.jsx(Wa,{uppy:h,open:a,onRequestClose:()=>o(!1),proudlyDisplayPoweredByUppy:!1,theme:"dark",locale:{strings:{dropPasteFiles:"Arrastra archivos aquÃ­ o %{browseFiles}",browseFiles:"selecciona",upload:"Subir",cancel:"Cancelar",retry:"Reintentar",remove:"Eliminar",addMore:"Agregar mÃ¡s",done:"Hecho",uploadComplete:"Â¡Subida completa!"}}})]})}function Pi({content:i,side:e="right"}){return f.jsxs(yo,{children:[f.jsx(bo,{asChild:!0,children:f.jsx("button",{type:"button",className:"inline-flex items-center justify-center ml-2 text-chalk-green hover:text-chalk-white transition-colors","aria-label":"InformaciÃ³n de ayuda",title:"Ver informaciÃ³n de ayuda","data-testid":"help-tooltip-trigger",children:f.jsx(vo,{className:"h-4 w-4","aria-hidden":"true"})})}),f.jsx(wo,{side:e,className:"max-w-xs bg-blackboard border-chalk text-chalk-white p-3",children:f.jsx("p",{className:"text-sm",children:i})})]})}function Br(i){return/^401: .*Unauthorized/.test(i.message)}const zc=Ao({dietaryRestrictions:it(Ae()).default([]),budget:Ae().min(1,"Selecciona un presupuesto"),cookingTime:Ae().min(1,"Selecciona tiempo de cocina"),servings:ui().min(1).max(10).default(4),cuisine:it(Ae()).default([]),allergies:it(Ae()).default([]),availableIngredients:it(Ae()).optional(),favorites:it(Ae()).optional(),dislikes:it(Ae()).optional(),daysToGenerate:ui().min(1).max(7).default(7),mealsPerDay:ui().min(3).max(5).default(3)}),Hc=[{id:"vegetarian",label:"Vegetariano"},{id:"vegan",label:"Vegano"},{id:"glutenFree",label:"Sin Gluten"},{id:"keto",label:"Keto"},{id:"paleo",label:"Paleo"},{id:"lowCarb",label:"Bajo en Carbohidratos"}],qc=[{id:"mediterranean",label:"MediterrÃ¡nea"},{id:"asian",label:"AsiÃ¡tica"},{id:"mexican",label:"Mexicana"},{id:"italian",label:"Italiana"},{id:"indian",label:"India"},{id:"american",label:"Americana"}],Vc=[{id:"nuts",label:"Frutos secos"},{id:"dairy",label:"LÃ¡cteos"},{id:"eggs",label:"Huevos"},{id:"soy",label:"Soja"},{id:"shellfish",label:"Mariscos"},{id:"fish",label:"Pescado"}];function nh(){var D,H,L;const{isAuthenticated:i,isLoading:e}=_o(),{toast:t}=Lr(),s=So(),[n,r]=j.useState(null),[a,o]=j.useState(null),[l,h]=j.useState("generator");Fo();const[c,u]=j.useState(!1),{usageCount:y,dailyLimit:g,canUse:w,incrementUsage:x}=jo({dailyLimit:3,feature:"menu"});j.useEffect(()=>{const E=new URLSearchParams(window.location.search).get("autoGenerate"),B=localStorage.getItem("questionnaireData");if(E==="true"&&B)try{const I=JSON.parse(B);console.log("Auto-generating menu from questionnaire data:",I),O(I),window.history.replaceState({},document.title,window.location.pathname)}catch(I){console.error("Error parsing questionnaire data:",I),t({title:"Error",description:"No se pudieron cargar los datos del cuestionario.",variant:"destructive"})}},[]),j.useEffect(()=>{if(!e&&!i){t({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{window.location.href="/api/login"},500);return}},[i,e,t]);const S=Co({resolver:Uo(zc),defaultValues:{dietaryRestrictions:[],budget:"",cookingTime:"",servings:4,cuisine:[],allergies:[]}}),C=ai({mutationFn:async b=>(await ws("/api/generate-menu",{method:"POST",body:JSON.stringify(b),headers:{"Content-Type":"application/json"}})).json(),onSuccess:b=>{r(b),s.invalidateQueries({queryKey:["/api/menu-plans"]}),t({title:"Â¡MenÃº generado!",description:"Tu menÃº semanal personalizado estÃ¡ listo."})},onError:b=>{if(Br(b)){t({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{window.location.href="/api/login"},500);return}t({title:"Error",description:"No se pudo generar el menÃº. IntÃ©ntalo de nuevo.",variant:"destructive"})}}),T=ai({mutationFn:async b=>await ws("/api/recognize-food",{method:"POST",body:{imageUrl:b}}),onSuccess:b=>{o(b),t({title:"Â¡Ingredientes reconocidos!",description:"Hemos identificado los alimentos en tu imagen."})},onError:b=>{if(Br(b)){t({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{window.location.href="/api/login"},500);return}t({title:"Error",description:"No se pudieron reconocer los ingredientes. IntÃ©ntalo de nuevo.",variant:"destructive"})}}),A=ai({mutationFn:async b=>await ws("/api/food-images",{method:"PUT",body:{imageURL:b}}),onSuccess:b=>{T.mutate(b.objectPath)},onError:b=>{t({title:"Error",description:"No se pudo procesar la imagen. IntÃ©ntalo de nuevo.",variant:"destructive"})}}),U=async()=>({method:"PUT",url:(await ws("/api/objects/upload",{method:"POST"})).uploadURL}),R=b=>{if(b.successful&&b.successful.length>0){const E=b.successful[0].uploadURL;A.mutate(E)}},O=b=>{var B;const E={budget:((B=b.budget)==null?void 0:B.toString())||"100",servings:b.people||4,dietaryRestrictions:b.dietType?[b.dietType]:[],allergies:b.allergies&&b.allergies!=="ninguna"?b.allergies.split(",").map(I=>I.trim()).filter(Boolean):[],cookingTime:b.mealsPerDay>2?"medium":"quick",cuisine:["mediterranean"],availableIngredients:b.recognizedIngredients&&!b.recognizedIngredients.includes("no hay ingredientes disponibles")?b.recognizedIngredients:[],favorites:b.favorites&&b.favorites!=="ninguno especificado"?b.favorites.split(",").map(I=>I.trim()).filter(Boolean):[],dislikes:b.dislikes&&b.dislikes!=="ninguno"?b.dislikes.split(",").map(I=>I.trim()).filter(Boolean):[],daysToGenerate:b.days||7,mealsPerDay:b.mealsPerDay||3};if(console.log("Generating menu with questionnaire preferences:",E),!w){u(!0);return}x()?C.mutate(E):u(!0)},k=b=>{if(!w){u(!0);return}x()?C.mutate(b):u(!0)};return e?f.jsx(Pn,{children:f.jsx("div",{className:"flex items-center justify-center min-h-screen",children:f.jsxs("div",{className:"text-center",children:[f.jsx(kn,{className:"animate-spin mx-auto mb-4 text-chalk-green",size:48}),f.jsx("p",{className:"text-chalk/70",children:"Cargando generador de menÃºs..."})]})})}):f.jsxs(Pn,{children:[f.jsx("div",{className:"py-8 px-4 sm:px-6 lg:px-8",children:f.jsxs("div",{className:"max-w-7xl mx-auto",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx("h1",{className:"font-handwritten text-4xl md:text-6xl font-bold text-chalk-yellow mb-4",children:"Generador de MenÃºs IA"}),f.jsx("p",{className:"text-lg text-chalk/80",children:"Crea menÃºs personalizados o reconoce ingredientes con IA"})]}),f.jsxs(xo,{value:l,onValueChange:h,className:"w-full",children:[f.jsxs(Po,{className:"grid w-full grid-cols-2 mb-8 bg-blackboard-light border border-chalk/20",children:[f.jsxs(Tn,{value:"generator",className:"data-[state=active]:bg-chalk-green data-[state=active]:text-blackboard text-chalk",children:[f.jsx(En,{className:"mr-2",size:16}),"Generar MenÃº"]}),f.jsxs(Tn,{value:"photo",className:"data-[state=active]:bg-chalk-yellow data-[state=active]:text-blackboard text-chalk",children:[f.jsx(ms,{className:"mr-2",size:16}),"Reconocer Alimentos"]})]}),f.jsx(Nn,{value:"generator",children:f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[f.jsxs(gs,{className:"recipe-card",children:[f.jsx(ys,{children:f.jsx(bs,{className:"text-chalk-yellow font-handwritten text-2xl",children:"Preferencias del MenÃº"})}),f.jsx(vs,{children:f.jsx(zo,{...S,children:f.jsxs("form",{onSubmit:S.handleSubmit(k),className:"space-y-6",children:[f.jsx(xe,{control:S.control,name:"dietaryRestrictions",render:()=>f.jsxs(ye,{children:[f.jsx(be,{className:"text-chalk font-semibold",children:"Restricciones DietÃ©ticas"}),f.jsx("div",{className:"grid grid-cols-2 gap-3",children:Hc.map(b=>f.jsx(xe,{control:S.control,name:"dietaryRestrictions",render:({field:E})=>{var B;return f.jsxs(ye,{className:"flex flex-row items-start space-x-3 space-y-0",children:[f.jsx($e,{children:f.jsx(ci,{checked:(B=E.value)==null?void 0:B.includes(b.id),onCheckedChange:I=>{var K;return I?E.onChange([...E.value,b.id]):E.onChange((K=E.value)==null?void 0:K.filter(J=>J!==b.id))},className:"border-chalk data-[state=checked]:bg-chalk-green"})}),f.jsx(be,{className:"text-sm text-chalk",children:b.label})]})}},b.id))})]})}),f.jsx(xe,{control:S.control,name:"budget",render:({field:b})=>f.jsxs(ye,{children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx(be,{className:"text-chalk font-semibold",children:"Presupuesto Semanal"}),f.jsx(Pi,{content:"Selecciona tu presupuesto semanal aproximado para ingredientes. Esto nos ayudarÃ¡ a sugerir recetas que se ajusten a tu economÃ­a."})]}),f.jsxs(Mo,{onValueChange:b.onChange,defaultValue:b.value,children:[f.jsx($e,{children:f.jsx(Ro,{className:"bg-blackboard border-chalk/30 text-chalk",children:f.jsx(Io,{placeholder:"Selecciona tu rango"})})}),f.jsxs(Do,{className:"bg-blackboard border-chalk/30",children:[f.jsx(_s,{value:"50",children:"â‚¬50 - â‚¬75"}),f.jsx(_s,{value:"75",children:"â‚¬75 - â‚¬100"}),f.jsx(_s,{value:"100",children:"â‚¬100 - â‚¬150"}),f.jsx(_s,{value:"150",children:"â‚¬150+"})]})]}),f.jsx(Os,{})]})}),f.jsx(xe,{control:S.control,name:"cookingTime",render:({field:b})=>f.jsxs(ye,{children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx(be,{className:"text-chalk font-semibold",children:"Tiempo de Cocina"}),f.jsx(Pi,{content:"Â¿CuÃ¡nto tiempo puedes dedicar a cocinar cada dÃ­a? Recetas rÃ¡pidas (<30 min), medias (30-60 min), o elaboradas (>60 min)."})]}),f.jsx($e,{children:f.jsxs(ko,{onValueChange:b.onChange,defaultValue:b.value,className:"grid grid-cols-3 gap-3",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(oi,{value:"quick",id:"quick",className:"border-chalk text-chalk-green"}),f.jsx("label",{htmlFor:"quick",className:"text-sm text-chalk",children:"< 30 min"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(oi,{value:"medium",id:"medium",className:"border-chalk text-chalk-green"}),f.jsx("label",{htmlFor:"medium",className:"text-sm text-chalk",children:"30-60 min"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(oi,{value:"elaborate",id:"elaborate",className:"border-chalk text-chalk-green"}),f.jsx("label",{htmlFor:"elaborate",className:"text-sm text-chalk",children:"> 60 min"})]})]})}),f.jsx(Os,{})]})}),f.jsx(xe,{control:S.control,name:"servings",render:({field:b})=>f.jsxs(ye,{children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx(be,{className:"text-chalk font-semibold",children:"NÃºmero de Porciones"}),f.jsx(Pi,{content:"Â¿Para cuÃ¡ntas personas cocinas? Las recetas se ajustarÃ¡n automÃ¡ticamente a la cantidad de porciones."})]}),f.jsx($e,{children:f.jsx(Oo,{type:"number",min:1,max:10,...b,onChange:E=>b.onChange(parseInt(E.target.value)),className:"bg-blackboard border-chalk/30 text-chalk"})}),f.jsx(Os,{})]})}),f.jsx(xe,{control:S.control,name:"cuisine",render:()=>f.jsxs(ye,{children:[f.jsx(be,{className:"text-chalk font-semibold",children:"Preferencias de Cocina"}),f.jsx("div",{className:"grid grid-cols-2 gap-3",children:qc.map(b=>f.jsx(xe,{control:S.control,name:"cuisine",render:({field:E})=>{var B;return f.jsxs(ye,{className:"flex flex-row items-start space-x-3 space-y-0",children:[f.jsx($e,{children:f.jsx(ci,{checked:(B=E.value)==null?void 0:B.includes(b.id),onCheckedChange:I=>{var K;return I?E.onChange([...E.value,b.id]):E.onChange((K=E.value)==null?void 0:K.filter(J=>J!==b.id))},className:"border-chalk data-[state=checked]:bg-chalk-yellow"})}),f.jsx(be,{className:"text-sm text-chalk",children:b.label})]})}},b.id))})]})}),f.jsx(xe,{control:S.control,name:"allergies",render:()=>f.jsxs(ye,{children:[f.jsx(be,{className:"text-chalk font-semibold",children:"Alergias"}),f.jsx("div",{className:"grid grid-cols-2 gap-3",children:Vc.map(b=>f.jsx(xe,{control:S.control,name:"allergies",render:({field:E})=>{var B;return f.jsxs(ye,{className:"flex flex-row items-start space-x-3 space-y-0",children:[f.jsx($e,{children:f.jsx(ci,{checked:(B=E.value)==null?void 0:B.includes(b.id),onCheckedChange:I=>{var K;return I?E.onChange([...E.value,b.id]):E.onChange((K=E.value)==null?void 0:K.filter(J=>J!==b.id))},className:"border-chalk data-[state=checked]:bg-chalk-red"})}),f.jsx(be,{className:"text-sm text-chalk",children:b.label})]})}},b.id))})]})}),f.jsx(Ei,{type:"submit",className:"w-full bg-chalk-green text-blackboard hover:bg-opacity-80 transition-all duration-200",disabled:C.isPending,children:C.isPending?f.jsxs(f.Fragment,{children:[f.jsx(li,{className:"mr-2 animate-spin",size:16}),"Generando MenÃº..."]}):f.jsxs(f.Fragment,{children:[f.jsx(En,{className:"mr-2",size:16}),"Generar Mi MenÃº Semanal"]})})]})})})]}),f.jsxs(gs,{className:"recipe-card",children:[f.jsx(ys,{children:f.jsx(bs,{className:"text-chalk-yellow font-handwritten text-2xl",children:n?"Tu MenÃº Semanal":"Vista Previa"})}),f.jsx(vs,{children:C.isPending?f.jsxs("div",{className:"text-center py-12",children:[f.jsx(li,{className:"animate-spin mx-auto mb-4 text-chalk-green",size:48}),f.jsx("p",{className:"text-chalk/70",children:"Generando tu menÃº personalizado..."}),f.jsx("p",{className:"text-chalk/50 text-sm mt-2",children:"Esto puede tomar unos momentos"})]}):n?f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h3",{className:"font-semibold text-chalk",children:((D=n.menuPlan)==null?void 0:D.name)||"MenÃº Personalizado"}),f.jsxs(di,{className:"bg-chalk-green text-blackboard",children:["â‚¬",((L=(H=n.shoppingList)==null?void 0:H.totalEstimatedCost)==null?void 0:L.toFixed(2))||"0.00"]})]}),f.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:(n.recipes||[]).map((b,E)=>{var B,I,K,J;return f.jsxs("div",{className:"p-4 bg-blackboard rounded-lg border border-chalk/20",children:[f.jsxs("div",{className:"flex justify-between items-start mb-2",children:[f.jsxs("div",{children:[f.jsxs("h4",{className:"font-semibold text-chalk-yellow",children:[["Lunes","Martes","MiÃ©rcoles","Jueves","Viernes","SÃ¡bado","Domingo"][b.dayOfWeek]," - ",b.mealType]}),f.jsx("p",{className:"text-chalk font-medium",children:b.name})]}),f.jsxs("div",{className:"text-right text-sm text-chalk/60",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx(Un,{size:12,className:"mr-1"}),b.cookingTime," min"]}),f.jsxs("div",{className:"flex items-center mt-1",children:[f.jsx(To,{size:12,className:"mr-1"}),b.servings," porciones"]})]})]}),f.jsx("p",{className:"text-chalk/80 text-sm mb-3",children:b.description}),f.jsxs("div",{className:"flex justify-between text-xs",children:[f.jsxs("span",{className:"text-chalk-green",children:[(B=b.nutritionInfo)==null?void 0:B.calories," kcal"]}),f.jsxs("span",{className:"text-chalk/60",children:["P: ",(I=b.nutritionInfo)==null?void 0:I.protein,"g | C: ",(K=b.nutritionInfo)==null?void 0:K.carbs,"g | G: ",(J=b.nutritionInfo)==null?void 0:J.fat,"g"]})]})]},E)})}),f.jsx(An,{className:"bg-chalk/20"}),f.jsx("div",{className:"text-center",children:f.jsxs(Ei,{onClick:()=>{var b;return window.location.href=`/dashboard?menu=${((b=n.menuPlan)==null?void 0:b.id)||""}`},className:"bg-chalk-yellow text-blackboard hover:bg-opacity-80",children:[f.jsx(Eo,{className:"mr-2",size:16}),"Ver MenÃº Completo"]})})]}):f.jsxs("div",{className:"text-center py-12",children:[f.jsx(kn,{className:"mx-auto mb-4 text-chalk/40",size:48}),f.jsx("p",{className:"text-chalk/60 mb-4",children:"Completa el formulario para generar tu menÃº"}),f.jsx("p",{className:"text-chalk/50 text-sm",children:"La IA crearÃ¡ un plan personalizado basado en tus preferencias"})]})})]})]})}),f.jsx(Nn,{value:"photo",children:f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[f.jsxs(gs,{className:"recipe-card",children:[f.jsx(ys,{children:f.jsx(bs,{className:"text-chalk-yellow font-handwritten text-2xl",children:"Reconocimiento de Alimentos"})}),f.jsx(vs,{children:f.jsxs("div",{className:"text-center",children:[f.jsxs("div",{className:"border-2 border-dashed border-chalk/30 rounded-xl p-8 hover:border-chalk-green transition-colors duration-200 mb-6",children:[f.jsx(ms,{className:"mx-auto mb-4 text-chalk/50",size:64}),f.jsx("h3",{className:"font-handwritten text-xl font-bold text-chalk-yellow mb-2",children:"Sube una Foto"}),f.jsx("p",{className:"text-chalk/80 mb-4",children:"Sube una imagen de ingredientes y nuestra IA los identificarÃ¡"}),f.jsxs($c,{maxNumberOfFiles:1,maxFileSize:10485760,onGetUploadParameters:U,onComplete:R,children:[f.jsx(ms,{className:"mr-2",size:16}),"Seleccionar Imagen"]})]}),(T.isPending||A.isPending)&&f.jsxs("div",{className:"text-center py-4",children:[f.jsx(li,{className:"animate-spin mx-auto mb-2 text-chalk-green",size:32}),f.jsx("p",{className:"text-chalk/70 text-sm",children:A.isPending?"Procesando imagen...":"Reconociendo ingredientes..."})]})]})})]}),f.jsxs(gs,{className:"recipe-card",children:[f.jsx(ys,{children:f.jsx(bs,{className:"text-chalk-yellow font-handwritten text-2xl",children:"Ingredientes Detectados"})}),f.jsx(vs,{children:a?f.jsxs("div",{className:"space-y-6",children:[f.jsx("div",{className:"space-y-3",children:(a.recognizedItems||[]).map((b,E)=>f.jsxs("div",{className:"flex items-center justify-between p-3 bg-blackboard rounded-lg border border-chalk/20",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:"w-8 h-8 bg-chalk-green rounded-full flex items-center justify-center",children:f.jsx(No,{className:"text-blackboard",size:16})}),f.jsx("span",{className:"text-chalk font-medium",children:b.name}),f.jsx(di,{variant:"outline",className:"text-xs border-chalk/30 text-chalk/70",children:b.category})]}),f.jsxs("span",{className:"text-chalk-green text-sm font-semibold",children:[Math.round(b.confidence*100),"% confianza"]})]},E))}),f.jsx(An,{className:"bg-chalk/20"}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-semibold text-chalk-green mb-4",children:"Recetas Sugeridas:"}),f.jsx("div",{className:"space-y-3",children:(a.suggestedRecipes||[]).map((b,E)=>f.jsxs("div",{className:"p-4 bg-chalk-green/10 rounded-lg border border-chalk-green/30",children:[f.jsxs("div",{className:"flex justify-between items-start mb-2",children:[f.jsx("h5",{className:"font-semibold text-chalk",children:b.name}),f.jsxs("div",{className:"flex items-center text-xs text-chalk/60",children:[f.jsx(Un,{size:12,className:"mr-1"}),b.cookingTime," min"]})]}),f.jsx("p",{className:"text-chalk/80 text-sm mb-3",children:b.description}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx(di,{className:"bg-chalk-yellow text-blackboard text-xs",children:b.difficulty}),f.jsx("div",{className:"flex flex-wrap gap-1",children:(b.mainIngredients||[]).slice(0,3).map((B,I)=>f.jsxs("span",{className:"text-xs text-chalk-green",children:[B,I<2&&I<b.mainIngredients.length-1?", ":""]},I))})]})]},E))})]})]}):f.jsxs("div",{className:"text-center py-12",children:[f.jsx(ms,{className:"mx-auto mb-4 text-chalk/40",size:48}),f.jsx("p",{className:"text-chalk/60 mb-4",children:"Sube una imagen para comenzar"}),f.jsx("p",{className:"text-chalk/50 text-sm",children:"Identificaremos automÃ¡ticamente los ingredientes y sugeriremos recetas"})]})})]})]})})]})]})}),f.jsx($o,{open:c,onOpenChange:u,reason:"usage_limit",usageCount:y,maxUsage:g})]})}export{nh as default};
