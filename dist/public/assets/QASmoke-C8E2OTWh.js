import{r as C,j as e,h as p,C as c,g as l,au as f,e as T,f as P,Z as j,k,B as o}from"./index-BvjW9mvP.js";import{P as w}from"./play-D27o3Y4o.js";import{T as A}from"./triangle-alert-CG4a9bpy.js";import{C as N}from"./circle-x-BSQjt5_M.js";function G(){const[i,d]=C.useState([{id:"health",name:"/healthz OK",description:"Verificar que el endpoint de salud responde correctamente",status:"pending"},{id:"demo_login",name:"Login Demo OK",description:"Verificar que el login demo funciona sin errores",status:"pending"},{id:"menu_generation",name:"Generar Men√∫ OK (<10s)",description:"Verificar que la generaci√≥n de men√∫ funciona en menos de 10 segundos",status:"pending"},{id:"shopping_list",name:"Ver Lista Compra OK",description:"Verificar que se puede acceder a la lista de compra",status:"pending"},{id:"paywall",name:"Ver Paywall OK",description:"Verificar que el paywall se muestra correctamente para usuarios no premium",status:"pending"},{id:"digital_goods",name:"Digital Goods Premium=false",description:"Verificar que Digital Goods detecta usuario demo como no premium",status:"pending"},{id:"ads_visibility",name:"Ads Visibles en Demo",description:"Verificar que los anuncios se muestran para usuarios no premium",status:"pending"}]),u=async a=>{if(i.findIndex(r=>r.id===a)===-1)return;d(r=>r.map(t=>t.id===a?{...t,status:"running",timestamp:new Date().toISOString()}:t));const m=Date.now();try{let r="",t=!1;switch(a){case"health":try{const s=await fetch("/api/healthz"),n=await s.json();t=s.ok&&n.status==="OK",r=t?`Health OK - Status: ${n.status}`:`Health failed: ${n.error||"Unknown error"}`}catch(s){r=`Health check failed: ${s instanceof Error?s.message:"Network error"}`}break;case"demo_login":try{t=(await j("/auth/demo-login",{method:"POST",body:{}})).success===!0,r=t?"Demo login successful":"Demo login failed"}catch(s){r=`Demo login error: ${s instanceof Error?s.message:"Unknown error"}`}break;case"menu_generation":try{const s=await j("/plan/quick-generate",{method:"POST",body:{dietaryRestrictions:["vegetarian"],servings:2,budget:"medium"}}),n=Date.now()-m;t=s.success&&n<1e4,r=t?`Menu generated in ${n}ms (${(n/1e3).toFixed(1)}s)`:`Menu generation took ${n}ms (>${(n/1e3).toFixed(1)}s)`}catch(s){r=`Menu generation failed: ${s instanceof Error?s.message:"Unknown error"}`}break;case"shopping_list":try{t=(await fetch("/my-menus")).ok,r=t?"Shopping list accessible":"Shopping list not accessible"}catch(s){r=`Shopping list error: ${s instanceof Error?s.message:"Network error"}`}break;case"paywall":try{t=(await fetch("/pricing")).ok,r=t?"Paywall accessible":"Paywall not accessible"}catch(s){r=`Paywall error: ${s instanceof Error?s.message:"Network error"}`}break;case"digital_goods":try{const s="getDigitalGoodsService"in window,n=!1;t=!n,r=s?`Digital Goods available, Premium status: ${n}`:"Digital Goods API not available (web mode)"}catch(s){r=`Digital Goods check failed: ${s instanceof Error?s.message:"Unknown error"}`}break;case"ads_visibility":try{const s=document.querySelectorAll("[data-ad-unit]"),n=document.querySelectorAll(".ad-native"),g=document.querySelectorAll(".ad-banner");t=s.length>0||n.length>0||g.length>0,r=t?`Ads visible: ${s.length} containers, ${n.length} native, ${g.length} banners`:"No ads found in DOM"}catch(s){r=`Ads visibility check failed: ${s instanceof Error?s.message:"Unknown error"}`}break;default:r="Unknown test"}const h=Date.now()-m;d(s=>s.map(n=>n.id===a?{...n,status:t?"success":"error",result:r,duration:h,timestamp:new Date().toISOString()}:n))}catch(r){const t=Date.now()-m;d(h=>h.map(s=>s.id===a?{...s,status:"error",result:`Test failed: ${r instanceof Error?r.message:"Unknown error"}`,duration:t,timestamp:new Date().toISOString()}:s))}},b=async()=>{for(const a of i)await u(a.id),await new Promise(x=>setTimeout(x,1e3))},v=a=>{switch(a){case"success":return e.jsx(f,{className:"w-5 h-5 text-green-400"});case"error":return e.jsx(N,{className:"w-5 h-5 text-red-400"});case"running":return e.jsx(k,{className:"w-5 h-5 text-yellow-400 animate-spin"});default:return e.jsx(k,{className:"w-5 h-5 text-gray-400"})}},y=a=>{switch(a){case"success":return e.jsx(o,{className:"bg-green-600 text-white",children:"PASS"});case"error":return e.jsx(o,{className:"bg-red-600 text-white",children:"FAIL"});case"running":return e.jsx(o,{className:"bg-yellow-600 text-white",children:"RUNNING"});default:return e.jsx(o,{variant:"outline",children:"PENDING"})}},S=i.filter(a=>a.status==="success").length,D=i.filter(a=>a.status==="error").length,$=i.length;return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-dark-green via-black to-dark-green text-chalk-white",children:e.jsxs("div",{className:"container mx-auto p-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-chalk-green mb-2 font-handwritten",children:"üß™ Smoke Tests"}),e.jsx("p",{className:"text-chalk/70",children:"Tests autom√°ticos de funcionalidad cr√≠tica"})]}),e.jsxs(p,{onClick:b,className:"bg-chalk-green text-dark-green hover:bg-chalk-green/90",size:"lg",children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"Ejecutar Todos"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[e.jsx(c,{className:"bg-dark-green/20 border-chalk-green/30",children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-chalk/60",children:"Total Tests"}),e.jsx("p",{className:"text-2xl font-bold",children:$})]}),e.jsx(A,{className:"w-8 h-8 text-chalk-green"})]})})}),e.jsx(c,{className:"bg-dark-green/20 border-chalk-green/30",children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-chalk/60",children:"Passed"}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:S})]}),e.jsx(f,{className:"w-8 h-8 text-green-400"})]})})}),e.jsx(c,{className:"bg-dark-green/20 border-chalk-green/30",children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-chalk/60",children:"Failed"}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:D})]}),e.jsx(N,{className:"w-8 h-8 text-red-400"})]})})})]})]}),e.jsx("div",{className:"space-y-4",children:i.map(a=>e.jsxs(c,{className:"bg-dark-green/20 border-chalk-green/30",children:[e.jsx(T,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[v(a.status),e.jsxs("div",{children:[e.jsx(P,{className:"text-chalk-green text-lg",children:a.name}),e.jsx("p",{className:"text-sm text-chalk/60",children:a.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[y(a.status),e.jsxs(p,{onClick:()=>u(a.id),disabled:a.status==="running",variant:"outline",size:"sm",children:[e.jsx(w,{className:"w-3 h-3 mr-1"}),"Run"]})]})]})}),a.result&&e.jsx(l,{className:"pt-0",children:e.jsxs("div",{className:"bg-black/30 p-3 rounded border border-chalk-green/20",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("p",{className:"text-sm font-mono text-chalk/90",children:a.result}),e.jsx("div",{className:"text-xs text-chalk/50",children:a.duration&&`${a.duration}ms`})]}),a.timestamp&&e.jsxs("p",{className:"text-xs text-chalk/50",children:["Executed: ",new Date(a.timestamp).toLocaleTimeString()]})]})})]},a.id))}),e.jsxs("div",{className:"mt-8 text-center",children:[e.jsx("p",{className:"text-sm text-chalk/50",children:"Smoke tests verifican funcionalidad cr√≠tica ‚Ä¢ Ejecutar antes de cada deployment"}),e.jsxs("div",{className:"mt-4 space-x-4",children:[e.jsx("a",{href:"/qa",className:"text-chalk-green hover:underline",children:"‚Üê Volver a QA"}),e.jsx("a",{href:"/previews",className:"text-chalk-green hover:underline",children:"Ver Capturas ‚Üí"})]})]})]})})}export{G as default};
